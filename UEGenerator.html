<html>
<head>
<title>Ultimate Equipment treasure generator</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 
	This HTML file is an implementation of the treasure generator in the Paizo's Ultimate Equipment, for the 
	Pathfinder gaming sysytem. UE is copyright Paizo Publishing, and the data therin is used without permission.
	
	The code is copyright (c) 2014 Paul Murray, pmurray@bigpond.com, twitter PaulMurrayCbr, paulmurray.wordpress.com.
	
	License is Creative Commons "non-commercial with attribution"

	(like, yeah right: I will totally sic my lawyers onto you if you diss my rights)
	
 -->

<style type="text/css">
.money {
	border: thin solid gray;
	text-align: right;
	padding-left: .5em;
	padding-right: .5em;
	font-family: monospace;
}

.centercell {
	border: thin solid gray;
	text-align: center;
	padding-left: .5em;
	padding-right: .5em;
}

.cell {
	border: thin solid gray;
	text-align: left;
	padding-left: .5em;
	padding-right: .5em;
}

.cellNoB {
	text-align: left;
	padding-left: .5em;
	padding-right: .5em;
}
</style>

</head>
<script type="text/javascript">

	var picker; // I use this as a scrpa variable in a couple of spots


	function clearElement(e) {
		while(e.childNodes.length != 0) {
			e.removeChild(e.firstChild);
		}
	}

	function initAll() {
		mainTreasureBlock = new OverallTreasureBlock(document
				.getElementById("MAIN-TREASURE"), 0);
		npcCount = 0;
		recalcTotalTreasureBudget();
	}
	
	// UTILITY OBJECTS
	
	
	function rnd(dd) {
		var r = Math.random();
		r = r * dd
		r = Math.floor(r)
		return r;
	}

	function roll(n, dd) {
		var t = 0;
		while (n > 0) {
			n--;
			t += rnd(dd) + 1;
		}
		return t;
	}

	function DiceRoller(n, d, plus) {
		if (d == 0)
			throw "Cant do a d0";

		this.n = n;
		this.d = d;
		this.plus = plus;
	}

	DiceRoller.prototype.toString = function() {
		try {
			return this.n
					+ "d"
					+ this.d
					+ (this.plus == 0 ? "" : this.plus > 0 ? "+" + this.plus
							: this.plus);
		} catch (ex) {
			return ex.toString();
		}
	}

	DiceRoller.prototype.gen = function() {
		var rolls = [];
		var amt = this.plus;
		
		for ( var i = 0; i < this.n; i++) {
			rolls[i] = roll(1, this.d);
			amt += rolls[i];
		}

		return new DiceRoll(this, rolls, amt);
	}

	function DiceRoll(gen, rolls, amt) {
		this.gen = gen;
		this.rolls = rolls;
		this.amt = amt;
	}

	DiceRoll.prototype.toString = function() {
		try {
			return this.gen + "(" + this.rolls + ")=" + this.amt;
		} catch (ex) {
			return ex.toString();
		}

	}
	
	function cpToString(cp) {
		return Math.floor(cp/100) + "." + Math.floor((cp%100)/10) + Math.floor((cp%10))
	}
	

	/////////////////////////////////////////////////////////////////////////////////////////////////////////
	/////////////////////////////////////////////////////////////////////////////////////////////////////////
	/////////////////////////////////////////////////////////////////////////////////////////////////////////

	var d100roller = new DiceRoller(1, 100, 0);

	function D100Picker(v) {
		this.v = v;
		if(!v) { throw "no vector passed to D100Picker()";}
	}

	D100Picker.prototype.toString = function() {return "D100Picker( " + this.v +")";}

	D100Picker.prototype.add = function(a, b, item) {
		if(item==null) throw "no item passed to D100Picker.add("+a+","+b+","+item+")";
		var row = new D100Row(this, a, b, item);
		for(var i = a; i<= b; i++) {
			this.v[i] = row;
		}
	}

	D100Picker.prototype.gen = function() {
		return new D100Pick(this, d100roller.gen());
	}

	D100Picker.prototype.validate = function(msg) {
		for(var i = 1; i < 100; i++) {
			if(!this.v[i]) {
				throw "D100 validation fail: no item " + i + " on " + this + ": " + msg;
			}	
		}
	}

	function D100Row(gen, a, b, item) {
		this.gen = gen;
		this.a = a;
		this.b = b;
		this.item = item;
		
		if(!gen) throw "no gen for d100Row";
		if(item==null) throw "no item for d100Row";
	}
	
	D100Row.prototype.toString = function() {try{return "D100Row("+this.a+"-" + this.b + ": " + this.item.toString()+")";}catch(ex){return ex;}}

	function D100Pick(gen, roll) {
		this.gen = gen;
		this.roll = roll;
		this.v = gen.v;
		
		this.row = this.v[roll.amt];
		
		if(!this.row) throw (this + " failed to have value for " + roll); 
		
		this.item = this.row.item;
		
		if(this.item.gen) {
			this.generated = this.item.gen(gen);
		}
		else {
			this.generated = this.item;
		}
	}

	D100Pick.prototype.toString = function() {try{
		
		var g,r,rr,gg;
		try {g = this.gen.toString();}catch(e){g=e.toString();}
		try {r = this.roll.toString();}catch(e){g=e.toString();}
		try {rr = this.row.toString();}catch(e){g=e.toString();}
		try {gg = this.generated.toString();}catch(e){gg=e.toString();}
		
		return "D100Pick(" + g + "["+r+"]: " + rr + ": " + gg + ")";
		}catch(ex){return ex;}}

	D100Pick.prototype.reroll = function() {
		this.roll = d100roller.gen();
		this.row = this.v[this.roll.amt];
		this.item = this.row.item;
		this.generated = this.item.gen();
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////////
	/////////////////////////////////////////////////////////////////////////////////////////////////////////
	/////////////////////////////////////////////////////////////////////////////////////////////////////////

	
	//////////	
	
	// a global.

	var totalTreasureBudget = 0;

	var t7_1_slow = [ 0, 170, 350, 550, 750, 1000, 1350, 1750, 2200, 2850,
			3650, 4650, 6000, 7750, 10000, 13000, 16500, 22000, 28000, 35000,
			44000 ];
	var t7_1_medium = [ 0, 260, 550, 800, 1150, 1550, 2000, 3600, 3350, 4250,
			5450, 7000, 9000, 11600, 15000, 19500, 25000, 32000, 41000, 53000,
			67000 ];
	var t7_1_fast = [ 0, 4000, 8000, 1200, 1700, 2300, 3000, 3900, 5000, 6400,
			8200, 10500, 13500, 17500, 22000, 29000, 38000, 48000, 62000,
			79000, 100000 ];

	var mainTreasureBlock;
	
	var npcCount = 0;
	var npcList = new Array();
	
	
	var summaryCP;
	var summarySP;
	var summaryGP;
	var summaryPP;
	var summaryGEMS;
	var summaryART;
	

	function recalcTotalTreasureBudget() {
		var apl = parseInt(document.getElementById("APL").value);
		var track;
		if (document.getElementById("AdvancementRate").value == 'slow') {
			track = t7_1_slow;
		} else if (document.getElementById("AdvancementRate").value == 'fast') {
			track = t7_1_fast;
		} else {
			track = t7_1_medium;
		}

		totalTreasureBudget = track[apl];

		if (document.getElementById("APLMultiplier").value == 'incidental') {
			totalTreasureBudget /= 2;
		} else if (document.getElementById("APLMultiplier").value == 'double') {
			totalTreasureBudget *= 2;
		} else if (document.getElementById("APLMultiplier").value == 'triple') {
			totalTreasureBudget *= 3;
		}

		document.getElementById("totaltreasurebudget").innerHTML = totalTreasureBudget;
		
		var mainBudget = totalTreasureBudget;
		
		for(var i = 0; i<npcCount; i++) {
			mainBudget -= npcList[i].budget;
		}

		mainTreasureBlock.setBudget(mainBudget);
	}
	
	function repopulateSummary() {
		
		summaryCP=0;
		summarySP=0;
		summaryGP=0;
		summaryPP=0;
		summaryGEMS=0;
		summaryART=0;

		
		document.getElementById('cp_amt').innerHTML = '0';
		document.getElementById('cp_value').innerHTML = '0.00';
		document.getElementById('sp_amt').innerHTML = '0';
		document.getElementById('sp_value').innerHTML = '0.00';
		document.getElementById('gp_amt').innerHTML = '0';
		document.getElementById('gp_value').innerHTML = '0.00';
		document.getElementById('pp_amt').innerHTML = '0';
		document.getElementById('pp_value').innerHTML = '0.00';

		document.getElementById('currency_value').innerHTML = '0.00';
		document.getElementById('gem_value').innerHTML = '0.00';
		document.getElementById('art_value').innerHTML = '0.00';
		document.getElementById('total_value').innerHTML = '0.00';
		
		clearElement(document.getElementById('gem_table'));
		clearElement(document.getElementById('art_table'));
		clearElement(document.getElementById('item_table'));
		clearElement(document.getElementById('weapon_table'));
		clearElement(document.getElementById('armour_table'));
		
		if(!mainTreasureBlock) return; // this only happens during the initial page load
		addTreasureBlockToSummary(mainTreasureBlock);
		for(var i = 0; i<npcCount;i++) {
			addTreasureBlockToSummary(npcList[i]);
		}
		
		if(summaryGEMS > 0) {
			var tr = document.createElement("tr");
			var td = document.createElement("td");
			td.setAttribute("class", "cell");
			tr.appendChild(td);
			var td = document.createElement("td");
			td.setAttribute("class", "money");
			td.appendChild(document.createTextNode(cpToString(summaryGEMS*100)));
			tr.appendChild(td);
			document.getElementById('gem_table').appendChild(tr);
		}
		
		if(summaryART > 0) {
			var tr = document.createElement("tr");
			var td = document.createElement("td");
			td.setAttribute("class", "cell");
			tr.appendChild(td);
			var td = document.createElement("td");
			td.setAttribute("class", "money");
			td.appendChild(document.createTextNode(cpToString(summaryART*100)));
			tr.appendChild(td);
			document.getElementById('art_table').appendChild(tr);
		}
	}
	
	function addTreasureBlockToSummary(treasureBlock) {
		for(var i = 0; i<treasureBlock.treasuresCount; i++) {
			addTreasureToSummary(treasureBlock.treasures[i]);
		}
	}
	
	function addTreasureToSummary(treasure) {
		for(var i = 0; i<treasure.generatedGold.length; i++) {
			var generatedGold = treasure.generatedGold[i]
			
			if(generatedGold.picker.denom == cp) {
				summaryCP += generatedGold.picker.mul * generatedGold.roll.amt;
			}
			else if(generatedGold.picker.denom == sp) {
				summarySP += generatedGold.picker.mul * generatedGold.roll.amt;
			}
			else if(generatedGold.picker.denom == gp) {
				summaryGP += generatedGold.picker.mul * generatedGold.roll.amt;
			}
			else if(generatedGold.picker.denom == pp) {
				summaryPP += generatedGold.picker.mul * generatedGold.roll.amt;
			}
		}

		for(var i = 0; i<treasure.generatedGems.length; i++) {
			var generatedGems = treasure.generatedGems[i]
			var tr = document.createElement("tr");
			var td = document.createElement("td");
			td.setAttribute("class", "cell");
			td.appendChild(document.createTextNode(generatedGems.gemType + (generatedGems.worked?'':' (unworked)')));
			tr.appendChild(td);
			var td = document.createElement("td");
			td.setAttribute("class", "money");
			td.appendChild(document.createTextNode(cpToString(generatedGems.getValue()*100)));
			tr.appendChild(td);
			document.getElementById('gem_table').appendChild(tr);
			summaryGEMS += generatedGems.getValue();
		}
		
		for(var i = 0; i<treasure.generatedArt.length; i++) {
			var generatedArt = treasure.generatedArt[i]
			var tr = document.createElement("tr");
			var td = document.createElement("td");
			td.setAttribute("class", "cell");
			td.appendChild(document.createTextNode(generatedArt.artObject.lbl));
			tr.appendChild(td);
			var td = document.createElement("td");
			td.setAttribute("class", "money");
			td.appendChild(document.createTextNode(cpToString(generatedArt.getValue()*100)));
			tr.appendChild(td);
			document.getElementById('art_table').appendChild(tr);
			summaryART += generatedArt.getValue();
		}
		for(var i = 0; i<treasure.generatedItems.length; i++) {
			var generatedItem = treasure.generatedItems[i]
			var tr = document.createElement("tr");

			if(generatedItem.isItemPickerTableResult) {
				var td = document.createElement("td");
				td.setAttribute("class", "cell");
				td.appendChild(document.createTextNode(
						generatedItem.itemPickerTable.tableset.lbl 
						+ " of "
						+ generatedItem.item.lbl 
				));
				if(generatedItem.item.src != 'CR') {
					var src = document.createElement("span");
					src.style.fontSize = "50%";
					src.style.fontWeight = "bold";
					src.style.fontFamily = "sans-serif";
					src.appendChild(document.createTextNode(" " + generatedItem.item.src))
					td.appendChild(src);
				}
				tr.appendChild(td);
				var td = document.createElement("td");
				td.setAttribute("class", "money");
				td.appendChild(document.createTextNode(cpToString(generatedItem.item.val*100)));
				tr.appendChild(td);
				
				
			}
			else {
				var td = document.createElement("td");
				td.setAttribute("class", "cell");
				td.appendChild(document.createTextNode(generatedItem));
				tr.appendChild(td);
								
			}
			document.getElementById('item_table').appendChild(tr);
		}
		for(var i = 0; i<treasure.generatedWeapons.length; i++) {
			var generatedWeapon = treasure.generatedWeapons[i]
			var span = document.createElement("div");
			span.style.margin = "2px";
			span.style.padding = "2px";
			span.appendChild(document.createTextNode(generatedWeapon));
			document.getElementById('weapon_table').appendChild(span);
		}
		for(var i = 0; i<treasure.generatedArmour.length; i++) {
			var generatedArmour = treasure.generatedArmour[i]
			var span = document.createElement("div");
			span.style.margin = "2px";
			span.style.padding = "2px";
			span.appendChild(document.createTextNode(generatedArmour));
			document.getElementById('armour_table').appendChild(span);
		}
		
		document.getElementById('cp_amt').innerHTML = summaryCP;
		document.getElementById('cp_value').innerHTML = cpToString(summaryCP);
		document.getElementById('sp_amt').innerHTML = summarySP;
		document.getElementById('sp_value').innerHTML = cpToString(summarySP*10);
		document.getElementById('gp_amt').innerHTML = summaryGP;
		document.getElementById('gp_value').innerHTML = cpToString(summaryGP*100);
		document.getElementById('pp_amt').innerHTML = summaryPP;
		document.getElementById('pp_value').innerHTML = cpToString(summaryPP*1000);
		document.getElementById('currency_value').innerHTML = cpToString(summaryCP+summarySP*10+summaryGP*100+summaryPP*1000);
		document.getElementById('gem_value').innerHTML = cpToString(summaryGEMS*100);
		document.getElementById('art_value').innerHTML = cpToString(summaryART*100);
		document.getElementById('total_value').innerHTML = cpToString(summaryCP+summarySP*10+summaryGP*100+summaryPP*1000+summaryGEMS*100+summaryART*100);
		
	}

	
	function addNPCBlock() {
		var div = document.createElement('div');
		npcList[npcCount] = new OverallTreasureBlock(div, 100, true, npcCount);
		npcCount ++;
		document.getElementById('NPC-TREASURES').appendChild(div);
		recalcTotalTreasureBudget();
	}
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Overall block - one for each NPC and one for the group treasure. 
// An overall treasure block has a TreasureTypSelector defining its budget and a number of 
// TreasureBlocks consuming that budget
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	
	var T7_2 = [0,260,390,780,1650,2400,3450,4650,6000,7800,10050,12750,16350,21000,27000,34800,45000,58500,75000,96000,123000,159000];
	
	function OverallTreasureBlock(div, budget, isNPCBlock, npcIndex) {
		this.div = div;
		this.isNPCBlock = isNPCBlock;
		this.npcIndex = npcIndex;
		div.controller = this;

		this.treasures = new Array();
		this.treasuresCount = 0;
		
		var e;
		var ee;
		var eee;

		div.appendChild(document.createElement("hr"));

		if(isNPCBlock) {
			e = document.createElement("span")
			e.appendChild(document.createTextNode("NPC Level: "));
			ee = document.createElement("select");
			for(var i = 1; i<=21;i++) {
				eee = document.createElement("option");
				eee.text = i;
				eee.value = i;
				ee.appendChild(eee);
			}
			e.appendChild(ee);
			ee.onchange = function() {
				controller(this).setBudget(T7_2[parseInt(ee.value)]);
				recalcTotalTreasureBudget();
			};
			
			div.appendChild(e);
			budget = T7_2[1];
		}
		
		
		e = document.createElement("span")
		e.appendChild(document.createTextNode("Budget: "))
		this.budgetSpan = document.createElement("span");
		e.appendChild(this.budgetSpan);
		e.appendChild(document.createTextNode(", Consumed: "))
		this.budgetConsumedSpan = document.createElement("span");
		e.appendChild(this.budgetConsumedSpan);

		div.appendChild(e);

		var treasureType = document.createElement("div");
		div.appendChild(treasureType);
		
		this.chooseTypeArea = document.createElement("div");
		div.appendChild(this.chooseTypeArea);
		this.treasureTypeSelector = new TreasureTypeSelector(this, this.chooseTypeArea);
		
		e = document.createElement("button");
		e.innerHTML = "add one treasure";
		e.onclick = function() {
			controller(this).addOne();
		};
		div.appendChild(e);

		e = document.createElement("button");
		e.innerHTML = "reroll all";
		e.onclick = function() {
			controller(this).reroll();
		};
		div.appendChild(e);

		e = document.createElement("button");
		e.innerHTML = "reroll each";
		e.onclick = function() {
			var otb = controller(this);
			for(var i = 0; i<otb.treasuresCount; i++) {
				otb.treasures[i].reroll();
			}
		};
		div.appendChild(e);

		if(isNPCBlock) {
			e = document.createElement("button");
			e.innerHTML = "delete NPC";
			e.onclick = function() {
					controller(this).delete();
			};
			div.appendChild(e);
		}

		this.treasuresArea = document.createElement("div");
		div.appendChild(this.treasuresArea);

		this.setBudget(budget);
	}

	OverallTreasureBlock.prototype.toString = function() {
		return "OverallTreasureBlock" + ((this.npcIndex+1)? " for NPC " + (this.npcIndex+1) : "");
	}
	
	OverallTreasureBlock.prototype.reroll = function() {
		while(this.treasuresCount > 0) {
			this.treasures[0].delete();
		}
		
		var noMoreThan20 = 20;		
		while(this.budgetConsumed < this.budget && noMoreThan20-- > 0) {
			if(!this.addOne()) {
				break;
			}
		}
		
		this.calculateBudgetConsumed();
		repopulateSummary();
	}

	OverallTreasureBlock.prototype.addOne = function() {
		// ok. How much budge do we have remainning?
				
		var d = document.createElement('div');
		this.treasuresArea.appendChild(d);
		
		var treasureBlock =  new TreasureBlock(d, this, this.treasuresCount);
		this.treasures[this.treasuresCount] = treasureBlock;
		this.treasuresCount++;
		
		var budgetRemaining = this.budget - this.budgetConsumed;
		
		var chosenType = 'A'
			var chosenIndex = -1

		chooseComboSettings: {
			if(budgetRemaining <= 0) break chooseComboSettings;
			
			var cheese = 100;
			for(var i = 0; i<this.treasureTypeSelector.howMuchCheese.length;i++ ) {
				var cheesyButton = this.treasureTypeSelector.howMuchCheese[i];
				if(cheesyButton.checked) {
					cheese = parseInt(cheesyButton.data_ming);
				}
			}
			
				
			// do this in two rounds. 
			// first, use the cheese limit. 
			// If that fails, use maximmum cheese. 
			for(var zz=0;chosenIndex == -1 && zz<=1;zz++) {
				var maximumBudget;
				if(zz == 0) {
					maximumBudget = this.budget*cheese/100
					if(maximumBudget > budgetRemaining) {
						maximumBudget = budgetRemaining
					}
				}
				else {
					maximumBudget = budgetRemaining
				}
				// ok. What lists does the user want me to pick from?
				var types = this.treasureTypeSelector.getSelectedTypes();
				
				while(types.length > 0 && chosenIndex == -1) {
					var idx = rnd(types.length);
					chosenType = types[idx];
					types.splice(idx, 1);
					chosenIndex = pickATreasureFromList(chosenType, maximumBudget)
				}
				
			}

			// nothing worked. Meh - add moneys.
			if(chosenIndex != -1) {
				treasureBlock.typeSelector.value = chosenType;
				treasureBlock.setType(chosenType);
				treasureBlock.budgetSelector.value = chosenIndex;
				treasureBlock.setAllocationIndex(chosenIndex);
			}			
		}
		
		treasureBlock.reroll();
		return chosenIndex != -1;
	}
	
	function pickATreasureFromList(whichList, maximumBudget) {
		var list = treasureTypeAllocations[whichList]
		if(list[0].budget > maximumBudget) return -1;
		
		var biggestBudget = list[0].budget;
		var biggestBudgetCount = 1;
		var biggestBudgetStartPoint = 0;
		
		for(var i = 1; i<list.length; i++) {
			if(list[i].budget > maximumBudget) {
				break;
			}
			else if(list[i].budget == biggestBudget) {
				biggestBudgetCount ++;
			}
			else {
				biggestBudget = list[i].budget;
				biggestBudgetCount = 1;
				biggestBudgetStartPoint = i;
			}
		}

		// if the biggest budget count is less than three, then mix things up a bit
		// by including in smaller amounts. provided, of course, that we don't wind up including
		// -1
		
		if(biggestBudgetCount < 3) {
			biggestBudgetStartPoint -= (3-biggestBudgetCount);
			biggestBudgetCount += (3-biggestBudgetCount); // yeah, it will always be 3. 
			
			if(biggestBudgetStartPoint < 0) {
				biggestBudgetCount += biggestBudgetStartPoint;
				biggestBudgetStartPoint -= biggestBudgetStartPoint; // again. is will always be zero
			}
			
		}
		
		// pick one of the items at that budget point.
		return biggestBudgetStartPoint + rnd(biggestBudgetCount);
	}

	OverallTreasureBlock.prototype.calculateBudgetConsumed = function() {
		this.budgetConsumed = 0;
		
		for(var i =0; i<this.treasuresCount; i++) {
			this.budgetConsumed += this.treasures[i].getValue();
		}
		
		this.budgetConsumedSpan.innerHTML = this.budgetConsumed;
		if(this.budgetConsumed > this.budget) {
			this.budgetConsumedSpan.style.color = 'red'
		}
		else
		if(this.budgetConsumed < this.budget) {
			this.budgetConsumedSpan.style.color = 'black'
		}
		else {
			this.budgetConsumedSpan.style.color = 'blue'
		}
		
		// if we are recalculating the budget consumed, then something has changed.
		repopulateSummary();
	}

	OverallTreasureBlock.prototype.delete = function() {
		for(var i = this.npcIndex; i<npcCount-1; i++) {
			npcList[i] = npcList[i+1];
			npcList[i].npcIndex = i;
		}
		
		npcCount --;

		var tt = document.getElementById('NPC-TREASURES');
		clearElement(tt);
		for(var i = 0; i<npcCount; i++) {
			tt.appendChild(npcList[i].div);
		}
		
		repopulateSummary(); // redundant, because recalc does this anyway.
		
		recalcTotalTreasureBudget();
	}
	
	OverallTreasureBlock.prototype.setBudget = function(budget) {
		this.budget = budget;
		this.budgetSpan.innerHTML = budget;
		this.reroll();
	}
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// TreasureTypeSelector - monster type, level
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	var radioButtonSeq = 0;
	
	var treasureTypeLabels = {
			'A':'Coins',
			'B':'Coins/Gems',
			'C':'Art',
			'D':'Coins/Small objects',
			'E':'Armour and weapons',
			'F':'Combat gear',
			'G':'Spellcaster gear',
			'H':'Lair treasure',
			'I':'Hoard'
	};
	
	
	function TreasureTypeSelector(overallBlock, div) {
		this.overallBlock = overallBlock;
		this.div = div;
		div.controller = this;
		var dd;
		
		dd = document.createElement('div');
		div.appendChild(dd);
		dd.style.margin = ".5em 0 .5em 0";
		
		function creaturetype(name, treasure, extra, extratreasure) {
			var lbl = document.createElement('span');
			lbl.appendChild(document.createTextNode(name))
			
			if(extra) {
				var lbl2 = document.createElement('span');
				lbl2.appendChild(document.createTextNode(" (" + extra + ")"))
				lbl.appendChild(lbl2);
				lbl2.onclick = function(event) { 
					controller(this).selectTreasureType(treasure + extratreasure); 
					event.cancelBubble = true;
				}
			}
			lbl.style.border = 'thin solid darkGray';
			lbl.style.margin = '1px';
			lbl.style.padding = '1px';
			lbl.style.cursor = 'pointer';
			lbl.onclick = function(event) { 
				controller(this).selectTreasureType(treasure); 
			}
			dd.appendChild(lbl);
		}
		
		creaturetype('Aberration', 'ABE', 'cunning', 'FHG');
		creaturetype('Animal', 'ABDE');
		creaturetype('Construct', 'EF', 'guarding loot', 'BCH');
		creaturetype('Dragon', 'ABCHI');
		creaturetype('Fey', 'BCDG');
		creaturetype('Humanoid', 'ABDEFG', 'entire community', 'H');
		creaturetype('Magical beast', 'ABDE');
		creaturetype('Monstrous humanoid', 'ABCDEH');
		creaturetype('Ooze', 'ABD');
		creaturetype('Outsider', '');
		creaturetype('Plant', 'ABDE');
		creaturetype('Undead', 'ABDE', 'intelligent', 'FG');
		creaturetype('Vermin', 'ABD');
		
		dd = document.createElement('div');
		dd.style.margin = ".5em 0 .5em 0";
		div.appendChild(dd);

		this.checkboxes = new Object();
		var thischeckboxes = this.checkboxes;
		
		for(var i = 'A'.charCodeAt(0); i<='I'.charCodeAt(0);i++) {
			var type = String.fromCharCode(i);
			var lbl = document.createElement('span');
			var checkbox = document.createElement('input');
			checkbox.type = "checkbox";
			lbl.appendChild(checkbox);
			lbl.appendChild(document.createTextNode(type + " - " + treasureTypeLabels[type]));
			lbl.style.border = 'thin solid darkGray';
			lbl.style.margin = '1px';
			lbl.style.padding = '1px';
			lbl.style.cursor = 'pointer';
			lbl.mycheckbox = checkbox;
			
			thischeckboxes[type] = checkbox;
			
			lbl.onclick = function() {
				this.mycheckbox.checked = !this.mycheckbox.checked;
				return true;
			}
			
			dd.appendChild(lbl);
			
			checkbox.onclick = function() {
				this.checked = !this.checked;
				return true;
			}
		}
		
		dd = document.createElement('div');
		dd.style.margin = ".5em 0 .5em 0";
		div.appendChild(dd);

		dd.appendChild(document.createTextNode("Max individual treasure value"));
		
		this.howMuchCheese = [];
		var howMuchCheese = this.howMuchCheese;
		
		function addMaxTreasureValue(pct) {
			var radio = document.createElement('input');
			radio.data_ming = pct
			radio.type = "radio";
			radio.name = radioButtonSeq + '-radio';
			radio.value = "value";
			if(pct==100) radio.checked = true;
			dd.appendChild(radio);
			dd.appendChild(document.createTextNode(pct + "%"));
			howMuchCheese.push(radio);
		}
		
		addMaxTreasureValue(100);
		addMaxTreasureValue(80);
		addMaxTreasureValue(66);
		addMaxTreasureValue(50);
		addMaxTreasureValue(25);
		addMaxTreasureValue(10);
		
		radioButtonSeq++;
	}
	
	TreasureTypeSelector.prototype.toString = function() {
		return "TreasureTypeSelector for " + this.overallBlock;
	}
	
	TreasureTypeSelector.prototype.selectTreasureType = function(types) {
		for(var i = 'A'.charCodeAt(0); i<='I'.charCodeAt(0);i++) {
			var t = String.fromCharCode(i);
			this.checkboxes[t].checked = types.indexOf(t) != -1
		}
	}
	
	TreasureTypeSelector.prototype.getSelectedTypes = function() {
		var selected = [];

		for(var i = 'A'.charCodeAt(0); i<='I'.charCodeAt(0);i++) {
			var type = String.fromCharCode(i);
			if(this.checkboxes[type].checked) {
				selected.push(type);
			}
		}		
		
		if(selected.length == 0) {
			// money is always acceptable
			selected.push('A');
		}
		return selected;
	}
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// TreasureBlock - given treasure type and budget, pick something from the TreasureTypeAllocation lists
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	function TreasureBlock(div, overallTreasureBlock, treasureIndex) {
		this.div = div;
		this.overallTreasureBlock = overallTreasureBlock;
		this.treasureIndex = treasureIndex;
		
		this.generatedGold = [];
		this.generatedGems = [];
		this.generatedArt = [];
		this.generatedItems = [];
		this.generatedWeapons = [];
		this.generatedArmour = [];

		// the current state
		this.type = null;
		this.budget = 1000;
		this.allocation = null; // the currently selected allocation
		
		div.controller = this;
		this.typeSelector = document.createElement('select');

		for(var i = 'A'.charCodeAt(0); i<='I'.charCodeAt(0);i++) {
			var tt = String.fromCharCode(i);
			eee = document.createElement("option");
			eee.text = tt + " - " + treasureTypeLabels[tt];
			eee.value = tt;
			this.typeSelector.appendChild(eee);
		}
		
		div.appendChild(this.typeSelector);
		this.typeSelector.onchange = function(ev) {
			controller(this).setType(this.value)
		};
		
		this.budgetSelector = document.createElement('select');
		div.appendChild(this.budgetSelector);
		
		this.budgetSelector.onchange = function(ev) {
			controller(this).setAllocationIndex(parseInt(this.value))
		};

		var e
		e = document.createElement("button");
		e.innerHTML = "clear";
		e.onclick = function() {
			controller(this).clear();
		};
		div.appendChild(e);

		e = document.createElement("button");
		e.innerHTML = "reroll";
		e.onclick = function() {
			controller(this).reroll();
		};
		div.appendChild(e);

		e = document.createElement("button");
		e.innerHTML = "delete";
		e.onclick = function() {
			controller(this).delete();
		};
		div.appendChild(e);
		
		this.generatedSpan = document.createElement("span");
		div.appendChild(this.generatedSpan);
		
		this.setType('A');
		
	}
	
	TreasureBlock.prototype.toString = function() {
		return "TreasureBlock belonging to " + this.overallTreasureBlock;
	}
	
	TreasureBlock.prototype.clear = function() {
		// clear does not clear the selected combos - it clears the generated treasure.
		
		this.generatedGold.length = 0;
		this.generatedGems.length = 0;
		this.generatedArt.length = 0;
		this.generatedItems.length = 0;
		this.generatedWeapons.length = 0;
		this.generatedArmour.length = 0;
		
		clearElement(this.generatedSpan);
		this.overallTreasureBlock.calculateBudgetConsumed();	
	}
	
	TreasureBlock.prototype.delete = function() {
		for(var i = this.treasureIndex; i<this.overallTreasureBlock.treasuresCount-1; i++) {
			this.overallTreasureBlock.treasures[i] = this.overallTreasureBlock.treasures[i+1];
			this.overallTreasureBlock.treasures[i].treasureIndex = i;
		}
		this.overallTreasureBlock.treasuresCount --;
		
		var tt = this.overallTreasureBlock.treasuresArea;
		clearElement(tt);
		
		for(var i = 0; i<this.overallTreasureBlock.treasuresCount; i++) {
			tt.appendChild(this.overallTreasureBlock.treasures[i].div);
		}
		
		this.overallTreasureBlock.calculateBudgetConsumed();	
	}
	
	TreasureBlock.prototype.getValue = function() {
		return this.allocation == null ? 0 : this.allocation.budget;
	}
	
	TreasureBlock.prototype.setType = function(type) {
		this.clear();

		clearElement(this.budgetSelector);
		
		if(type == null) return;
		
		// poplate the budget selector combo
		
		var allocationV = treasureTypeAllocations[type];
		if(!allocationV) return;
		
		for(var i = 0; i<allocationV.length; i++) {
			eee = document.createElement("option");
			eee.value = i;
			eee.text = allocationV[i].budget;
			this.budgetSelector.appendChild(eee);
		}
		
		this.setAllocationIndex(0);
	}
	
	TreasureBlock.prototype.setAllocationIndex = function(index) {
		var allocationV = treasureTypeAllocations[this.typeSelector.value];
		if(!allocationV) {
			this.setAllocation(null); 
		}
		else {
			this.setAllocation(allocationV[index]);
		}
	}
	
	TreasureBlock.prototype.setAllocation = function(allocation) {
		this.allocation = allocation;
		this.reroll();
	}
	
	TreasureBlock.prototype.reroll = function() {
		this.clear();
		
		if(this.allocation) {
			this.allocation.reroll(this);
		}
		
		// reroll based on the TreasureTypeSelector belonging to my overallTreasureBlock
		// if there is 
		this.overallTreasureBlock.calculateBudgetConsumed();	
	}
	
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// UTILITY AND META-PICKERS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	// plain string is a placeholder class. Once everythihg has been implemented, 
	// none of the rows will be plain strings anymore

	function plainString(s) {
		return new PlainString(s)
	}
	
	function PlainString(s) {
		this.s = s;
	}
	                         	
	PlainString.prototype.toString = function() {
		return this.s;
	}

	PlainString.prototype.reroll = function(treasureBlock) {
		treasureBlock.generatedItems.push(this.s)
		treasureBlock.generatedSpan.appendChild(document.createTextNode(this.s));
	}
	
	// A picker that does multiples, as in "three grade 4 gems"
	
	function mult(howmany, generator) {
		return new Multiple(howmany, generator);
	}
	
	function Multiple(howmany, generator) {
		this.howmany = howmany;
		this.generator = generator;
	}
	
	Multiple.prototype.toString = function() {
		return this.howmany + " * " + generator;
	}

	Multiple.prototype.reroll = function(treasureBlock) {
		for(var i = 0; i < this.howmany; i++) {
			this.generator.reroll(treasureBlock);			
			if(i+1<this.howmany) treasureBlock.generatedSpan.appendChild(document.createTextNode("; "));
		}
		
	}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// COINS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	function CoinDenomination(lbl, cp) {
		this.lbl = lbl;
		this.cp = cp;
	}
	
	CoinDenomination.prototype.toString = function() { return this.lbl;}
	
	var cp = new CoinDenomination('cp', 1);
	var sp = new CoinDenomination('sp', 10);
	var gp = new CoinDenomination('gp', 100);
	var pp = new CoinDenomination('pp', 1000);
	
	// this function builds a coin picker based on a parameter string
	function makeCoinPicker(n, d, mul, denom) {
		return new CoinPicker(n, d, mul, denom);
	}
	
	function CoinPicker(n, d, mul, denom) {
		this.roller = new DiceRoller(n, d, 0)
		this.mul = mul;
		this.denom = denom;
	}
	
	CoinPicker.prototype.toString = function() {
		return this.roller + '×' + (this.mul==1?'':this.mul) + this.denom;
	}

	CoinPicker.prototype.reroll = function(treasureBlock) {
		var result = new CoinPickerResult(this, this.roller.gen());
		treasureBlock.generatedGold.push(result)
		treasureBlock.generatedSpan.appendChild(document.createTextNode(result));
	}
	
	function CoinPickerResult(picker, roll) {
		this.picker = picker;
		this.roll = roll;
	}

	CoinPickerResult.prototype.toString = function() {
		return (this.picker.mul*this.roll.amt) + this.picker.denom.lbl;
	}
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// GEMS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    var gemTypeTable = [
                     null,
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([])
    ];
    
    //bulletproofing
    for(var i = 1; i<=6;i++) {
    	gemTypeTable[i].add(1,100,'grade ' + i + ' gem');
    }
  
    picker = gemTypeTable[1];
    picker.add(1,8,'Agate');
    picker.add(9,14,'Alabaster');
    picker.add(14,20,'Azurite');
    picker.add(21,26,'Hematite');
    picker.add(27,34,'Lapis lazuli');
    picker.add(35,40,'Malachite');
    picker.add(41,48,'Obsidian');
    picker.add(49,56,'Pearl, irregular freshwater');
    picker.add(57,62,'Pyrite');
    picker.add(63,70,'Rhodochrosite');
    picker.add(71,78,'Quartz, rock crystal');
    picker.add(79,84,'Shell');
    picker.add(85,92,'Tigereye');
    picker.add(93,100,'Turquoise');

    picker = gemTypeTable[2];
    picker.add(1,6,'Bloodstone');
    picker.add(7,12,'Carnelian');
    picker.add(13,18,'Chrysoprase');
    picker.add(19,24,'Citrine');
    picker.add(25,32,'Ivory');
    picker.add(33,38,'Jasper');
    picker.add(39,44,'Moonstone');
    picker.add(45,50,'Onyx');
    picker.add(51,56,'Peridot');
    picker.add(57,74,'Quartz, milky, rose, or smoky');
    picker.add(75,80,'Sard');
    picker.add(81,86,'Sardonyx');
    picker.add(87,92,'Spinel, red or green');
    picker.add(94,100,'Zircon');

    picker = gemTypeTable[3];
    picker.add(1,10,'Amber');
    picker.add(11,20,'Amethyst');
    picker.add(21,30,'Chrysoberyl');
    picker.add(31,40,'Coral');
    picker.add(41,50,'Garnet');
    picker.add(51,60,'Jade');
    picker.add(61,70,'Jet');
    picker.add(71,80,'Pearl, saltwater');
    picker.add(81,90,'Spinel, deep blue');
    picker.add(91,100,'Tourmaline');

    picker = gemTypeTable[4];
    picker.add(1,25,'Aquamarine');
    picker.add(26,50,'Opal');
    picker.add(51,75,'Pearl, black');
    picker.add(76,100,'Topaz');

    picker = gemTypeTable[5];
    picker.add(1,25,'Diamond, small');
    picker.add(26,50,'Emerald');
    picker.add(51,75,'Ruby, small');
    picker.add(76,100,'Sapphire');

    picker = gemTypeTable[6];
    picker.add(1,25,'Diamond, large');
    picker.add(26,50,'Emerald, brilliant green');
    picker.add(51,75,'Ruby, large');
    picker.add(76,100,'Sapphire, star');
    
	function gemPicker(grade) {
		return new GemPicker(grade)
	}
	
	function GemPicker(grade) {
		this.grade = grade;
	}
	                         	
	GemPicker.prototype.toString = function() {
		return 'Grade ' + this.grade + ' gem';
	}

	GemPicker.prototype.reroll = function(treasureBlock) {
		var result = new GemResult(this.grade);
		treasureBlock.generatedGems.push(result)
		treasureBlock.generatedSpan.appendChild(document.createTextNode(result));
	}

	function GemValueRoller(base, n,d,mul) {
		this.base = base;
		this.n = n;
		this.d = d;
		this.mul=mul;
	}
	
	var gemValueRollers = [
	                       null,
	                       new GemValueRoller(5,2,4,1),
	                       new GemValueRoller(25,2,4,5),
	                       new GemValueRoller(50,2,4,10),
	                       new GemValueRoller(250,2,4,50),
	                       new GemValueRoller(500,2,4,100),
	                       new GemValueRoller(2500,2,4,500)
	                       ];
	
	GemValueRoller.prototype.getRoll = function() {
		return this.base + roll(this.n, this.d) * this.mul;	 
	}
	
	function GemResult(grade) {
		this.grade=grade;
		this.base=gemValueRollers[grade].getRoll();
		this.worked = (rnd(2) == 1);
		this.gemType = gemTypeTable[grade].gen().generated
	}
	
	GemResult.prototype.getValue = function() {
		return this.worked ? this.base : this.base/2;
	}

	GemResult.prototype.toString = function() {
		return this.gemType + " (" + (this.worked?'':'unworked ') + this.getValue() + "gp)";
	}
	
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// ART OBJECTS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	// I may not know much about it, but I know what I like

    var artTypeTable = [
                     null,
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([]),
                     new D100Picker([])
    ];

	function ArtObject(lbl, amt) {
		this.lbl = lbl;
		this.amt = amt;
	}
	
	ArtObject.prototype.toString = function() {
		return this.lbl + " ("+this.amt+"gp)";
	}

	function artPicker(grade) {
		return new ArtPicker(grade);
	}
	
	function ArtPicker(grade) {
		this.grade = grade;
	}
	
	ArtPicker.prototype.reroll = function(treasureBlock) {
		var result = new ArtResult(this.grade);
		treasureBlock.generatedArt.push(result)
		treasureBlock.generatedSpan.appendChild(document.createTextNode(result));
	}
	
	function ArtResult(grade) {
		this.grade = grade;
		// there is space here to add multipliers for 'very good' or 'crappy' art
		this.artObject = artTypeTable[grade].gen().generated
	}
	
	ArtResult.prototype.toString = function() {
		return this.artObject.toString();
	}

	ArtResult.prototype.getValue = function() {
		return this.artObject.amt;
	}

	artTypeTable[1].add(1,100,new ArtObject('grade 1 art object', 50))
	artTypeTable[2].add(1,100,new ArtObject('grade 2 art object', 100))
	artTypeTable[3].add(1,100,new ArtObject('grade 3 art object', 500))
	artTypeTable[4].add(1,100,new ArtObject('grade 4 art object', 1000))
	artTypeTable[5].add(1,100,new ArtObject('grade 5 art object', 5000))
	artTypeTable[6].add(1,100,new ArtObject('grade 6 art object', 10000))
	


picker = artTypeTable[1];
picker.add(1, 5, new ArtObject('Bronze statuette of a warrior', 15));
picker.add(6, 6, new ArtObject('Elaborate copper wind chimes', 20));
picker.add(7, 7, new ArtObject('Painted paper fan with silver slats', 20));
picker.add(8, 9, new ArtObject('Copper and glass decanter', 25));
picker.add(10, 17, new ArtObject('Silver holy symbol', 25));
picker.add(18, 21, new ArtObject('Carved stone idol', 30));
picker.add(22, 25, new ArtObject('Set of six ivory dice', 30));
picker.add(26, 29, new ArtObject('Ivory bowl with animal carvings', 40));
picker.add(30, 30, new ArtObject('Porcelain doll with silk clothing', 40));
picker.add(31, 32, new ArtObject('Porcelain mask', 40));
picker.add(33, 36, new ArtObject('Bronze flagon with warrior images', 50));
picker.add(37, 39, new ArtObject('Copper brazier with religious markings', 50));
picker.add(40, 42, new ArtObject('Copper scepter with gold inlay', 50));
picker.add(43, 44, new ArtObject('Crystal egg with silver stand', 50));
picker.add(45, 46, new ArtObject('Painting of a noblewoman', 50));
picker.add(47, 51, new ArtObject('Polished darkwood chalice', 50));
picker.add(52, 52, new ArtObject('Silver baby rattle', 50));
picker.add(53, 55, new ArtObject('Silver chess set', 50));
picker.add(56, 60, new ArtObject('Carved ivory scroll case', 60));
picker.add(61, 66, new ArtObject('Decorated silver plate', 60));
picker.add(67, 71, new ArtObject('Ivory drinking horn with copper ends', 60));
picker.add(72, 74, new ArtObject('Silver noble family seal', 60));
picker.add(75, 80, new ArtObject('Silver statue of a dragon', 65));
picker.add(81, 83, new ArtObject('Electrum censer with silver filigree', 70));
picker.add(84, 87, new ArtObject('Silver candelabra with holy symbol', 75));
picker.add(88, 90, new ArtObject('Silver comb with ornate handle', 75));
picker.add(91, 93, new ArtObject('Silver hand mirror', 75));
picker.add(94, 96, new ArtObject('Crystal skull', 80));
picker.add(97, 97, new ArtObject('Ornate silver flute', 80));
picker.add(98, 100, new ArtObject('Engraved jade scarab', 85));

picker = artTypeTable[2];
picker.add(1, 2, new ArtObject('Elaborate silver wind chimes', 60));
picker.add(3, 8, new ArtObject('Engraved gold scarab', 75));
picker.add(9, 10, new ArtObject('Painted silk fan with electrum slats', 75));
picker.add(11, 12, new ArtObject('Preserved beast head on a plaque', 75));
picker.add(13, 17, new ArtObject('Set of six silver dice', 75));
picker.add(18, 20, new ArtObject('Silver and glass decanter', 75));
picker.add(21, 22, new ArtObject('Silver bowl with lion engravings', 75));
picker.add(23, 26, new ArtObject('Silver mask', 75));
picker.add(27, 30, new ArtObject('Carved jade idol', 80));
picker.add(31, 31, new ArtObject('Porcelain doll with furs and jewelry', 80));
picker.add(32, 35, new ArtObject('Silver brazier with religious markings', 80));
picker.add(36, 38, new ArtObject('Silver flagon with religious markings', 80));
picker.add(39, 41, new ArtObject('Gold censer with silver filigree', 90));
picker.add(42, 44, new ArtObject('Gold and silver chess set', 100));
picker.add(45, 45, new ArtObject('Gold baby rattle', 100));
picker.add(46, 53, new ArtObject('Gold holy symbol', 100));
picker.add(54, 56, new ArtObject('Masterwork lyre', 100));
picker.add(57, 58, new ArtObject('Painting of a princess', 100));
picker.add(59, 61, new ArtObject('Silver cup with royal crest', 100));
picker.add(62, 65, new ArtObject('Decorated electrum plate', 110));
picker.add(66, 69, new ArtObject('Gold statue of a dragon', 110));
picker.add(70, 72, new ArtObject('Gold statue of a lion', 110));
picker.add(73, 77, new ArtObject('Ivory drinking horn with silver ends', 110));
picker.add(78, 81, new ArtObject('Gold and silver hand mirror', 120));
picker.add(82, 85, new ArtObject('Silver cauldron with animal symbols', 120));
picker.add(86, 88, new ArtObject('Silver comb with gold handle', 125));
picker.add(89, 90, new ArtObject('Silver egg with dragon figurine', 125));
picker.add(91, 92, new ArtObject('Silver scepter with eagle symbols', 125));
picker.add(93, 97, new ArtObject('Silver chalice with dragon carvings', 150));
picker.add(98, 100, new ArtObject('Gold candelabra with holy symbol', 200));

picker = artTypeTable[3];
picker.add(1, 3, new ArtObject('Gilded demon skull', 300));
picker.add(4, 13, new ArtObject('Marble idol', 300));
picker.add(14, 19, new ArtObject('Masterwork darkwood lute', 300));
picker.add(20, 24, new ArtObject('Engraved mithral scarab', 400));
picker.add(25, 28, new ArtObject('Gold and ivory decanter', 400));
picker.add(29, 32, new ArtObject('Gold bowl with dragon engravings', 400));
picker.add(33, 35, new ArtObject('Gold censer with platinum inlay', 400));
picker.add(36, 41, new ArtObject('Gold mask', 450));
picker.add(42, 42, new ArtObject('Gold and mithral baby rattle', 500));
picker.add(43, 48, new ArtObject('Gold chess set', 500));
picker.add(49, 51, new ArtObject('Gold flagon with religious markings', 500));
picker.add(52, 56, new ArtObject('Gold puzzle box', 500));
picker.add(57, 65, new ArtObject('Platinum holy symbol', 500));
picker.add(66, 69, new ArtObject('Gold cup with royal crest', 550));
picker.add(70, 77, new ArtObject('Gold chalice with griffon carvings', 600));
picker.add(78, 81, new ArtObject('Mithral scepter with gold inlay', 600));
picker.add(82, 88, new ArtObject('Decorated gold plate', 700));
picker.add(89, 93, new ArtObject('Gold and platinum statuette of a deity', 750));
picker.add(94, 96, new ArtObject('Gold cauldron with alchemical symbols', 750));
picker.add(97, 100, new ArtObject('Painting of a queen', 750));

picker = artTypeTable[4];
picker.add(1, 5, new ArtObject('Engraved platinum scarab', 700));
picker.add(6, 11, new ArtObject('Gilded dragon skull', 800));
picker.add(12, 18, new ArtObject('Platinum bowl with arcane engravings', 800));
picker.add(19, 22, new ArtObject('Platinum censer with ornate markings', 800));
picker.add(23, 26, new ArtObject('Gold decanter with grape vine patterns', 850));
picker.add(27, 31, new ArtObject('Platinum mask', 900));
picker.add(32, 36, new ArtObject('Gold and mithral chess set', 1000));
picker.add(37, 41, new ArtObject('Gold and platinum orrery', 1000));
picker.add(42, 46, new ArtObject('Gold flute', 1000));
picker.add(47, 51, new ArtObject('Gold idol with strange carvings', 1000));
picker.add(52, 52, new ArtObject('Platinum baby rattle', 1000));
picker.add(53, 55, new ArtObject('Platinum holy symbol of a famous priest', 1000));
picker.add(56, 64, new ArtObject('Decorated platinum plate', 1100));
picker.add(65, 68, new ArtObject('Platinum cauldron with odd symbols', 1100));
picker.add(69, 71, new ArtObject('Platinum flagon with religious markings', 1100));
picker.add(72, 77, new ArtObject('Platinum cup with royal crest', 1200));
picker.add(78, 81, new ArtObject('Platinum scepter with gold inlay', 1200));
picker.add(82, 87, new ArtObject('Platinum chalice with angel carvings', 1250));
picker.add(88, 93, new ArtObject('Platinum statuette of a deity', 1300));
picker.add(94, 100, new ArtObject('Painting of a queen by a master', 1500));

picker = artTypeTable[5];
picker.add(1, 8, new ArtObject('Book of lost songs by a famous bard', 3000));
picker.add(9, 16, new ArtObject('Darkwood and platinum music box', 4000));
picker.add(17, 26, new ArtObject('Mithral hourglass with diamond dust', 4000));
picker.add(27, 34, new ArtObject('Jeweled egg with epic sorcerer’s blood', 4500));
picker.add(35, 37, new ArtObject('Gold urn containing hero’s ashes', 5000));
picker.add(38, 45, new ArtObject('Helm carved from a pit fiend skull', 5000));
picker.add(46, 55, new ArtObject('Holy text penned by a saint', 5000));
picker.add(56, 65, new ArtObject('Painting of a beloved queen by a master', 5000));
picker.add(66, 74, new ArtObject('Platinum idol with mysterious markings', 5000));
picker.add(75, 77, new ArtObject('Bejeweled sword of state', 6000));
picker.add(78, 83, new ArtObject('Carved saint’s femur', 6000));
picker.add(84, 88, new ArtObject('Platinum chalice blessed by a saint', 6000));
picker.add(89, 91, new ArtObject('Glowing metallic meteor', 6500));
picker.add(92, 97, new ArtObject('Gold bejeweled royal orb', 7000));
picker.add(98, 100, new ArtObject('Crystallized dragon heart', 7500));

picker = artTypeTable[6];
picker.add(1, 6, new ArtObject('Frozen vampire soul', 7000));
picker.add(7, 13, new ArtObject('Mithral-inlaid unicorn horn', 7000));
picker.add(14, 16, new ArtObject('Crystallized god breath', 10000));
picker.add(17, 22, new ArtObject('Essence of truth', 10000));
picker.add(23, 31, new ArtObject('Globe of pristine air', 10000));
picker.add(32, 40, new ArtObject('Heart of the mountain', 10000));
picker.add(41, 46, new ArtObject('Inverted soul gem', 10000));
picker.add(47, 55, new ArtObject('Orb of living water', 10000));
picker.add(56, 64, new ArtObject('Shard of pure fire', 10000));
picker.add(65, 72, new ArtObject('Unmelting ice', 10000));
picker.add(73, 79, new ArtObject('Time jewel', 11000));
picker.add(80, 83, new ArtObject('Adamantine poiuyt', 12000));
picker.add(84, 89, new ArtObject('Holy text written in saint’s blood', 12000));
picker.add(90, 93, new ArtObject('Mithral tribar', 12000));
picker.add(94, 100, new ArtObject('Ethereal tapestry', 13000));
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Item Picker. For scrolls, potions, and wands (that is, we have three distinct item pickers of ItemPicker class).
// An item picker has a grade, which is text - 'lesser meduium', 'greter major'. Two rolls are made. One bsed on the grade
// to determine the level, which is an int, and one to determine the type, which is text - 'common', 'uncommon divine'.
// the combination of level and type result in what table gets chosen.
// Itempicker results are simply the itempicker row.
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function ItemPickerRow(lbl, val, src) {
	this.lbl = lbl;
	this.val = val;
	this.src = src;
}

ItemPickerRow.prototype.toString = function() {
	return "ItemPickerRow(" + this.lbl + " " + this.val + " " + this.src + ")";
}

function ItemPickerTableset(lbl) {
	this.lbl = lbl;
	this.gradeToLevel = new Object();
	this.chooseType = new D100Picker([]);
	this.typeAndLevelToPicker = new Object();
}

ItemPickerTableset.prototype.toString = function() {
	return this.lbl + " table set";
}

ItemPickerTableset.prototype.gen = function(grade) {
	var level = this.gradeToLevel[grade].gen().item;
	var type = this.chooseType.gen().item;
	return new ItemPickerTableResult(grade, this.typeAndLevelToPicker[type][level].picker.gen());
}

ItemPickerTableset.prototype.setGradeToLevel = function(a, b, grade, level) {
	if(!this.gradeToLevel[grade]) {
		this.gradeToLevel[grade] = new D100Picker([]);
	}
	this.gradeToLevel[grade].add(a, b, level);
}

ItemPickerTableset.prototype.setupItemPickerTables = function() {
	var knownTypes = new Object();
	var knownLevels = new Object();

	for(var grade in this.gradeToLevel) {
		for(var i = 1; i<=100; i++) {
			knownLevels[this.gradeToLevel[grade].v[i].item] = 'known';
		}
	}

	for(var i = 1; i<=100; i++) {
		knownTypes[this.chooseType.v[i].item] = 'yes'; 
	}
		
	for(var type in knownTypes) {
		this.typeAndLevelToPicker[type] = [];
		for(var level in knownLevels) {
			this.typeAndLevelToPicker[type][level] = new ItemPickerTable(this, type, level); 
			this.typeAndLevelToPicker[type][level].picker.add(1, 100, new ItemPickerRow("undefined " + this.lbl, 0, 'DEV'));
		}
	}
}

function ItemPickerTable(tableset, type, level) {
	this.tableset = tableset
	this.type = type
	this.level = level
	this.picker = new D100Picker(this);
}

ItemPickerTable.prototype.toString = function() {
	return "ItemPickerTable(" + this.tableset + ", " + this.type + "," + this.level+ ")"
}

ItemPickerTable.prototype.add = function(a, b, lbl, val, src) {
	var row = new ItemPickerRow(lbl, val, src);
	this.picker.add(a, b, row);
}

function ItemPickerTableResult(grade, roll) {
	this.isItemPickerTableResult = true
	this.grade = grade;
	this.itemPickerTable = roll.gen.v;
	this.item = roll.item;
	this.generated = roll.generated;
}

ItemPickerTableResult.prototype.toString = function() {
	return this.grade + " "
	+ this.itemPickerTable.tableset.lbl + ": "
	+ this.itemPickerTable.type + " level "
	+ this.itemPickerTable.level + ": "
	+ this.item.lbl + " " 
	+ this.item.val + "gp (" + this.item.src + ")"
}

function ItemPicker(tableset, grade) {
	this.tableset = tableset;
	this.grade = grade;
}

ItemPicker.prototype.toString = function() {
	this.tableset.lbl + " grade " + this.grade + " picker"
}

ItemPicker.prototype.reroll = function(treasureBlock) {
	var result = this.tableset.gen(this.grade);
	treasureBlock.generatedItems.push(result)
	treasureBlock.generatedSpan.appendChild(document.createTextNode(result));
}

function potion(grade) {
	return new ItemPicker(potions, grade);
}

var potions = new ItemPickerTableset('potion');
var scrolls = new ItemPickerTableset('scroll');
var wands = new ItemPickerTableset('wand');

var lesser_minor_potion = new ItemPicker(potions, 'lesser minor');
var greater_minor_potion = new ItemPicker(potions, 'greater minor');
var lesser_medium_potion = new ItemPicker(potions, 'lesser medium');
var greater_medium_potion = new ItemPicker(potions, 'greater medium');
var lesser_major_potion = new ItemPicker(potions, 'lesser major');
var greater_major_potion = new ItemPicker(potions, 'greater major');

potions.setGradeToLevel(1,40,'lesser minor', 0);
potions.setGradeToLevel(41,100,'lesser minor', 1);

potions.setGradeToLevel(1,10,'greater minor', 0);
potions.setGradeToLevel(11,60,'greater minor', 1);
potions.setGradeToLevel(61,100,'greater minor', 2);

potions.setGradeToLevel(1,25,'lesser medium', 1);
potions.setGradeToLevel(26,85,'lesser medium', 2);
potions.setGradeToLevel(86,100,'lesser medium', 3);

potions.setGradeToLevel(1,10,'greater medium', 1);
potions.setGradeToLevel(11,50,'greater medium', 2);
potions.setGradeToLevel(51,100,'greater medium', 3);

potions.setGradeToLevel(1,35,'lesser major', 2);
potions.setGradeToLevel(36,100,'lesser major', 3);

potions.setGradeToLevel(1,10,'greater major', 2);
potions.setGradeToLevel(11,100,'greater major', 3);

potions.chooseType.add(1,75, 'common');
potions.chooseType.add(76,100, 'uncommon');

potions.setupItemPickerTables();


var lesser_minor_scroll = new ItemPicker(scrolls, 'lesser minor');
var greater_minor_scroll = new ItemPicker(scrolls, 'greater minor');
var lesser_medium_scroll = new ItemPicker(scrolls, 'lesser medium');
var greater_medium_scroll = new ItemPicker(scrolls, 'greater medium');
var lesser_major_scroll = new ItemPicker(scrolls, 'lesser major');
var greater_major_scroll = new ItemPicker(scrolls, 'greater major');

scrolls.setGradeToLevel(1,15,'lesser minor', 0);
scrolls.setGradeToLevel(16,95,'lesser minor', 1);
scrolls.setGradeToLevel(96,100,'lesser minor', 2);

scrolls.setGradeToLevel(1,5,'greater minor', 0);
scrolls.setGradeToLevel(6,35,'greater minor', 1);
scrolls.setGradeToLevel(36,90,'greater minor', 2);
scrolls.setGradeToLevel(91,100,'greater minor', 3);

scrolls.setGradeToLevel(1,10,'lesser medium', 2);
scrolls.setGradeToLevel(11,55,'lesser medium', 3);
scrolls.setGradeToLevel(56,100,'lesser medium', 4);

scrolls.setGradeToLevel(1,20,'greater medium', 3);
scrolls.setGradeToLevel(21,60,'greater medium', 4);
scrolls.setGradeToLevel(61,100,'greater medium', 5);

scrolls.setGradeToLevel(1,30,'lesser major', 4);
scrolls.setGradeToLevel(31,65,'lesser major', 5);
scrolls.setGradeToLevel(66,90,'lesser major', 6);
scrolls.setGradeToLevel(91,100,'lesser major', 7);

scrolls.setGradeToLevel(1,5,'greater major', 6);
scrolls.setGradeToLevel(6,35,'greater major', 7);
scrolls.setGradeToLevel(36,70,'greater major', 8);
scrolls.setGradeToLevel(71,100,'greater major', 9);

scrolls.chooseType.add(1,45, 'common arcane');
scrolls.chooseType.add(46,60, 'uncommon arcane');
scrolls.chooseType.add(61,90, 'common divine');
scrolls.chooseType.add(90,100, 'uncommon divine');

scrolls.setupItemPickerTables();


var lesser_minor_wand = new ItemPicker(wands, 'lesser minor');
var greater_minor_wand = new ItemPicker(wands, 'greater minor');
var lesser_medium_wand = new ItemPicker(wands, 'lesser medium');
var greater_medium_wand = new ItemPicker(wands, 'greater medium');
var lesser_major_wand = new ItemPicker(wands, 'lesser major');
var greater_major_wand = new ItemPicker(wands, 'greater major');

wands.setGradeToLevel(1,40,'lesser minor', 0);
wands.setGradeToLevel(41,100,'lesser minor', 1);

wands.setGradeToLevel(1,80,'greater minor', 1);
wands.setGradeToLevel(81,100,'greater minor', 2);

wands.setGradeToLevel(1,75,'lesser medium', 2);
wands.setGradeToLevel(76,100,'lesser medium', 3);

wands.setGradeToLevel(1,20,'greater medium', 2);
wands.setGradeToLevel(21,100,'greater medium', 3);

wands.setGradeToLevel(1,60,'lesser major', 3);
wands.setGradeToLevel(61,100,'lesser major', 4);

wands.setGradeToLevel(1,30,'greater major', 3);
wands.setGradeToLevel(31,100,'greater major', 4);

wands.chooseType.add(1,75, 'common');
wands.chooseType.add(76,100, 'uncommon');

wands.setupItemPickerTables();

// OK! Now load the data
picker = potions.typeAndLevelToPicker['common'][0];

picker.add(1, 14, 'Arcane mark', 25, 'CR');
picker.add(15, 28, 'Guidance', 25, 'CR');
picker.add(29, 44, 'Light', 25, 'CR');
picker.add(45, 58, 'Purify food and drink', 25, 'CR');
picker.add(59, 72, 'Resistance', 25, 'CR');
picker.add(73, 86, 'Stabilize', 25, 'CR');
picker.add(87, 100, 'Virtue', 25, 'CR');

picker = potions.typeAndLevelToPicker['uncommon'][0];

picker.add(1, 14, 'Arcane mark', 25, 'CR');
picker.add(15, 28, 'Guidance', 25, 'CR');
picker.add(29, 44, 'Light', 25, 'CR');
picker.add(45, 58, 'Purify food and drink', 25, 'CR');
picker.add(59, 72, 'Resistance', 25, 'CR');
picker.add(73, 86, 'Stabilize', 25, 'CR');
picker.add(87, 100, 'Virtue', 25, 'CR');

picker = potions.typeAndLevelToPicker['common'][1];

picker.add(1, 4, 'Bless weapon', 50, 'CR');
picker.add(5, 14, 'Cure light wounds', 50, 'CR');
picker.add(15, 19, 'Endure elements', 50, 'CR');
picker.add(20, 27, 'Enlarge person', 50, 'CR');
picker.add(28, 33, 'Jump', 50, 'CR');
picker.add(34, 41, 'Mage armor', 50, 'CR');
picker.add(42, 47, 'Magic fang', 50, 'CR');
picker.add(48, 55, 'Magic weapon', 50, 'CR');
picker.add(56, 60, 'Pass without trace', 50, 'CR');
picker.add(61, 64, 'Protection from chaos', 50, 'CR');
picker.add(65, 68, 'Protection from evil', 50, 'CR');
picker.add(69, 72, 'Protection from good', 50, 'CR');
picker.add(73, 76, 'Protection from law', 50, 'CR');
picker.add(77, 81, 'Reduce person', 50, 'CR');
picker.add(82, 87, 'Remove fear', 50, 'CR');
picker.add(88, 92, 'Sanctuary', 50, 'CR');
picker.add(93, 100, 'Shield of faith', 50, 'CR');


picker = potions.typeAndLevelToPicker['uncommon'][1];

picker.add(1, 4, 'Animate rope', 50, 'CR');
picker.add(5, 11, 'Ant haul', 50, 'APG');
picker.add(12, 16, 'Cloak of the shade', 50, 'APG');
picker.add(17, 20, 'Erase', 50, 'CR');
picker.add(21, 26, 'Feather step', 50, 'APG');
picker.add(27, 30, 'Goodberry', 50, 'CR');
picker.add(31, 34, 'Grease', 50, 'CR');
picker.add(35, 41, 'Hide from animals', 50, 'CR');
picker.add(42, 49, 'Hide from undead', 50, 'CR');
picker.add(50, 53, 'Hold portal', 50, 'CR');
picker.add(54, 58, 'Invigorate', 50, 'APG');
picker.add(59, 64, 'Keen senses', 50, 'APG');
picker.add(65, 68, 'Magic stone', 50, 'CR');
picker.add(69, 75, 'Remove sickness', 50, 'UM');
picker.add(76, 80, 'Sanctify corpse', 50, 'UM');
picker.add(81, 84, 'Shillelagh', 50, 'CR');
picker.add(85, 92, 'Touch of the sea', 50, 'APG');
picker.add(93, 100, 'Vanish', 50, 'APG');


picker = potions.typeAndLevelToPicker['common'][2];

picker.add(1, 4, 'Aid', 300, 'CR');
picker.add(5, 7, 'Align weapon', 300, 'CR');
picker.add(8, 11, 'Barkskin', 300, 'CR');
picker.add(12, 16, 'Bear’s endurance', 300, 'CR');
picker.add(17, 20, 'Blur', 300, 'CR');
picker.add(21, 25, 'Bull’s strength', 300, 'CR');
picker.add(26, 30, 'Cat’s grace', 300, 'CR');
picker.add(31, 37, 'Cure moderate wounds', 300, 'CR');
picker.add(38, 41, 'Darkvision', 300, 'CR');
picker.add(42, 44, 'Delay poison', 300, 'CR');
picker.add(45, 49, 'Eagle’s splendor', 300, 'CR');
picker.add(50, 54, 'Fox’s cunning', 300, 'CR');
picker.add(55, 61, 'Invisibility', 300, 'CR');
picker.add(62, 66, 'Levitate', 300, 'CR');
picker.add(67, 71, 'Owl’s wisdom', 300, 'CR');
picker.add(72, 73, 'Protection from arrows', 300, 'CR');
picker.add(74, 76, 'Remove paralysis', 300, 'CR');
picker.add(77, 80, 'Resist energy, acid', 300, 'CR');
picker.add(81, 84, 'Resist energy, cold', 300, 'CR');
picker.add(85, 88, 'Resist energy, electricity', 300, 'CR');
picker.add(89, 92, 'Resist energy, fire', 300, 'CR');
picker.add(93, 94, 'Resist energy, sonic', 300, 'CR');
picker.add(95, 98, 'Spider climb', 300, 'CR');
picker.add(99, 100, 'Undetectable alignment', 300, 'CR');


picker = potions.typeAndLevelToPicker['uncommon'][2];

picker.add(1, 6, 'Ablative barrier', 300, 'UC');
picker.add(7, 14, 'Acute senses', 300, 'UM');
picker.add(15, 19, 'Arcane lock', 300, 'CR');
picker.add(20, 24, 'Bullet shield', 300, 'UC');
picker.add(25, 30, 'Certain grip', 300, 'UC');
picker.add(31, 35, 'Continual flame', 350, 'CR');
picker.add(36, 40, 'Corruption resistance', 300, 'APG');
picker.add(41, 48, 'Disguise other', 300, 'UM');
picker.add(49, 56, 'Gentle repose', 300, 'CR');
picker.add(57, 61, 'Make whole', 300, 'CR');
picker.add(62, 67, 'Obscure object', 300, 'CR');
picker.add(68, 72, 'Reduce animal', 300, 'CR');
picker.add(73, 76, 'Rope trick', 300, 'CR');
picker.add(77, 82, 'Slipstream', 300, 'APG');
picker.add(83, 90, 'Status', 300, 'CR');
picker.add(91, 95, 'Warp wood', 300, 'CR');
picker.add(96, 100, 'Wood shape', 300, 'CR');


picker = potions.typeAndLevelToPicker['common'][3];

picker.add(1, 6, 'Cure serious wounds', 750, 'CR');
picker.add(7, 10, 'Dispel magic', 750, 'CR');
picker.add(11, 14, 'Displacement', 750, 'CR');
picker.add(15, 20, 'Fly', 750, 'CR');
picker.add(21, 25, 'Gaseous form', 750, 'CR');
picker.add(26, 29, 'Good hope', 750, 'CR');
picker.add(30, 35, 'Haste', 750, 'CR');
picker.add(36, 40, 'Heroism', 750, 'CR');
picker.add(41, 44, 'Keen edge', 750, 'CR');
picker.add(45, 48, 'Magic fang, greater', 750, 'CR');
picker.add(49, 52, 'Magic vestment', 750, 'CR');
picker.add(53, 57, 'Neutralize poison', 750, 'CR');
picker.add(58, 60, 'Protection from energy, acid', 750, 'CR');
picker.add(61, 63, 'Protection from energy, cold', 750, 'CR');
picker.add(64, 66, 'Protection from energy, electricity', 750, 'CR');
picker.add(67, 69, 'Protection from energy, fire', 750, 'CR');
picker.add(70, 71, 'Protection from energy, sonic', 750, 'CR');
picker.add(72, 74, 'Rage', 750, 'CR');
picker.add(75, 77, 'Remove blindness/deafness', 750, 'CR');
picker.add(78, 81, 'Remove curse', 750, 'CR');
picker.add(82, 86, 'Remove disease', 750, 'CR');
picker.add(87, 91, 'Tongues', 750, 'CR');
picker.add(92, 96, 'Water breathing', 750, 'CR');
picker.add(97, 100, 'Water walk', 750, 'CR');


picker = potions.typeAndLevelToPicker['uncommon'][3];

picker.add(1, 12, 'Burrow', 750, 'UM');
picker.add(11, 22, 'Countless eyes', 750, 'UM');
picker.add(23, 34, 'Daylight', 750, 'CR');
picker.add(35, 49, 'Draconic reservoir', 750, 'APG');
picker.add(50, 58, 'Flame arrow', 750, 'CR');
picker.add(59, 67, 'Shrink item', 750, 'CR');
picker.add(68, 77, 'Stone shape', 750, 'CR');
picker.add(78, 87, 'Fire trap', 775, 'CR');
picker.add(88, 100, 'Nondetection', 800, 'CR');



picker = scrolls.typeAndLevelToPicker['common arcane'][0];
picker.add(1, 9, 'Acid splash', 12.5, 'CR');
picker.add(10, 17, 'Daze', 12.5, 'CR');
picker.add(18, 27, 'Detect magic', 12.5, 'CR');
picker.add(28, 35, 'Flare', 12.5, 'CR');
picker.add(36, 45, 'Light', 12.5, 'CR');
picker.add(46, 55, 'Mage hand', 12.5, 'CR');
picker.add(56, 63, 'Mending', 12.5, 'CR');
picker.add(64, 72, 'Prestidigitation', 12.5, 'CR');
picker.add(73, 81, 'Ray of frost', 12.5, 'CR');
picker.add(82, 91, 'Read magic', 12.5, 'CR');
picker.add(92, 100, 'Touch of fatigue', 12.5, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][0];
picker.add(1, 7, 'Arcane mark', 12.5, 'CR');
picker.add(8, 17, 'Bleed', 12.5, 'CR');
picker.add(18, 25, 'Dancing lights', 12.5, 'CR');
picker.add(26, 35, 'Detect poison', 12.5, 'CR');
picker.add(36, 42, 'Disrupt undead', 12.5, 'CR');
picker.add(43, 51, 'Ghost sound', 12.5, 'CR');
picker.add(52, 61, 'Message', 12.5, 'CR');
picker.add(62, 68, 'Open/close', 12.5, 'CR');
picker.add(69, 75, 'Resistance', 12.5, 'CR');
picker.add(76, 83, 'Sift', 12.5, 'APG');
picker.add(84, 92, 'Spark', 12.5, 'APG');
picker.add(93, 100, 'Unwitting ally', 12.5, 'APG');

picker = scrolls.typeAndLevelToPicker['common arcane'][1];
picker.add(1, 5, 'Burning hands', 25, 'CR');
picker.add(6, 9, 'Cause fear', 25, 'CR');
picker.add(10, 14, 'Charm person', 25, 'CR');
picker.add(15, 17, 'Chill touch', 25, 'CR');
picker.add(18, 21, 'Disguise self', 25, 'CR');
picker.add(22, 24, 'Endure elements', 25, 'CR');
picker.add(25, 28, 'Enlarge person', 25, 'CR');
picker.add(29, 32, 'Expeditious retreat', 25, 'CR');
picker.add(33, 36, 'Grease', 25, 'CR');
picker.add(37, 39, 'Hypnotism', 25, 'CR');
picker.add(40, 42, 'Identify', 25, 'CR');
picker.add(43, 48, 'Mage armor', 25, 'CR');
picker.add(49, 54, 'Magic missile', 25, 'CR');
picker.add(55, 58, 'Magic weapon', 25, 'CR');
picker.add(59, 62, 'Obscuring mist', 25, 'CR');
picker.add(63, 64, 'Protection from chaos', 25, 'CR');
picker.add(65, 67, 'Protection from evil', 25, 'CR');
picker.add(68, 69, 'Protection from good', 25, 'CR');
picker.add(70, 71, 'Protection from law', 25, 'CR');
picker.add(72, 75, 'Ray of enfeeblement', 25, 'CR');
picker.add(76, 80, 'Shield', 25, 'CR');
picker.add(81, 84, 'Shocking grasp', 25, 'CR');
picker.add(85, 88, 'Silent image', 25, 'CR');
picker.add(89, 93, 'Sleep', 25, 'CR');
picker.add(94, 96, 'Summon monster I', 25, 'CR');
picker.add(97, 100, 'True strike', 25, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][1];
picker.add(1, 2, 'Air bubble', 25, 'UC');
picker.add(3, 6, 'Alarm', 25, 'CR');
picker.add(7, 8, 'Animate rope', 25, 'CR');
picker.add(9, 12, 'Ant haul', 25, 'APG');
picker.add(13, 15, 'Blend', 25, 'ARG');
picker.add(16, 18, 'Break', 25, 'APG');
picker.add(19, 23, 'Color spray', 25, 'CR');
picker.add(24, 26, 'Comprehend languages', 25, 'CR');
picker.add(27, 30, 'Corrosive touch', 25, 'UM');
picker.add(31, 33, 'Detect secret doors', 25, 'CR');
picker.add(34, 36, 'Detect undead', 25, 'CR');
picker.add(37, 38, 'Erase', 25, 'CR');
picker.add(39, 40, 'Flare burst', 25, 'APG');
picker.add(41, 43, 'Floating disk', 25, 'CR');
picker.add(44, 46, 'Hold portal', 25, 'CR');
picker.add(47, 48, 'Hydraulic push', 25, 'APG');
picker.add(49, 51, 'Icicle dagger', 25, 'UM');
picker.add(52, 54, 'Illusion of calm', 25, 'UC');
picker.add(55, 58, 'Jump', 25, 'CR');
picker.add(59, 60, 'Magic aura', 25, 'CR');
picker.add(61, 63, 'Mirror strike', 25, 'UC');
picker.add(64, 66, 'Mount', 25, 'CR');
picker.add(67, 69, 'Ray of sickening', 25, 'UM');
picker.add(70, 71, 'Reduce person', 25, 'CR');
picker.add(72, 74, 'Shadow weapon', 25, 'UM');
picker.add(75, 77, 'Shock shield', 25, 'UC');
picker.add(78, 80, 'Stone fist', 25, 'APG');
picker.add(81, 84, 'Touch of the sea', 25, 'APG');
picker.add(85, 88, 'Unseen servant', 25, 'CR');
picker.add(89, 91, 'Urban grace', 25, 'ARG');
picker.add(92, 96, 'Vanish', 25, 'APG');
picker.add(97, 98, 'Ventriloquism', 25, 'CR');
picker.add(99, 100, 'Voice alteration', 25, 'UM');

picker = scrolls.typeAndLevelToPicker['common arcane'][2];
picker.add(1, 4, 'Acid arrow', 150, 'CR');
picker.add(5, 7, 'Alter self', 150, 'CR');
picker.add(8, 12, 'Bear’s endurance', 150, 'CR');
picker.add(13, 15, 'Blur', 150, 'CR');
picker.add(16, 20, 'Bull’s strength', 150, 'CR');
picker.add(21, 24, 'Cat’s grace', 150, 'CR');
picker.add(25, 27, 'Darkness', 150, 'CR');
picker.add(28, 30, 'Darkvision', 150, 'CR');
picker.add(31, 34, 'Eagle’s splendor', 150, 'CR');
picker.add(35, 37, 'False life', 150, 'CR');
picker.add(38, 40, 'Flaming sphere', 150, 'CR');
picker.add(41, 44, 'Fox’s cunning', 150, 'CR');
picker.add(45, 47, 'Glitterdust', 150, 'CR');
picker.add(48, 52, 'Invisibility', 150, 'CR');
picker.add(53, 54, 'Knock', 150, 'CR');
picker.add(55, 58, 'Levitate', 150, 'CR');
picker.add(59, 61, 'Minor image', 150, 'CR');
picker.add(62, 65, 'Mirror image', 150, 'CR');
picker.add(66, 69, 'Owl’s wisdom', 150, 'CR');
picker.add(70, 73, 'Resist energy', 150, 'CR');
picker.add(74, 75, 'Rope trick', 150, 'CR');
picker.add(76, 80, 'Scorching ray', 150, 'CR');
picker.add(81, 83, 'See invisibility', 150, 'CR');
picker.add(84, 85, 'Shatter', 150, 'CR');
picker.add(86, 88, 'Spider climb', 150, 'CR');
picker.add(89, 91, 'Summon monster II', 150, 'CR');
picker.add(92, 93, 'Summon swarm', 150, 'CR');
picker.add(94, 98, 'Web', 150, 'CR');
picker.add(99, 100, 'Whispering wind', 150, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][2];
picker.add(1, 3, 'Bestow weapon proficiency', 150, 'UC');
picker.add(4, 6, 'Blindness/deafness', 150, 'CR');
picker.add(7, 9, 'Burning gaze', 150, 'APG');
picker.add(10, 12, 'Certain grip', 150, 'UC');
picker.add(13, 14, 'Command undead', 150, 'CR');
picker.add(15, 16, 'Create pit', 150, 'APG');
picker.add(17, 20, 'Daze monster', 150, 'CR');
picker.add(21, 23, 'Detect thoughts', 150, 'CR');
picker.add(24, 27, 'Disguise other', 150, 'UM');
picker.add(28, 31, 'Elemental touch', 150, 'APG');
picker.add(32, 34, 'Fire breath', 150, 'APG');
picker.add(35, 38, 'Fog cloud', 150, 'CR');
picker.add(39, 40, 'Ghoul touch', 150, 'CR');
picker.add(41, 41, 'Glide', 150, 'APG');
picker.add(42, 44, 'Gust of wind', 150, 'CR');
picker.add(45, 47, 'Haunting mists', 150, 'UM');
picker.add(48, 51, 'Hideous laughter', 150, 'CR');
picker.add(52, 54, 'Hypnotic pattern', 150, 'CR');
picker.add(55, 57, 'Locate object', 150, 'CR');
picker.add(58, 60, 'Make whole', 150, 'CR');
picker.add(61, 62, 'Misdirection', 150, 'CR');
picker.add(63, 63, 'Obscure object', 150, 'CR');
picker.add(64, 65, 'Pernicious poison', 150, 'UM');
picker.add(66, 67, 'Protection from arrows', 150, 'CR');
picker.add(68, 70, 'Pyrotechnics', 150, 'CR');
picker.add(71, 73, 'Returning weapon', 150, 'UC');
picker.add(74, 77, 'Scare', 150, 'CR');
picker.add(78, 80, 'Shadow anchor', 150, 'ARG');
picker.add(81, 83, 'Share memory', 150, 'UM');
picker.add(84, 85, 'Slipstream', 150, 'APG');
picker.add(86, 88, 'Spectral hand', 150, 'CR');
picker.add(89, 90, 'Spontaneous immolation', 150, 'UC');
picker.add(91, 93, 'Touch of idiocy', 150, 'CR');
picker.add(94, 94, 'Unshakable chill', 150, 'UM');
picker.add(95, 96, 'Magic mouth', 160, 'CR');
picker.add(97, 97, 'Arcane lock', 175, 'CR');
picker.add(98, 99, 'Continual flame', 200, 'CR');
picker.add(100, 100, 'Phantom trap', 200, 'CR');

picker = scrolls.typeAndLevelToPicker['common arcane'][3];
picker.add(1, 3, 'Beast shape I', 375, 'CR');
picker.add(4, 7, 'Blink', 375, 'CR');
picker.add(8, 12, 'Dispel magic', 375, 'CR');
picker.add(13, 16, 'Displacement', 375, 'CR');
picker.add(17, 21, 'Fireball', 375, 'CR');
picker.add(22, 24, 'Flame arrow', 375, 'CR');
picker.add(25, 29, 'Fly', 375, 'CR');
picker.add(30, 32, 'Gaseous form', 375, 'CR');
picker.add(33, 37, 'Haste', 375, 'CR');
picker.add(38, 40, 'Heroism', 375, 'CR');
picker.add(41, 43, 'Hold person', 375, 'CR');
picker.add(44, 46, 'Invisibility sphere', 375, 'CR');
picker.add(47, 51, 'Lightning bolt', 375, 'CR');
picker.add(52, 54, 'Magic circle against chaos', 375, 'CR');
picker.add(55, 57, 'Magic circle against evil', 375, 'CR');
picker.add(58, 60, 'Magic circle against good', 375, 'CR');
picker.add(61, 63, 'Magic circle against law', 375, 'CR');
picker.add(64, 66, 'Major image', 375, 'CR');
picker.add(67, 70, 'Phantom steed', 375, 'CR');
picker.add(71, 74, 'Protection from energy', 375, 'CR');
picker.add(75, 78, 'Slow', 375, 'CR');
picker.add(79, 81, 'Stinking cloud', 375, 'CR');
picker.add(82, 84, 'Suggestion', 375, 'CR');
picker.add(85, 87, 'Summon monster III', 375, 'CR');
picker.add(88, 90, 'Tiny hut', 375, 'CR');
picker.add(91, 94, 'Tongues', 375, 'CR');
picker.add(95, 97, 'Vampiric touch', 375, 'CR');
picker.add(98, 100, 'Water breathing', 375, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][3];
picker.add(1, 3, 'Animate dead, lesser', 375, 'UM');
picker.add(4, 6, 'Aqueous orb', 375, 'APG');
picker.add(7, 8, 'Arcane sight', 375, 'CR');
picker.add(9, 12, 'Beast shape', 375, 'CR');
picker.add(13, 15, 'Clairaudience/clairvoyance', 375, 'CR');
picker.add(16, 17, 'Cloak of winds', 375, 'APG');
picker.add(18, 20, 'Daylight', 375, 'CR');
picker.add(21, 24, 'Deep slumber', 375, 'CR');
picker.add(25, 27, 'Distracting cacophony', 375, 'UM');
picker.add(28, 30, 'Draconic reservoir', 375, 'APG');
picker.add(31, 35, 'Elemental aura', 375, 'APG');
picker.add(36, 38, 'Explosive runes', 375, 'CR');
picker.add(39, 43, 'Force punch', 375, 'UM');
picker.add(44, 45, 'Gentle repose', 375, 'CR');
picker.add(46, 47, 'Halt undead', 375, 'CR');
picker.add(48, 49, 'Healing thief', 375, 'UC');
picker.add(50, 51, 'Hydraulic torrent', 375, 'APG');
picker.add(52, 56, 'Keen edge', 375, 'CR');
picker.add(57, 61, 'Magic weapon, greater', 375, 'CR');
picker.add(62, 65, 'Monstrous physique I', 375, 'UM');
picker.add(66, 68, 'Rage', 375, 'CR');
picker.add(69, 70, 'Ray of exhaustion', 375, 'CR');
picker.add(71, 73, 'Resinous skin', 375, 'UC');
picker.add(74, 75, 'Resist energy, communal', 375, 'UC');
picker.add(76, 78, 'Secret page', 375, 'CR');
picker.add(79, 80, 'Shrink item', 375, 'CR');
picker.add(81, 83, 'Sleet storm', 375, 'CR');
picker.add(84, 86, 'Spiked pit', 375, 'APG');
picker.add(87, 90, 'Undead anatomy I', 375, 'UM');
picker.add(91, 92, 'Versatile weapon', 375, 'APG');
picker.add(93, 95, 'Wind wall', 375, 'CR');
picker.add(96, 96, 'Illusory script', 425, 'CR');
picker.add(97, 99, 'Nondetection', 425, 'CR');
picker.add(100, 100, 'Sepia snake sigil', 875, 'CR');

picker = scrolls.typeAndLevelToPicker['common arcane'][4];
picker.add(1, 3, 'Beast shape II', 700, 'CR');
picker.add(4, 5, 'Bestow curse', 700, 'CR');
picker.add(6, 9, 'Black tentacles', 700, 'CR');
picker.add(10, 14, 'Charm monster', 700, 'CR');
picker.add(15, 18, 'Confusion', 700, 'CR');
picker.add(19, 21, 'Crushing despair', 700, 'CR');
picker.add(22, 26, 'Dimension door', 700, 'CR');
picker.add(27, 29, 'Dimensional anchor', 700, 'CR');
picker.add(30, 32, 'Elemental body I', 700, 'CR');
picker.add(33, 36, 'Enervation', 700, 'CR');
picker.add(37, 38, 'Enlarge person, mass', 700, 'CR');
picker.add(39, 43, 'Fear', 700, 'CR');
picker.add(44, 47, 'Fire shield', 700, 'CR');
picker.add(48, 50, 'Globe of invulnerability, lesser', 700, 'CR');
picker.add(51, 54, 'Ice storm', 700, 'CR');
picker.add(55, 59, 'Invisibility, greater', 700, 'CR');
picker.add(60, 64, 'Phantasmal killer', 700, 'CR');
picker.add(65, 67, 'Resilient sphere', 700, 'CR');
picker.add(68, 71, 'Scrying', 700, 'CR');
picker.add(72, 74, 'Shadow conjuration', 700, 'CR');
picker.add(75, 76, 'Shout', 700, 'CR');
picker.add(77, 78, 'Solid fog', 700, 'CR');
picker.add(79, 80, 'Stone shape', 700, 'CR');
picker.add(81, 83, 'Summon monster IV', 700, 'CR');
picker.add(84, 88, 'Wall of fire', 700, 'CR');
picker.add(89, 92, 'Wall of ice', 700, 'CR');
picker.add(93, 97, 'Stoneskin', 950, 'CR');
picker.add(98, 100, 'Animate dead', 1050, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][4];
picker.add(1, 2, 'Acid pit', 700, 'APG');
picker.add(3, 6, 'Arcane eye', 700, 'CR');
picker.add(7, 10, 'Ball lightning', 700, 'APG');
picker.add(11, 13, 'Contagion', 700, 'CR');
picker.add(14, 17, 'Darkvision, greater', 700, 'UM');
picker.add(18, 19, 'Detect scrying', 700, 'CR');
picker.add(20, 23, 'Dragon’s breath', 700, 'APG');
picker.add(24, 28, 'False life, greater', 700, 'UM');
picker.add(29, 32, 'Firefall', 700, 'APG');
picker.add(33, 35, 'Geas, lesser', 700, 'CR');
picker.add(36, 39, 'Ghost wolf', 700, 'ARG');
picker.add(40, 41, 'Hallucinatory terrain', 700, 'CR');
picker.add(42, 43, 'Illusory wall', 700, 'CR');
picker.add(44, 46, 'Locate creature', 700, 'CR');
picker.add(47, 50, 'Minor creation', 700, 'CR');
picker.add(51, 54, 'Monstrous physique II', 700, 'UM');
picker.add(55, 57, 'Obsidian flow', 700, 'UC');
picker.add(58, 59, 'Phantom chariot', 700, 'UC');
picker.add(60, 62, 'Rainbow pattern', 700, 'CR');
picker.add(63, 64, 'Reduce person, mass', 700, 'CR');
picker.add(65, 68, 'Remove curse', 700, 'CR');
picker.add(69, 71, 'Secure shelter', 700, 'CR');
picker.add(72, 74, 'Shadow projection', 700, 'APG');
picker.add(75, 79, 'Shocking image', 700, 'UC');
picker.add(80, 83, 'Telekinetic charge', 700, 'UC');
picker.add(84, 85, 'True form', 700, 'APG');
picker.add(86, 89, 'Vermin shape I', 700, 'UM');
picker.add(90, 94, 'Volcanic storm', 700, 'UM');
picker.add(95, 97, 'Wandering star motes', 700, 'APG');
picker.add(98, 99, 'Fire trap', 725, 'CR');
picker.add(100, 100, 'Mnemonic enhancer', 750, 'CR');

picker = scrolls.typeAndLevelToPicker['common arcane'][5];
picker.add(1, 3, 'Baleful polymorph', 1125, 'CR');
picker.add(4, 7, 'Beast shape III', 1125, 'CR');
picker.add(8, 10, 'Break enchantment', 1125, 'CR');
picker.add(11, 15, 'Cloudkill', 1125, 'CR');
picker.add(16, 21, 'Cone of cold', 1125, 'CR');
picker.add(22, 23, 'Contact other plane', 1125, 'CR');
picker.add(24, 26, 'Dismissal', 1125, 'CR');
picker.add(27, 31, 'Dominate person', 1125, 'CR');
picker.add(32, 35, 'Feeblemind', 1125, 'CR');
picker.add(36, 40, 'Hold monster', 1125, 'CR');
picker.add(41, 43, 'Magic jar', 1125, 'CR');
picker.add(44, 46, 'Mind fog', 1125, 'CR');
picker.add(47, 51, 'Overland flight', 1125, 'CR');
picker.add(52, 54, 'Passwall', 1125, 'CR');
picker.add(55, 56, 'Permanency', 1125, 'CR');
picker.add(57, 58, 'Planar binding, lesser', 1125, 'CR');
picker.add(59, 62, 'Polymorph', 1125, 'CR');
picker.add(63, 65, 'Sending', 1125, 'CR');
picker.add(66, 69, 'Shadow evocation', 1125, 'CR');
picker.add(70, 73, 'Summon monster V', 1125, 'CR');
picker.add(74, 76, 'Telekinesis', 1125, 'CR');
picker.add(77, 82, 'Teleport', 1125, 'CR');
picker.add(83, 88, 'Wall of force', 1125, 'CR');
picker.add(89, 92, 'Wall of stone', 1125, 'CR');
picker.add(93, 95, 'Waves of fatigue', 1125, 'CR');
picker.add(96, 97, 'Symbol of pain', 2125, 'CR');
picker.add(98, 100, 'Symbol of sleep', 2125, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][5];
picker.add(1, 2, 'Absorb toxicity', 1125, 'UC');
picker.add(3, 4, 'Animal growth', 1125, 'CR');
picker.add(5, 6, 'Blight', 1125, 'CR');
picker.add(7, 9, 'Dream', 1125, 'CR');
picker.add(10, 13, 'Elemental body II', 1125, 'CR');
picker.add(14, 15, 'Fabricate', 1125, 'CR');
picker.add(16, 19, 'Fire snake', 1125, 'APG');
picker.add(20, 22, 'Hostile juxtaposition', 1125, 'UC');
picker.add(23, 25, 'Hungry pit', 1125, 'APG');
picker.add(26, 29, 'Icy prison', 1125, 'UM');
picker.add(30, 33, 'Interposing hand', 1125, 'CR');
picker.add(34, 36, 'Life bubble', 1125, 'APG');
picker.add(37, 38, 'Mage’s faithful hound', 1125, 'CR');
picker.add(39, 40, 'Mage’s private sanctum', 1125, 'CR');
picker.add(41, 43, 'Major creation', 1125, 'CR');
picker.add(44, 46, 'Mirage arcana', 1125, 'CR');
picker.add(47, 50, 'Monstrous physique III', 1125, 'UM');
picker.add(51, 54, 'Nightmare', 1125, 'CR');
picker.add(55, 56, 'Persistent image', 1125, 'CR');
picker.add(57, 60, 'Planar adaptation', 1125, 'APG');
picker.add(61, 64, 'Plant shape I', 1125, 'CR');
picker.add(65, 68, 'Prying eyes', 1125, 'CR');
picker.add(69, 70, 'Secret chest', 1125, 'CR');
picker.add(71, 73, 'Seeming', 1125, 'CR');
picker.add(74, 76, 'Sonic thrust', 1125, 'UM');
picker.add(77, 79, 'Suffocation', 1125, 'APG');
picker.add(80, 82, 'Telepathic bond', 1125, 'CR');
picker.add(83, 84, 'Transmute mud to rock', 1125, 'CR');
picker.add(85, 86, 'Transmute rock to mud', 1125, 'CR');
picker.add(87, 90, 'Undead anatomy II', 1125, 'UM');
picker.add(91, 94, 'Vermin form II', 1125, 'UM');
picker.add(95, 98, 'Wind blades', 1125, 'ARG');
picker.add(99, 100, 'False vision', 1375, 'CR');

picker = scrolls.typeAndLevelToPicker['common arcane'][6];
picker.add(1, 3, 'Acid fog', 1650, 'CR');
picker.add(4, 7, 'Antimagic field', 1650, 'CR');
picker.add(8, 10, 'Bear’s endurance, mass', 1650, 'CR');
picker.add(11, 13, 'Beast shape IV', 1650, 'CR');
picker.add(14, 16, 'Bull’s strength, mass', 1650, 'CR');
picker.add(17, 19, 'Cat’s grace, mass', 1650, 'CR');
picker.add(20, 25, 'Chain lightning', 1650, 'CR');
picker.add(26, 31, 'Disintegrate', 1650, 'CR');
picker.add(32, 37, 'Dispel magic, greater', 1650, 'CR');
picker.add(38, 40, 'Eagle’s splendor, mass', 1650, 'CR');
picker.add(41, 42, 'Eyebite', 1650, 'CR');
picker.add(43, 47, 'Flesh to stone', 1650, 'CR');
picker.add(48, 50, 'Form of the dragon I', 1650, 'CR');
picker.add(51, 53, 'Fox’s cunning, mass', 1650, 'CR');
picker.add(54, 56, 'Globe of invulnerability', 1650, 'CR');
picker.add(57, 59, 'Heroism, greater', 1650, 'CR');
picker.add(60, 62, 'Mislead', 1650, 'CR');
picker.add(63, 65, 'Owl’s wisdom, mass', 1650, 'CR');
picker.add(66, 67, 'Planar binding', 1650, 'CR');
picker.add(68, 70, 'Shadow walk', 1650, 'CR');
picker.add(71, 72, 'Stone to flesh', 1650, 'CR');
picker.add(73, 76, 'Suggestion, mass', 1650, 'CR');
picker.add(77, 79, 'Summon monster VI', 1650, 'CR');
picker.add(80, 82, 'Transformation', 1650, 'CR');
picker.add(83, 84, 'Veil', 1650, 'CR');
picker.add(85, 87, 'Wall of iron', 1700, 'CR');
picker.add(88, 89, 'Create undead', 1750, 'CR');
picker.add(90, 92, 'Legend lore', 1900, 'CR');
picker.add(93, 96, 'True seeing', 1900, 'CR');
picker.add(97, 98, 'Circle of death', 2150, 'CR');
picker.add(99, 100, 'Symbol of fear', 2650, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][6];
picker.add(1, 4, 'Analyze dweomer', 1650, 'CR');
picker.add(5, 8, 'Battlemind link', 1650, 'UM');
picker.add(9, 12, 'Cloak of dreams', 1650, 'APG');
picker.add(13, 15, 'Contagion, greater', 1650, 'UM');
picker.add(16, 20, 'Contagious flame', 1650, 'APG');
picker.add(21, 26, 'Contingency', 1650, 'CR');
picker.add(27, 30, 'Control water', 1650, 'CR');
picker.add(31, 35, 'Elemental body III', 1650, 'CR');
picker.add(36, 39, 'Fluid form', 1650, 'APG');
picker.add(40, 45, 'Forceful hand', 1650, 'CR');
picker.add(46, 48, 'Freezing sphere', 1650, 'CR');
picker.add(49, 53, 'Geas/quest', 1650, 'CR');
picker.add(54, 57, 'Getaway', 1650, 'APG');
picker.add(58, 59, 'Guards and wards', 1650, 'CR');
picker.add(60, 61, 'Mage’s lucubration', 1650, 'CR');
picker.add(62, 66, 'Monstrous physique IV', 1650, 'UM');
picker.add(67, 68, 'Move earth', 1650, 'CR');
picker.add(69, 71, 'Permanent image', 1650, 'CR');
picker.add(72, 76, 'Plant shape II', 1650, 'CR');
picker.add(77, 80, 'Repulsion', 1650, 'CR');
picker.add(81, 84, 'Sirocco', 1650, 'APG');
picker.add(85, 87, 'Tar pool', 1650, 'UC');
picker.add(88, 92, 'Undead anatomy III', 1650, 'UM');
picker.add(93, 95, 'Programmed image', 1675, 'CR');
picker.add(96, 98, 'Undeath to death', 2150, 'CR');
picker.add(99, 100, 'Symbol of persuasion', 6650, 'CR');

picker = scrolls.typeAndLevelToPicker['common arcane'][7];
picker.add(1, 4, 'Arcane sight, greater', 2275, 'CR');
picker.add(5, 7, 'Banishment', 2275, 'CR');
picker.add(8, 13, 'Delayed blast fireball', 2275, 'CR');
picker.add(14, 17, 'Ethereal jaunt', 2275, 'CR');
picker.add(18, 22, 'Finger of death', 2275, 'CR');
picker.add(23, 27, 'Form of the dragon II', 2275, 'CR');
picker.add(28, 30, 'Hold person, mass', 2275, 'CR');
picker.add(31, 35, 'Invisibility, mass', 2275, 'CR');
picker.add(36, 39, 'Mage’s sword', 2275, 'CR');
picker.add(40, 42, 'Phase door', 2275, 'CR');
picker.add(43, 48, 'Plane shift', 2275, 'CR');
picker.add(49, 53, 'Polymorph, greater', 2275, 'CR');
picker.add(54, 57, 'Power word blind', 2275, 'CR');
picker.add(58, 62, 'Prismatic spray', 2275, 'CR');
picker.add(63, 66, 'Reverse gravity', 2275, 'CR');
picker.add(67, 70, 'Scrying, greater', 2275, 'CR');
picker.add(71, 73, 'Shadow conjuration, greater', 2275, 'CR');
picker.add(74, 78, 'Spell turning', 2275, 'CR');
picker.add(79, 81, 'Summon monster VII', 2275, 'CR');
picker.add(82, 87, 'Teleport, greater', 2275, 'CR');
picker.add(88, 90, 'Waves of exhaustion', 2275, 'CR');
picker.add(91, 93, 'Project image', 2280, 'CR');
picker.add(94, 97, 'Forcecage', 2775, 'CR');
picker.add(98, 100, 'Limited wish', 3775, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][7];
picker.add(1, 3, 'Control undead', 2275, 'CR');
picker.add(4, 7, 'Control weather', 2275, 'CR');
picker.add(8, 10, 'Create demiplane, lesser', 2275, 'UM');
picker.add(11, 14, 'Deflection', 2275, 'APG');
picker.add(15, 19, 'Elemental body IV', 2275, 'CR');
picker.add(20, 23, 'Firebrand', 2275, 'APG');
picker.add(24, 29, 'Fly, mass', 2275, 'APG');
picker.add(30, 34, 'Giant form I', 2275, 'CR');
picker.add(35, 40, 'Grasping hand', 2275, 'CR');
picker.add(41, 44, 'Hostile juxtaposition, greater', 2275, 'UC');
picker.add(45, 49, 'Ice body', 2275, 'UM');
picker.add(50, 53, 'Insanity', 2275, 'CR');
picker.add(54, 56, 'Mage’s magnificent mansion', 2275, 'CR');
picker.add(57, 61, 'Phantasmal revenge', 2275, 'APG');
picker.add(62, 65, 'Plague storm', 2275, 'UM');
picker.add(66, 70, 'Plant shape III', 2275, 'CR');
picker.add(71, 74, 'Resonating word', 2275, 'UM');
picker.add(75, 78, 'Sequester', 2275, 'CR');
picker.add(79, 81, 'Statue', 2275, 'CR');
picker.add(82, 84, 'Teleport object', 2275, 'CR');
picker.add(85, 88, 'Walk through space', 2275, 'UC');
picker.add(89, 91, 'Vision', 2525, 'CR');
picker.add(92, 93, 'Instant summons', 3275, 'CR');
picker.add(94, 96, 'Symbol of stunning', 7275, 'CR');
picker.add(97, 98, 'Symbol of weakness', 7275, 'CR');
picker.add(99, 100, 'Simulacrum', 8775, 'CR');

picker = scrolls.typeAndLevelToPicker['common arcane'][8];
picker.add(1, 5, 'Charm monster, mass', 3000, 'CR');
picker.add(6, 9, 'Demand', 3000, 'CR');
picker.add(10, 13, 'Dimensional lock', 3000, 'CR');
picker.add(14, 18, 'Form of the dragon III', 3000, 'CR');
picker.add(19, 23, 'Horrid wilting', 3000, 'CR');
picker.add(24, 28, 'Incendiary cloud', 3000, 'CR');
picker.add(29, 33, 'Irresistible dance', 3000, 'CR');
picker.add(34, 40, 'Maze', 3000, 'CR');
picker.add(41, 45, 'Mind blank', 3000, 'CR');
picker.add(46, 49, 'Planar binding, greater', 3000, 'CR');
picker.add(50, 55, 'Polar ray', 3000, 'CR');
picker.add(56, 59, 'Polymorph any object', 3000, 'CR');
picker.add(60, 66, 'Power word stun', 3000, 'CR');
picker.add(67, 72, 'Prismatic wall', 3000, 'CR');
picker.add(73, 76, 'Scintillating pattern', 3000, 'CR');
picker.add(77, 80, 'Summon monster VIII', 3000, 'CR');
picker.add(81, 85, 'Telekinetic sphere', 3000, 'CR');
picker.add(86, 90, 'Protection from spells', 3500, 'CR');
picker.add(91, 94, 'Symbol of death', 8000, 'CR');
picker.add(95, 97, 'Temporal stasis', 8000, 'CR');
picker.add(98, 100, 'Trap the soul', 23000, 'CR');


picker = scrolls.typeAndLevelToPicker['uncommon arcane'][8];
picker.add(1, 4, 'Antipathy', 3000, 'CR');
picker.add(5, 10, 'Clenched fist', 3000, 'CR');
picker.add(11, 12, 'Clone', 3000, 'CR');
picker.add(13, 15, 'Create demiplane', 3000, 'UM');
picker.add(16, 19, 'Discern location', 3000, 'CR');
picker.add(20, 24, 'Euphoric tranquility', 3000, 'APG');
picker.add(25, 29, 'Frightful aspect', 3000, 'UC');
picker.add(30, 34, 'Giant form II', 3000, 'CR');
picker.add(35, 38, 'Iron body', 3000, 'CR');
picker.add(39, 43, 'Moment of prescience', 3000, 'CR');
picker.add(44, 47, 'Orb of the void', 3000, 'UM');
picker.add(48, 52, 'Pyrying eyes, greater', 3000, 'CR');
picker.add(53, 56, 'Screen', 3000, 'CR');
picker.add(57, 62, 'Shadow evocation, greater', 3000, 'CR');
picker.add(63, 66, 'Shout, greater', 3000, 'CR');
picker.add(67, 72, 'Stormbolts', 3000, 'APG');
picker.add(73, 76, 'Sunburst', 3000, 'CR');
picker.add(77, 81, 'Undead anatomy IV', 3000, 'UM');
picker.add(82, 87, 'Wall of lava', 3000, 'APG');
picker.add(88, 91, 'Create greater undead', 3150, 'CR');
picker.add(92, 95, 'Sympathy', 4500, 'CR');
picker.add(96, 98, 'Symbol of insanity', 8000, 'CR');
picker.add(99, 100, 'Binding (chaining)', 13000, 'CR');

picker = scrolls.typeAndLevelToPicker['common arcane'][9];
picker.add(1, 6, 'Dominate monster', 3825, 'CR');
picker.add(7, 11, 'Energy drain', 3825, 'CR');
picker.add(12, 16, 'Freedom', 3825, 'CR');
picker.add(17, 23, 'Gate', 3825, 'CR');
picker.add(24, 28, 'Hold monster, mass', 3825, 'CR');
picker.add(29, 33, 'Imprisonment', 3825, 'CR');
picker.add(34, 39, 'Mage’s disjunction', 3825, 'CR');
picker.add(40, 47, 'Meteor swarm', 3825, 'CR');
picker.add(48, 55, 'Power word kill', 3825, 'CR');
picker.add(56, 61, 'Prismatic sphere', 3825, 'CR');
picker.add(62, 66, 'Shapechange', 3825, 'CR');
picker.add(67, 71, 'Summon monster IX', 3825, 'CR');
picker.add(72, 79, 'Time stop', 3825, 'CR');
picker.add(80, 85, 'Weird', 3825, 'CR');
picker.add(86, 90, 'Astral projection', 4825, 'CR');
picker.add(91, 96, 'Teleportation circle', 4825, 'CR');
picker.add(97, 100, 'Wish', 28825, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon arcane'][9];
picker.add(1, 6, 'Create demiplane, greater', 3825, 'UM');
picker.add(7, 15, 'Crushing hand', 3825, 'CR');
picker.add(16, 23, 'Etherealness', 3825, 'CR');
picker.add(24, 31, 'Fiery body', 3825, 'APG');
picker.add(32, 38, 'Foresight', 3825, 'CR');
picker.add(39, 44, 'Heroic invocation', 3825, 'UC');
picker.add(45, 50, 'Icy prison, mass', 3825, 'UM');
picker.add(51, 57, 'Ride the lightning', 3825, 'UM');
picker.add(58, 65, 'Shades', 3825, 'CR');
picker.add(66, 72, 'Soul bind', 3825, 'CR');
picker.add(73, 79, 'Tsunami', 3825, 'APG');
picker.add(80, 88, 'Wail of the banshee', 3825, 'CR');
picker.add(89, 95, 'Winds of vengeance', 3825, 'APG');
picker.add(96, 100, 'Refuge', 4325, 'CR');

picker = scrolls.typeAndLevelToPicker['common divine'][0];
picker.add(1, 11, 'Bleed', 12.5, 'CR');
picker.add(12, 21, 'Create water', 12.5, 'CR');
picker.add(22, 34, 'Detect magic', 12.5, 'CR');
picker.add(35, 44, 'Know direction', 12.5, 'CR');
picker.add(45, 55, 'Light', 12.5, 'CR');
picker.add(56, 65, 'Mending', 12.5, 'CR');
picker.add(66, 75, 'Purify food and drink', 12.5, 'CR');
picker.add(76, 88, 'Read magic', 12.5, 'CR');
picker.add(89, 100, 'Stabilize', 12.5, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][0];
picker.add(1, 15, 'Detect poison', 12.5, 'CR');
picker.add(16, 33, 'Flare', 12.5, 'CR');
picker.add(34, 50, 'Guidance', 12.5, 'CR');
picker.add(51, 68, 'Resistance', 12.5, 'CR');
picker.add(69, 85, 'Spark', 12.5, 'APG');
picker.add(86, 100, 'Virtue', 12.5, 'CR');


picker = scrolls.typeAndLevelToPicker['common divine'][1];
picker.add(1, 4, 'Bane', 25, 'CR');
picker.add(5, 10, 'Bless', 25, 'CR');
picker.add(11, 15, 'Cause fear', 25, 'CR');
picker.add(16, 19, 'Command', 25, 'CR');
picker.add(20, 22, 'Comprehend languages', 25, 'CR');
picker.add(23, 28, 'Cure light wounds', 25, 'CR');
picker.add(29, 30, 'Detect chaos', 25, 'CR');
picker.add(31, 32, 'Detect evil', 25, 'CR');
picker.add(33, 34, 'Detect good', 25, 'CR');
picker.add(35, 36, 'Detect law', 25, 'CR');
picker.add(37, 39, 'Detect undead', 25, 'CR');
picker.add(40, 45, 'Divine favor', 25, 'CR');
picker.add(46, 48, 'Doom', 25, 'CR');
picker.add(49, 52, 'Entangle', 25, 'CR');
picker.add(53, 57, 'Inflict light wounds', 25, 'CR');
picker.add(58, 61, 'Magic fang', 25, 'CR');
picker.add(62, 65, 'Obscuring mist', 25, 'CR');
picker.add(66, 68, 'Produce flame', 25, 'CR');
picker.add(69, 71, 'Protection from chaos', 25, 'CR');
picker.add(72, 74, 'Protection from evil', 25, 'CR');
picker.add(75, 77, 'Protection from good', 25, 'CR');
picker.add(78, 80, 'Protection from law', 25, 'CR');
picker.add(81, 84, 'Remove fear', 25, 'CR');
picker.add(85, 88, 'Sanctuary', 25, 'CR');
picker.add(89, 94, 'Shield of faith', 25, 'CR');
picker.add(95, 97, 'Summon monster I', 25, 'CR');
picker.add(98, 100, 'Summon nature’s ally I', 25, 'CR');


picker = scrolls.typeAndLevelToPicker['uncommon divine'][1];
picker.add(1, 4, 'Ant haul', 25, 'APG');
picker.add(5, 7, 'Aspect of the falcon', 25, 'APG');
picker.add(8, 9, 'Calm animals', 25, 'CR');
picker.add(10, 12, 'Charm animal', 25, 'CR');
picker.add(13, 15, 'Compel hostility', 25, 'UC');
picker.add(16, 17, 'Deathwatch', 25, 'CR');
picker.add(18, 18, 'Detect animals or plants', 25, 'CR');
picker.add(19, 20, 'Detect snares and pits', 25, 'CR');
picker.add(21, 23, 'Diagnose disease', 25, 'UM');
picker.add(24, 27, 'Endure elements', 25, 'CR');
picker.add(28, 30, 'Entropic shield', 25, 'CR');
picker.add(31, 33, 'Faerie fire', 25, 'CR');
picker.add(34, 36, 'Feather step', 25, 'APG');
picker.add(37, 39, 'Forbid action', 25, 'UM');
picker.add(40, 42, 'Frostbite', 25, 'UM');
picker.add(43, 46, 'Goodberry', 25, 'CR');
picker.add(47, 47, 'Hide from animals', 25, 'CR');
picker.add(48, 49, 'Hide from undead', 25, 'CR');
picker.add(50, 52, 'Hydraulic push', 25, 'APG');
picker.add(53, 55, 'Jump', 25, 'CR');
picker.add(56, 59, 'Keen senses', 25, 'APG');
picker.add(60, 62, 'Liberating command', 25, 'UC');
picker.add(63, 65, 'Longstrider', 25, 'CR');
picker.add(66, 68, 'Magic stone', 25, 'CR');
picker.add(69, 72, 'Pass without trace', 25, 'CR');
picker.add(73, 74, 'Remove sickness', 25, 'UM');
picker.add(75, 75, 'Sanctify corpse', 25, 'UM');
picker.add(76, 78, 'Shillelagh', 25, 'CR');
picker.add(79, 81, 'Speak with animals', 25, 'CR');
picker.add(82, 85, 'Stone fist', 25, 'APG');
picker.add(86, 88, 'Stone shield', 25, 'ARG');
picker.add(89, 91, 'Sun metal', 25, 'UC');
picker.add(92, 95, 'Touch of the sea', 25, 'APG');
picker.add(96, 98, 'Bless water', 50, 'CR');
picker.add(99, 100, 'Curse water', 50, 'CR');


picker = scrolls.typeAndLevelToPicker['common divine'][2];
picker.add(1, 4, 'Aid', 150, 'CR');
picker.add(5, 6, 'Align weapon', 150, 'CR');
picker.add(7, 8, 'Animal messenger', 150, 'CR');
picker.add(9, 13, 'Barkskin', 150, 'CR');
picker.add(14, 16, 'Bear’s endurance', 150, 'CR');
picker.add(17, 19, 'Bull’s strength', 150, 'CR');
picker.add(20, 22, 'Cat’s grace', 150, 'CR');
picker.add(23, 24, 'Chill metal', 150, 'CR');
picker.add(25, 30, 'Cure moderate wounds', 150, 'CR');
picker.add(31, 33, 'Darkness', 150, 'CR');
picker.add(34, 36, 'Delay poison', 150, 'CR');
picker.add(37, 39, 'Eagle’s splendor', 150, 'CR');
picker.add(40, 41, 'Find traps', 150, 'CR');
picker.add(42, 44, 'Flame blade', 150, 'CR');
picker.add(45, 46, 'Fog cloud', 150, 'CR');
picker.add(47, 50, 'Heat metal', 150, 'CR');
picker.add(51, 52, 'Hold animal', 150, 'CR');
picker.add(53, 56, 'Hold person', 150, 'CR');
picker.add(57, 60, 'Inflict moderate wounds', 150, 'CR');
picker.add(61, 63, 'Owl’s wisdom', 150, 'CR');
picker.add(64, 65, 'Remove paralysis', 150, 'CR');
picker.add(66, 68, 'Resist energy', 150, 'CR');
picker.add(69, 73, 'Restoration, lesser', 150, 'CR');
picker.add(74, 77, 'Shield other', 150, 'CR');
picker.add(78, 81, 'Silence', 150, 'CR');
picker.add(82, 85, 'Sound burst', 150, 'CR');
picker.add(86, 89, 'Spiritual weapon', 150, 'CR');
picker.add(90, 91, 'Summon monster II', 150, 'CR');
picker.add(92, 93, 'Summon nature’s ally II', 150, 'CR');
picker.add(94, 95, 'Summon swarm', 150, 'CR');
picker.add(96, 97, 'Zone of truth', 150, 'CR');
picker.add(98, 100, 'Augury', 175, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][2];
picker.add(1, 4, 'Animal aspect', 150, 'UC');
picker.add(5, 6, 'Animal trance', 150, 'CR');
picker.add(7, 10, 'Animate dead, lesser', 150, 'UM');
picker.add(11, 13, 'Arrow of law', 150, 'UM');
picker.add(14, 17, 'Aspect of the bear', 150, 'APG');
picker.add(18, 20, 'Blessing of courage and life', 150, 'APG');
picker.add(21, 24, 'Calm emotions', 150, 'CR');
picker.add(25, 27, 'Death knell', 150, 'CR');
picker.add(28, 30, 'Dread bolt', 150, 'UM');
picker.add(31, 34, 'Effortless armor', 150, 'UC');
picker.add(35, 37, 'Enthrall', 150, 'CR');
picker.add(38, 41, 'Flaming sphere', 150, 'CR');
picker.add(42, 43, 'Gentle repose', 150, 'CR');
picker.add(44, 46, 'Grace', 150, 'APG');
picker.add(47, 48, 'Groundswell', 150, 'ARG');
picker.add(49, 51, 'Gust of wind', 150, 'CR');
picker.add(52, 53, 'Instant armor', 150, 'APG');
picker.add(54, 55, 'Instrument of agony', 150, 'UC');
picker.add(56, 58, 'Make whole', 150, 'CR');
picker.add(59, 60, 'Reduce animal', 150, 'CR');
picker.add(61, 62, 'Scent trail', 150, 'APG');
picker.add(63, 65, 'Shard of chaos', 150, 'UM');
picker.add(66, 68, 'Share language', 150, 'APG');
picker.add(69, 70, 'Shatter', 150, 'CR');
picker.add(71, 73, 'Soften earth and stone', 150, 'CR');
picker.add(74, 76, 'Spear of purity', 150, 'UM');
picker.add(77, 79, 'Spider climb', 150, 'CR');
picker.add(80, 82, 'Status', 150, 'CR');
picker.add(83, 84, 'Tree shape', 150, 'CR');
picker.add(85, 85, 'Undetectable alignment', 150, 'CR');
picker.add(86, 88, 'Warp wood', 150, 'CR');
picker.add(89, 91, 'Weapon of awe', 150, 'APG');
picker.add(92, 93, 'Wood shape', 150, 'CR');
picker.add(94, 95, 'Consecrate', 175, 'CR');
picker.add(96, 97, 'Desecrate', 175, 'CR');
picker.add(98, 99, 'Fire trap', 175, 'CR');
picker.add(100, 100, 'Masterwork transformation', 450, 'UM');

picker = scrolls.typeAndLevelToPicker['common divine'][3];
picker.add(1, 3, 'Bestow curse', 375, 'CR');
picker.add(4, 8, 'Call lightning', 375, 'CR');
picker.add(9, 15, 'Cure serious wounds', 375, 'CR');
picker.add(16, 19, 'Daylight', 375, 'CR');
picker.add(20, 23, 'Deeper darkness', 375, 'CR');
picker.add(24, 28, 'Dispel magic', 375, 'CR');
picker.add(29, 33, 'Inflict serious wounds', 375, 'CR');
picker.add(34, 37, 'Invisibility purge', 375, 'CR');
picker.add(38, 40, 'Locate object', 375, 'CR');
picker.add(41, 42, 'Magic circle against chaos', 375, 'CR');
picker.add(43, 44, 'Magic circle against evil', 375, 'CR');
picker.add(45, 46, 'Magic circle against good', 375, 'CR');
picker.add(47, 48, 'Magic circle against law', 375, 'CR');
picker.add(49, 52, 'Magic fang, greater', 375, 'CR');
picker.add(53, 57, 'Magic vestment', 375, 'CR');
picker.add(58, 59, 'Poison', 375, 'CR');
picker.add(60, 65, 'Prayer', 375, 'CR');
picker.add(66, 68, 'Protection from energy', 375, 'CR');
picker.add(69, 70, 'Remove blindness/deafness', 375, 'CR');
picker.add(71, 73, 'Remove curse', 375, 'CR');
picker.add(74, 76, 'Remove disease', 375, 'CR');
picker.add(77, 79, 'Searing light', 375, 'CR');
picker.add(80, 81, 'Sleet storm', 375, 'CR');
picker.add(82, 85, 'Speak with dead', 375, 'CR');
picker.add(86, 87, 'Stone shape', 375, 'CR');
picker.add(88, 89, 'Summon monster III', 375, 'CR');
picker.add(90, 91, 'Summon nature’s ally III', 375, 'CR');
picker.add(92, 95, 'Water breathing', 375, 'CR');
picker.add(96, 97, 'Water walk', 375, 'CR');
picker.add(98, 100, 'Animate dead', 625, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][3];
picker.add(1, 4, 'Aqueous orb', 375, 'APG');
picker.add(5, 8, 'Archon’s aura', 375, 'UM');
picker.add(9, 12, 'Bestow insight', 375, 'ARG');
picker.add(13, 16, 'Blindness/deafness', 375, 'CR');
picker.add(17, 19, 'Burst of nettles', 375, 'UM');
picker.add(20, 22, 'Chain of perdition', 375, 'UC');
picker.add(23, 26, 'Contagion', 375, 'CR');
picker.add(27, 30, 'Create food and water', 375, 'CR');
picker.add(31, 34, 'Daybreak arrow', 375, 'UC');
picker.add(35, 36, 'Diminish plants', 375, 'CR');
picker.add(37, 40, 'Discovery torch', 375, 'UC');
picker.add(41, 45, 'Dominate animal', 375, 'CR');
picker.add(46, 48, 'Guiding star', 375, 'APG');
picker.add(49, 51, 'Helping hand', 375, 'CR');
picker.add(52, 56, 'Meld into stone', 375, 'CR');
picker.add(57, 58, 'Obscure object', 375, 'CR');
picker.add(59, 61, 'Plant growth', 375, 'CR');
picker.add(62, 64, 'Quench', 375, 'CR');
picker.add(65, 67, 'Shifting sands', 375, 'APG');
picker.add(68, 72, 'Snare', 375, 'CR');
picker.add(73, 75, 'Speak with plants', 375, 'CR');
picker.add(76, 80, 'Spike growth', 375, 'CR');
picker.add(81, 83, 'Vision of hell', 375, 'UM');
picker.add(84, 87, 'Wind wall', 375, 'CR');
picker.add(88, 90, 'Wrathful mantle', 375, 'APG');
picker.add(91, 93, 'Continual flame', 425, 'CR');
picker.add(94, 96, 'Nap stack', 475, 'APG');
picker.add(97, 98, 'Glyph of warding', 575, 'CR');
picker.add(99, 100, 'Symbol of healing', 875, 'UM');

picker = scrolls.typeAndLevelToPicker['common divine'][4];
picker.add(1, 4, 'Air walk', 700, 'CR');
picker.add(5, 7, 'Chaos hammer', 700, 'CR');
picker.add(8, 15, 'Cure critical wounds', 700, 'CR');
picker.add(16, 19, 'Death ward', 700, 'CR');
picker.add(20, 22, 'Dimensional anchor', 700, 'CR');
picker.add(23, 25, 'Discern lies', 700, 'CR');
picker.add(26, 28, 'Dismissal', 700, 'CR');
picker.add(29, 33, 'Divine power', 700, 'CR');
picker.add(34, 39, 'Flame strike', 700, 'CR');
picker.add(40, 43, 'Freedom of movement', 700, 'CR');
picker.add(44, 46, 'Holy smite', 700, 'CR');
picker.add(47, 51, 'Inflict critical wounds', 700, 'CR');
picker.add(52, 56, 'Magic weapon, greater', 700, 'CR');
picker.add(57, 61, 'Neutralize poison', 700, 'CR');
picker.add(62, 64, 'Order’s wrath', 700, 'CR');
picker.add(65, 68, 'Poison', 700, 'CR');
picker.add(69, 73, 'Spell immunity', 700, 'CR');
picker.add(74, 77, 'Spike stones', 700, 'CR');
picker.add(78, 80, 'Summon monster IV', 700, 'CR');
picker.add(81, 83, 'Summon nature’s ally IV', 700, 'CR');
picker.add(84, 86, 'Tongues', 700, 'CR');
picker.add(87, 89, 'Unholy blight', 700, 'CR');
picker.add(90, 93, 'Divination', 725, 'CR');
picker.add(94, 96, 'Planar ally, lesser', 1200, 'CR');
picker.add(97, 100, 'Restoration', 1700, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][4];
picker.add(1, 4, 'Absorb toxicity', 700, 'UC');
picker.add(5, 6, 'Antiplant shell', 700, 'CR');
picker.add(7, 11, 'Aspect of the stag', 700, 'APG');
picker.add(12, 15, 'Aura of doom', 700, 'UM');
picker.add(16, 21, 'Ball lightning', 700, 'APG');
picker.add(22, 25, 'Blessing of fervor', 700, 'APG');
picker.add(26, 28, 'Blight', 700, 'CR');
picker.add(29, 31, 'Command plants', 700, 'CR');
picker.add(32, 35, 'Control water', 700, 'CR');
picker.add(36, 39, 'Debilitating portent', 700, 'UC');
picker.add(40, 43, 'Giant vermin', 700, 'CR');
picker.add(44, 49, 'Ice storm', 700, 'CR');
picker.add(50, 55, 'Imbue with spell ability', 700, 'CR');
picker.add(56, 59, 'Plague carrier', 700, 'UM');
picker.add(60, 63, 'Planar adaptation', 700, 'APG');
picker.add(64, 67, 'Protection from energy, communal', 700, 'UC');
picker.add(68, 72, 'Reincarnate', 700, 'CR');
picker.add(73, 75, 'Repel vermin', 700, 'CR');
picker.add(76, 78, 'Rusting grasp', 700, 'CR');
picker.add(79, 83, 'Scrying', 700, 'CR');
picker.add(84, 87, 'Sending', 700, 'CR');
picker.add(88, 90, 'Spiritual ally', 700, 'APG');
picker.add(91, 93, 'Thorn body', 700, 'APG');
picker.add(94, 98, 'Volcanic storm', 700, 'UM');
picker.add(99, 100, 'Symbol of slowing', 1700, 'UM');

picker = scrolls.typeAndLevelToPicker['common divine'][5];
picker.add(1, 2, 'Animal growth', 1125, 'CR');
picker.add(3, 4, 'Atonement', 1125, 'CR');
picker.add(5, 7, 'Baleful polymorph', 1125, 'CR');
picker.add(8, 11, 'Break enchantment', 1125, 'CR');
picker.add(12, 16, 'Breath of life', 1125, 'CR');
picker.add(17, 21, 'Call lightning storm', 1125, 'CR');
picker.add(22, 25, 'Command, greater', 1125, 'CR');
picker.add(26, 30, 'Cure light wounds, mass', 1125, 'CR');
picker.add(31, 34, 'Death ward', 1125, 'CR');
picker.add(35, 37, 'Disrupting weapon', 1125, 'CR');
picker.add(38, 42, 'Inflict light wounds, mass', 1125, 'CR');
picker.add(43, 47, 'Plane shift', 1125, 'CR');
picker.add(48, 53, 'Righteous might', 1125, 'CR');
picker.add(54, 57, 'Scrying', 1125, 'CR');
picker.add(58, 62, 'Slay living', 1125, 'CR');
picker.add(63, 67, 'Spell resistance', 1125, 'CR');
picker.add(68, 70, 'Summon monster V', 1125, 'CR');
picker.add(71, 73, 'Summon nature’s ally V', 1125, 'CR');
picker.add(74, 75, 'Tree stride', 1125, 'CR');
picker.add(76, 77, 'Wall of fire', 1125, 'CR');
picker.add(78, 80, 'Wall of stone', 1125, 'CR');
picker.add(81, 82, 'Wall of thorns', 1125, 'CR');
picker.add(83, 87, 'True seeing', 1375, 'CR');
picker.add(88, 91, 'Commune', 1625, 'CR');
picker.add(92, 94, 'Awaken', 3125, 'CR');
picker.add(95, 100, 'Raise dead', 6125, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][5];
picker.add(1, 3, 'Air walk, communal', 1125, 'UC');
picker.add(4, 8, 'Aspect of the wolf', 1125, 'APG');
picker.add(9, 11, 'Blessing of the salamander', 1125, 'APG');
picker.add(12, 15, 'Cleanse', 1125, 'APG');
picker.add(16, 21, 'Commune with nature', 1125, 'CR');
picker.add(22, 24, 'Contagion, greater', 1125, 'UM');
picker.add(25, 28, 'Control winds', 1125, 'CR');
picker.add(29, 31, 'Dispel chaos', 1125, 'CR');
picker.add(32, 34, 'Dispel evil', 1125, 'CR');
picker.add(35, 37, 'Dispel good', 1125, 'CR');
picker.add(38, 40, 'Dispel law', 1125, 'CR');
picker.add(41, 43, 'Fickle winds', 1125, 'UM');
picker.add(44, 46, 'Forbid action, greater', 1125, 'UM');
picker.add(47, 52, 'Insect plague', 1125, 'CR');
picker.add(53, 55, 'Life bubble', 1125, 'APG');
picker.add(56, 58, 'Mark of justice', 1125, 'CR');
picker.add(59, 63, 'Pillar of life', 1125, 'APG');
picker.add(64, 66, 'Serenity', 1125, 'UM');
picker.add(67, 72, 'Snake staff', 1125, 'APG');
picker.add(73, 76, 'Spell immunity, communal', 1125, 'UC');
picker.add(77, 79, 'Transmute mud to rock', 1125, 'CR');
picker.add(80, 82, 'Transmute rock to mud', 1125, 'CR');
picker.add(83, 86, 'Wind blades', 1125, 'ARG');
picker.add(87, 90, 'Stoneskin', 1375, 'CR');
picker.add(91, 92, 'Hallow1', 2125, 'CR');
picker.add(93, 94, 'Symbol of pain', 2125, 'CR');
picker.add(95, 96, 'Symbol of sleep', 2125, 'CR');
picker.add(97, 98, 'Unhallow (no additional spell)', 2125, 'CR');
picker.add(99, 99, 'Hallow (4th level spell included)', 6125, 'CR');
picker.add(100, 100, 'Unhallow (4th level spell included)', 6125, 'CR');

picker = scrolls.typeAndLevelToPicker['common divine'][6];
picker.add(1, 5, 'Bear’s endurance, mass', 1650, 'CR');
picker.add(6, 11, 'Blade barrier', 1650, 'CR');
picker.add(12, 16, 'Bull’s strength, mass', 1650, 'CR');
picker.add(17, 21, 'Cat’s grace, mass', 1650, 'CR');
picker.add(22, 27, 'Cure moderate wounds, mass', 1650, 'CR');
picker.add(28, 32, 'Dispel magic, greater', 1650, 'CR');
picker.add(33, 37, 'Eagle’s splendor, mass', 1650, 'CR');
picker.add(38, 43, 'Find the path', 1650, 'CR');
picker.add(44, 47, 'Fire seeds', 1650, 'CR');
picker.add(48, 55, 'Harm', 1650, 'CR');
picker.add(56, 63, 'Heal', 1650, 'CR');
picker.add(64, 69, 'Heroes’ feast', 1650, 'CR');
picker.add(70, 74, 'Inflict moderate wounds, mass', 1650, 'CR');
picker.add(75, 78, 'Liveoak', 1650, 'CR');
picker.add(79, 83, 'Owl’s wisdom, mass', 1650, 'CR');
picker.add(84, 87, 'Summon monster VI', 1650, 'CR');
picker.add(88, 91, 'Summon nature’s ally VI', 1650, 'CR');
picker.add(92, 96, 'Word of recall', 1650, 'CR');
picker.add(97, 100, 'Planar ally', 2900, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][6];
picker.add(1, 5, 'Animate objects', 1650, 'CR');
picker.add(6, 9, 'Antilife shell', 1650, 'CR');
picker.add(10, 15, 'Banishment', 1650, 'CR');
picker.add(16, 19, 'Cold ice strike', 1650, 'UM');
picker.add(20, 23, 'Dust form', 1650, 'UC');
picker.add(24, 29, 'Geas/quest', 1650, 'CR');
picker.add(30, 33, 'Ironwood', 1650, 'CR');
picker.add(34, 37, 'Joyful rapture', 1650, 'UM');
picker.add(38, 42, 'Move earth', 1650, 'CR');
picker.add(43, 46, 'Plague storm', 1650, 'UM');
picker.add(47, 51, 'Planar adaptation, mass', 1650, 'APG');
picker.add(52, 54, 'Repel wood', 1650, 'CR');
picker.add(55, 59, 'Sirocco', 1650, 'APG');
picker.add(60, 63, 'Spellstaff', 1650, 'CR');
picker.add(64, 67, 'Stone tell', 1650, 'CR');
picker.add(68, 70, 'Swarm skin', 1650, 'APG');
picker.add(71, 74, 'Tar pool', 1650, 'UC');
picker.add(75, 77, 'Transport via plants', 1650, 'CR');
picker.add(78, 83, 'Wind walk', 1650, 'CR');
picker.add(84, 86, 'Create undead', 1750, 'CR');
picker.add(87, 90, 'Glyph of warding, greater', 2050, 'CR');
picker.add(91, 92, 'Undeath to death', 2150, 'CR');
picker.add(93, 95, 'Symbol of fear', 2650, 'CR');
picker.add(96, 98, 'Forbiddance', 4650, 'CR');
picker.add(99, 100, 'Symbol of persuasion', 6650, 'CR');

picker = scrolls.typeAndLevelToPicker['common divine'][7];
picker.add(1, 4, 'Blasphemy', 2275, 'CR');
picker.add(5, 10, 'Control weather', 2275, 'CR');
picker.add(11, 17, 'Creeping doom', 2275, 'CR');
picker.add(18, 24, 'Cure serious wounds, mass', 2275, 'CR');
picker.add(25, 28, 'Dictum', 2275, 'CR');
picker.add(29, 33, 'Ethereal jaunt', 2275, 'CR');
picker.add(34, 40, 'Fire storm', 2275, 'CR');
picker.add(41, 44, 'Holy word', 2275, 'CR');
picker.add(45, 50, 'Inflict serious wounds, mass', 2275, 'CR');
picker.add(51, 55, 'Regenerate', 2275, 'CR');
picker.add(56, 60, 'Repulsion', 2275, 'CR');
picker.add(61, 65, 'Scrying, greater', 2275, 'CR');
picker.add(66, 69, 'Summon monster VII', 2275, 'CR');
picker.add(70, 73, 'Summon nature’s ally VII', 2275, 'CR');
picker.add(74, 78, 'Sunbeam', 2275, 'CR');
picker.add(79, 82, 'Word of chaos', 2275, 'CR');
picker.add(83, 89, 'Destruction', 2775, 'CR');
picker.add(90, 94, 'Restoration, greater', 7275, 'CR');
picker.add(95, 100, 'Resurrection', 12275, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][7];
picker.add(1, 8, 'Animate plants', 2275, 'CR');
picker.add(9, 17, 'Changestaff', 2275, 'CR');
picker.add(18, 24, 'Circle of clarity', 2275, 'UM');
picker.add(25, 30, 'Create demiplane, lesser', 2275, 'UM');
picker.add(31, 38, 'Jolting portent', 2275, 'UC');
picker.add(39, 45, 'Rampart', 2275, 'APG');
picker.add(46, 53, 'Scouring winds', 2275, 'UM');
picker.add(54, 60, 'Siege of trees', 2275, 'UC');
picker.add(61, 67, 'Transmute metal to wood', 2275, 'CR');
picker.add(68, 76, 'Vortex', 2275, 'APG');
picker.add(77, 83, 'Waves of ecstasy', 2275, 'UM');
picker.add(84, 89, 'Refuge', 3775, 'CR');
picker.add(90, 95, 'Symbol of stunning', 7275, 'CR');
picker.add(96, 100, 'Symbol of weakness', 7275, 'CR');

picker = scrolls.typeAndLevelToPicker['common divine'][8];
picker.add(1, 8, 'Antimagic field', 3000, 'CR');
picker.add(9, 14, 'Cloak of chaos', 3000, 'CR');
picker.add(15, 23, 'Cure critical wounds, mass', 3000, 'CR');
picker.add(24, 31, 'Earthquake', 3000, 'CR');
picker.add(32, 38, 'Finger of death', 3000, 'CR');
picker.add(39, 44, 'Holy aura', 3000, 'CR');
picker.add(45, 51, 'Inflict critical wounds, mass', 3000, 'CR');
picker.add(52, 59, 'Reverse gravity', 3000, 'CR');
picker.add(60, 65, 'Shield of law', 3000, 'CR');
picker.add(66, 73, 'Spell immunity, greater', 3000, 'CR');
picker.add(74, 78, 'Summon monster VIII', 3000, 'CR');
picker.add(79, 83, 'Summon nature’s ally VIII', 3000, 'CR');
picker.add(84, 89, 'Sunburst', 3000, 'CR');
picker.add(90, 95, 'Unholy aura', 3000, 'CR');
picker.add(96, 100, 'Planar ally, greater', 5500, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][8];
picker.add(1, 7, 'Animal shapes', 3000, 'CR');
picker.add(8, 13, 'Blood mist', 3000, 'UM');
picker.add(14, 18, 'Control plants', 3000, 'CR');
picker.add(19, 24, 'Create demiplane', 3000, 'UM');
picker.add(25, 31, 'Dimensional lock', 3000, 'CR');
picker.add(32, 37, 'Discern location', 3000, 'CR');
picker.add(38, 42, 'Euphoric tranquility', 3000, 'APG');
picker.add(43, 49, 'Frightful aspect', 3000, 'UC');
picker.add(50, 56, 'Orb of the void', 3000, 'UM');
picker.add(57, 61, 'Repel metal or stone', 3000, 'CR');
picker.add(62, 68, 'Seamantle', 3000, 'APG');
picker.add(69, 75, 'Storm bolts', 3000, 'APG');
picker.add(76, 83, 'Whirlwind', 3000, 'CR');
picker.add(84, 88, 'Create greater undead', 3150, 'CR');
picker.add(89, 95, 'Symbol of death', 8000, 'CR');
picker.add(96, 100, 'Symbol of insanity', 8000, 'CR');

picker = scrolls.typeAndLevelToPicker['common divine'][9];
picker.add(1, 7, 'Elemental swarm', 3825, 'CR');
picker.add(8, 15, 'Energy drain', 3825, 'CR');
picker.add(16, 22, 'Etherealness', 3825, 'CR');
picker.add(23, 30, 'Gate', 3825, 'CR');
picker.add(31, 40, 'Heal, mass', 3825, 'CR');
picker.add(41, 48, 'Implosion', 3825, 'CR');
picker.add(49, 58, 'Miracle', 3825, 'CR');
picker.add(59, 65, 'Shambler', 3825, 'CR');
picker.add(66, 73, 'Shapechange', 3825, 'CR');
picker.add(74, 81, 'Storm of vengeance', 3825, 'CR');
picker.add(82, 87, 'Summon monster IX', 3825, 'CR');
picker.add(88, 93, 'Summon nature’s ally IX', 3825, 'CR');
picker.add(94, 100, 'True resurrection', 28825, 'CR');

picker = scrolls.typeAndLevelToPicker['uncommon divine'][9];
picker.add(1, 8, 'Antipathy', 3825, 'CR');
picker.add(9, 15, 'Clashing rocks', 3825, 'APG');
picker.add(16, 22, 'Create demiplane, greater', 3825, 'UM');
picker.add(23, 31, 'Foresight', 3825, 'CR');
picker.add(32, 39, 'Overwhelming presence', 3825, 'UM');
picker.add(40, 47, 'Polar midnight', 3825, 'UM');
picker.add(48, 56, 'Soul bind', 3825, 'CR');
picker.add(57, 64, 'Spell immunity, greater communal', 3825, 'UC');
picker.add(65, 71, 'Summon froghemoth', 3825, 'UM');
picker.add(72, 80, 'Winds of vengeance', 3825, 'APG');
picker.add(81, 87, 'World wave', 3825, 'APG');
picker.add(88, 94, 'Astral projection', 4825, 'CR');
picker.add(95, 100, 'Sympathy', 5325, 'CR');

picker = wands.typeAndLevelToPicker['common'][0];
picker.add(1, 7, 'Acid splash', 375, 'CR');
picker.add(8, 14, 'Create water', 375, 'CR');
picker.add(15, 20, 'Daze', 375, 'CR');
picker.add(21, 28, 'Detect magic', 375, 'CR');
picker.add(29, 34, 'Ghost sound', 375, 'CR');
picker.add(35, 42, 'Light', 375, 'CR');
picker.add(43, 49, 'Mage hand', 375, 'CR');
picker.add(50, 55, 'Mending', 375, 'CR');
picker.add(56, 60, 'Message', 375, 'CR');
picker.add(61, 66, 'Prestidigitation', 375, 'CR');
picker.add(67, 73, 'Purify food and drink', 375, 'CR');
picker.add(74, 81, 'Ray of frost', 375, 'CR');
picker.add(82, 88, 'Read magic', 375, 'CR');
picker.add(89, 95, 'Stabilize', 375, 'CR');
picker.add(96, 100, 'Touch of fatigue', 375, 'CR');

picker = wands.typeAndLevelToPicker['uncommon'][0];
picker.add(1, 6, 'Arcane mark', 375, 'CR');
picker.add(7, 15, 'Bleed', 375, 'CR');
picker.add(16, 22, 'Dancing lights', 375, 'CR');
picker.add(23, 31, 'Detect poison', 375, 'CR');
picker.add(32, 40, 'Disrupt undead', 375, 'CR');
picker.add(41, 48, 'Flare', 375, 'CR');
picker.add(49, 56, 'Guidance', 375, 'CR');
picker.add(57, 65, 'Know direction', 375, 'CR');
picker.add(66, 73, 'Lullaby', 375, 'CR');
picker.add(74, 79, 'Open/close', 375, 'CR');
picker.add(80, 86, 'Resistance', 375, 'CR');
picker.add(87, 94, 'Spark', 375, 'APG');
picker.add(95, 100, 'Virtue', 375, 'CR');

picker = wands.typeAndLevelToPicker['common'][1];
picker.add(1, 2, 'Alarm', 750, 'CR');
picker.add(3, 3, 'Animate rope', 750, 'CR');
picker.add(4, 5, 'Bane', 750, 'CR');
picker.add(6, 11, 'Bless', 750, 'CR');
picker.add(12, 14, 'Burning hands', 750, 'CR');
picker.add(15, 17, 'Cause fear', 750, 'CR');
picker.add(18, 19, 'Charm person', 750, 'CR');
picker.add(20, 21, 'Color spray', 750, 'CR');
picker.add(22, 23, 'Command', 750, 'CR');
picker.add(24, 24, 'Comprehend languages', 750, 'CR');
picker.add(25, 31, 'Cure light wounds', 750, 'CR');
picker.add(32, 33, 'Disguise self', 750, 'CR');
picker.add(34, 37, 'Divine favor', 750, 'CR');
picker.add(38, 38, 'Endure elements', 750, 'CR');
picker.add(39, 41, 'Enlarge person', 750, 'CR');
picker.add(42, 43, 'Entangle', 750, 'CR');
picker.add(44, 45, 'Expeditious retreat', 750, 'CR');
picker.add(46, 46, 'Feather fall', 750, 'CR');
picker.add(47, 48, 'Grease', 750, 'CR');
picker.add(49, 50, 'Identify', 750, 'CR');
picker.add(51, 52, 'Inflict light wounds', 750, 'CR');
picker.add(53, 58, 'Mage armor', 750, 'CR');
picker.add(59, 60, 'Magic fang', 750, 'CR');
picker.add(61, 67, 'Magic missile', 750, 'CR');
picker.add(68, 68, 'Magic stone', 750, 'CR');
picker.add(69, 70, 'Magic weapon', 750, 'CR');
picker.add(71, 71, 'Obscuring mist', 750, 'CR');
picker.add(72, 73, 'Produce flame', 750, 'CR');
picker.add(74, 74, 'Protection from chaos', 750, 'CR');
picker.add(75, 75, 'Protection from evil', 750, 'CR');
picker.add(76, 76, 'Protection from good', 750, 'CR');
picker.add(77, 77, 'Protection from law', 750, 'CR');
picker.add(78, 79, 'Ray of enfeeblement', 750, 'CR');
picker.add(80, 81, 'Remove fear', 750, 'CR');
picker.add(82, 84, 'Shield', 750, 'CR');
picker.add(85, 86, 'Shield of faith', 750, 'CR');
picker.add(87, 87, 'Shillelagh', 750, 'CR');
picker.add(88, 89, 'Shocking grasp', 750, 'CR');
picker.add(90, 90, 'Silent image', 750, 'CR');
picker.add(91, 94, 'Sleep', 750, 'CR');
picker.add(95, 95, 'Summon monster I', 750, 'CR');
picker.add(96, 96, 'Summon nature’s ally I', 750, 'CR');
picker.add(97, 99, 'True strike', 750, 'CR');
picker.add(100, 100, 'Unseen servant', 750, 'CR');

picker = wands.typeAndLevelToPicker['uncommon'][1];
picker.add(1, 2, 'Ant haul', 750, 'APG');
picker.add(3, 5, 'Aspect of the falcon', 750, 'APG');
picker.add(6, 7, 'Bless weapon', 750, 'CR');
picker.add(8, 8, 'Calm animals', 750, 'CR');
picker.add(9, 10, 'Charm animal', 750, 'CR');
picker.add(11, 12, 'Chill touch', 750, 'CR');
picker.add(13, 14, 'Compel hostility', 750, 'UC');
picker.add(15, 17, 'Confusion, lesser', 750, 'CR');
picker.add(18, 19, 'Corrosive touch', 750, 'UM');
picker.add(20, 21, 'Deathwatch', 750, 'CR');
picker.add(22, 22, 'Detect animals or plants', 750, 'CR');
picker.add(23, 23, 'Detect chaos', 750, 'CR');
picker.add(24, 24, 'Detect evil', 750, 'CR');
picker.add(25, 25, 'Detect good', 750, 'CR');
picker.add(26, 26, 'Detect law', 750, 'CR');
picker.add(27, 28, 'Detect secret doors', 750, 'CR');
picker.add(29, 29, 'Detect snares and pits', 750, 'CR');
picker.add(30, 31, 'Detect undead', 750, 'CR');
picker.add(32, 35, 'Doom', 750, 'CR');
picker.add(36, 37, 'Entropic shield', 750, 'CR');
picker.add(38, 38, 'Erase', 750, 'CR');
picker.add(39, 39, 'Faerie fire', 750, 'CR');
picker.add(40, 41, 'Feather step', 750, 'APG');
picker.add(42, 44, 'Floating disk', 750, 'CR');
picker.add(45, 47, 'Goodberry', 750, 'CR');
picker.add(48, 49, 'Hide from animals', 750, 'CR');
picker.add(50, 51, 'Hide from undead', 750, 'CR');
picker.add(52, 52, 'Hideous laughter', 750, 'CR');
picker.add(53, 54, 'Hold portal', 750, 'CR');
picker.add(55, 56, 'Hypnotism', 750, 'CR');
picker.add(57, 58, 'Icicle dagger', 750, 'UM');
picker.add(59, 60, 'Ill omen', 750, 'APG');
picker.add(61, 63, 'Jump', 750, 'CR');
picker.add(64, 65, 'Longstrider', 750, 'CR');
picker.add(66, 66, 'Magic aura', 750, 'CR');
picker.add(67, 68, 'Mount', 750, 'CR');
picker.add(69, 69, 'Obscure object', 750, 'CR');
picker.add(70, 71, 'Pass without trace', 750, 'CR');
picker.add(72, 72, 'Ray of sickening', 750, 'UM');
picker.add(73, 75, 'Reduce person', 750, 'CR');
picker.add(76, 78, 'Sanctuary', 750, 'CR');
picker.add(79, 80, 'Shock shield', 750, 'UC');
picker.add(81, 83, 'Speak with animals', 750, 'CR');
picker.add(84, 85, 'Stone fist', 750, 'APG');
picker.add(86, 87, 'Stone shield', 750, 'ARG');
picker.add(88, 88, 'Summon minor monster', 750, 'UM');
picker.add(89, 89, 'Undetectable alignment', 750, 'CR');
picker.add(90, 92, 'Urban grace', 750, 'ARG');
picker.add(93, 96, 'Vanish', 750, 'APG');
picker.add(97, 97, 'Ventriloquism', 750, 'CR');
picker.add(98, 98, 'Magic mouth', 1250, 'CR');
picker.add(99, 99, 'Bless water', 2000, 'CR');
picker.add(100, 100, 'Curse water', 2000, 'CR');

picker = wands.typeAndLevelToPicker['common'][2];
picker.add(1, 2, 'Acid arrow', 4500, 'CR');
picker.add(3, 3, 'Aid', 4500, 'CR');
picker.add(4, 5, 'Alter self', 4500, 'CR');
picker.add(6, 7, 'Barkskin', 4500, 'CR');
picker.add(8, 10, 'Bear’s endurance', 4500, 'CR');
picker.add(11, 11, 'Blur', 4500, 'CR');
picker.add(12, 14, 'Bull’s strength', 4500, 'CR');
picker.add(15, 16, 'Cat’s grace', 4500, 'CR');
picker.add(17, 22, 'Cure moderate wounds', 4500, 'CR');
picker.add(23, 25, 'Darkness', 4500, 'CR');
picker.add(26, 26, 'Darkvision', 4500, 'CR');
picker.add(27, 27, 'Delay poison', 4500, 'CR');
picker.add(28, 29, 'Eagle’s splendor', 4500, 'CR');
picker.add(30, 30, 'False life', 4500, 'CR');
picker.add(31, 31, 'Find traps', 4500, 'CR');
picker.add(32, 32, 'Flame blade', 4500, 'CR');
picker.add(33, 33, 'Flaming sphere', 4500, 'CR');
picker.add(34, 35, 'Fog cloud', 4500, 'CR');
picker.add(36, 37, 'Fox’s cunning', 4500, 'CR');
picker.add(38, 38, 'Glitterdust', 4500, 'CR');
picker.add(39, 40, 'Heat metal', 4500, 'CR');
picker.add(41, 43, 'Hold person', 4500, 'CR');
picker.add(44, 46, 'Inflict moderate wounds', 4500, 'CR');
picker.add(47, 51, 'Invisibility', 4500, 'CR');
picker.add(52, 52, 'Knock', 4500, 'CR');
picker.add(53, 54, 'Levitate', 4500, 'CR');
picker.add(55, 55, 'Minor image', 4500, 'CR');
picker.add(56, 57, 'Mirror image', 4500, 'CR');
picker.add(58, 59, 'Owl’s wisdom', 4500, 'CR');
picker.add(60, 60, 'Pyrotechnics', 4500, 'CR');
picker.add(61, 61, 'Remove paralysis', 4500, 'CR');
picker.add(62, 64, 'Resist energy', 4500, 'CR');
picker.add(65, 66, 'Restoration, lesser', 4500, 'CR');
picker.add(67, 71, 'Scorching ray', 4500, 'CR');
picker.add(72, 73, 'See invisibility', 4500, 'CR');
picker.add(74, 74, 'Shatter', 4500, 'CR');
picker.add(75, 76, 'Shield other', 4500, 'CR');
picker.add(77, 78, 'Silence', 4500, 'CR');
picker.add(79, 81, 'Sound burst', 4500, 'CR');
picker.add(82, 83, 'Spider climb', 4500, 'CR');
picker.add(84, 86, 'Spiritual weapon', 4500, 'CR');
picker.add(87, 88, 'Summon monster II', 4500, 'CR');
picker.add(89, 90, 'Summon nature’s ally II', 4500, 'CR');
picker.add(91, 92, 'Summon swarm', 4500, 'CR');
picker.add(93, 96, 'Web', 4500, 'CR');
picker.add(97, 97, 'Whispering wind', 4500, 'CR');
picker.add(98, 99, 'Augury', 5750, 'CR');
picker.add(100, 100, 'Fire trap', 5750, 'CR');

picker = wands.typeAndLevelToPicker['uncommon'][2];
picker.add(1, 2, 'Align weapon', 4500, 'CR');
picker.add(3, 5, 'Animal aspect', 4500, 'UC');
picker.add(6, 6, 'Animal messenger', 4500, 'CR');
picker.add(7, 7, 'Animal trance', 4500, 'CR');
picker.add(8, 10, 'Aspect of the bear', 4500, 'APG');
picker.add(11, 13, 'Bestow weapon proficiency', 4500, 'UC');
picker.add(14, 15, 'Blindness/deafness', 4500, 'CR');
picker.add(16, 18, 'Burning gaze', 4500, 'APG');
picker.add(19, 21, 'Calm emotions', 4500, 'CR');
picker.add(22, 24, 'Chill metal', 4500, 'CR');
picker.add(25, 25, 'Command undead', 4500, 'CR');
picker.add(26, 27, 'Daze monster', 4500, 'CR');
picker.add(28, 29, 'Death knell', 4500, 'CR');
picker.add(30, 32, 'Defensive shock', 4500, 'UM');
picker.add(33, 33, 'Delay pain', 4500, 'UM');
picker.add(34, 35, 'Detect thoughts', 4500, 'CR');
picker.add(36, 39, 'Disguise other', 4500, 'UM');
picker.add(40, 42, 'Effortless armor', 4500, 'UC');
picker.add(43, 46, 'Elemental touch', 4500, 'APG');
picker.add(47, 48, 'Enthrall', 4500, 'CR');
picker.add(49, 50, 'Gentle repose', 4500, 'CR');
picker.add(51, 51, 'Ghoul touch', 4500, 'CR');
picker.add(52, 53, 'Glide', 4500, 'APG');
picker.add(54, 55, 'Groundswell', 4500, 'ARG');
picker.add(56, 56, 'Gust of wind', 4500, 'CR');
picker.add(57, 57, 'Hold animal', 4500, 'CR');
picker.add(58, 59, 'Hypnotic pattern', 4500, 'CR');
picker.add(60, 60, 'Locate object', 4500, 'CR');
picker.add(61, 61, 'Make whole', 4500, 'CR');
picker.add(62, 63, 'Misdirection', 4500, 'CR');
picker.add(64, 65, 'Oppressive boredom', 4500, 'UM');
picker.add(66, 66, 'Protection from arrows', 4500, 'CR');
picker.add(67, 67, 'Reduce animal', 4500, 'CR');
picker.add(68, 69, 'Rope trick', 4500, 'CR');
picker.add(70, 72, 'Scare', 4500, 'CR');
picker.add(73, 74, 'Share language', 4500, 'APG');
picker.add(75, 76, 'Soften earth and stone', 4500, 'CR');
picker.add(77, 78, 'Spectral hand', 4500, 'CR');
picker.add(79, 80, 'Status', 4500, 'CR');
picker.add(81, 82, 'Tongues', 4500, 'CR');
picker.add(83, 84, 'Touch of idiocy', 4500, 'CR');
picker.add(85, 86, 'Tree shape', 4500, 'CR');
picker.add(87, 88, 'Warp wood', 4500, 'CR');
picker.add(89, 91, 'Weapon of awe', 4500, 'APG');
picker.add(92, 93, 'Wood shape', 4500, 'CR');
picker.add(94, 95, 'Zone of truth', 4500, 'CR');
picker.add(96, 96, 'Arcane lock', 5750, 'CR');
picker.add(97, 97, 'Consecrate', 5750, 'CR');
picker.add(98, 98, 'Desecrate', 5750, 'CR');
picker.add(99, 99, 'Continual flame', 7000, 'CR');
picker.add(100, 100, 'Phantom trap', 7000, 'CR');

picker = wands.typeAndLevelToPicker['common'][3];
picker.add(1, 2, 'Beast shape I', 11250, 'CR');
picker.add(3, 4, 'Blink', 11250, 'CR');
picker.add(5, 7, 'Call lightning', 11250, 'CR');
picker.add(8, 8, 'Create food and water', 11250, 'CR');
picker.add(9, 14, 'Cure serious wounds', 11250, 'CR');
picker.add(15, 16, 'Daylight', 11250, 'CR');
picker.add(17, 18, 'Deep slumber', 11250, 'CR');
picker.add(19, 20, 'Deeper darkness', 11250, 'CR');
picker.add(21, 25, 'Dispel magic', 11250, 'CR');
picker.add(26, 28, 'Displacement', 11250, 'CR');
picker.add(29, 34, 'Fireball', 11250, 'CR');
picker.add(35, 35, 'Flame arrow', 11250, 'CR');
picker.add(36, 37, 'Fly', 11250, 'CR');
picker.add(38, 38, 'Gaseous form', 11250, 'CR');
picker.add(39, 40, 'Haste', 11250, 'CR');
picker.add(41, 42, 'Heroism', 11250, 'CR');
picker.add(43, 45, 'Inflict serious wounds', 11250, 'CR');
picker.add(46, 47, 'Invisibility purge', 11250, 'CR');
picker.add(48, 48, 'Invisibility sphere', 11250, 'CR');
picker.add(49, 50, 'Keen edge', 11250, 'CR');
picker.add(51, 55, 'Lightning bolt', 11250, 'CR');
picker.add(56, 56, 'Magic circle against chaos', 11250, 'CR');
picker.add(57, 57, 'Magic circle against evil', 11250, 'CR');
picker.add(58, 58, 'Magic circle against good', 11250, 'CR');
picker.add(59, 59, 'Magic circle against law', 11250, 'CR');
picker.add(60, 60, 'Magic fang, greater', 11250, 'CR');
picker.add(61, 62, 'Magic vestment', 11250, 'CR');
picker.add(63, 64, 'Magic weapon, greater', 11250, 'CR');
picker.add(65, 66, 'Major image', 11250, 'CR');
picker.add(67, 70, 'Prayer', 11250, 'CR');
picker.add(71, 74, 'Protection from energy', 11250, 'CR');
picker.add(75, 75, 'Remove blindness/deafness', 11250, 'CR');
picker.add(76, 77, 'Remove curse', 11250, 'CR');
picker.add(78, 79, 'Remove disease', 11250, 'CR');
picker.add(80, 82, 'Searing light', 11250, 'CR');
picker.add(83, 83, 'Sleet storm', 11250, 'CR');
picker.add(84, 85, 'Slow', 11250, 'CR');
picker.add(86, 87, 'Speak with dead', 11250, 'CR');
picker.add(88, 89, 'Stinking cloud', 11250, 'CR');
picker.add(90, 90, 'Stone shape', 11250, 'CR');
picker.add(91, 92, 'Suggestion', 11250, 'CR');
picker.add(93, 93, 'Summon monster III', 11250, 'CR');
picker.add(94, 94, 'Summon nature’s ally III', 11250, 'CR');
picker.add(95, 97, 'Vampiric touch', 11250, 'CR');
picker.add(98, 99, 'Water breathing', 11250, 'CR');
picker.add(100, 100, 'Animate dead', 23750, 'CR');

picker = wands.typeAndLevelToPicker['uncommon'][3];
picker.add(1, 4, 'Animal aspect, greater', 11250, 'UC');
picker.add(5, 6, 'Aqueous orb', 11250, 'APG');
picker.add(7, 8, 'Arcane sight', 11250, 'CR');
picker.add(9, 11, 'Archon’s aura', 11250, 'UM');
picker.add(12, 14, 'Ash storm', 11250, 'UM');
picker.add(15, 17, 'Bestow curse', 11250, 'CR');
picker.add(18, 20, 'Clairaudience/clairvoyance', 11250, 'CR');
picker.add(21, 22, 'Contagion', 11250, 'CR');
picker.add(23, 23, 'Diminish plants', 11250, 'CR');
picker.add(24, 25, 'Dominate animal', 11250, 'CR');
picker.add(26, 29, 'Elemental aura', 11250, 'APG');
picker.add(30, 30, 'Explosive runes', 11250, 'CR');
picker.add(31, 34, 'Force punch', 11250, 'UM');
picker.add(35, 35, 'Halt undead', 11250, 'CR');
picker.add(36, 37, 'Helping hand', 11250, 'CR');
picker.add(38, 40, 'Hostile levitation', 11250, 'UC');
picker.add(41, 43, 'Howling agony', 11250, 'UM');
picker.add(44, 45, 'Hydraulic torrent', 11250, 'APG');
picker.add(46, 46, 'Mad monkeys', 11250, 'UM');
picker.add(47, 49, 'Meld into stone', 11250, 'CR');
picker.add(50, 52, 'Neutralize poison', 11250, 'CR');
picker.add(53, 54, 'Pain strike', 11250, 'APG');
picker.add(55, 55, 'Phantom steed', 11250, 'CR');
picker.add(56, 57, 'Plant growth', 11250, 'CR');
picker.add(58, 60, 'Poison', 11250, 'CR');
picker.add(61, 61, 'Quench', 11250, 'CR');
picker.add(62, 65, 'Rage', 11250, 'CR');
picker.add(66, 67, 'Ray of exhaustion', 11250, 'CR');
picker.add(68, 69, 'Resinous skin', 11250, 'UC');
picker.add(70, 70, 'Secret page', 11250, 'CR');
picker.add(71, 71, 'Shrink item', 11250, 'CR');
picker.add(72, 73, 'Snare', 11250, 'CR');
picker.add(74, 74, 'Speak with plants', 11250, 'CR');
picker.add(75, 76, 'Spike growth', 11250, 'CR');
picker.add(77, 77, 'Tiny hut', 11250, 'CR');
picker.add(78, 81, 'Water walk', 11250, 'CR');
picker.add(82, 84, 'Wind wall', 11250, 'CR');
picker.add(85, 86, 'Wrathful mantle', 11250, 'APG');
picker.add(87, 87, 'Illusory script', 13750, 'CR');
picker.add(88, 89, 'Nondetection', 13750, 'CR');
picker.add(90, 91, 'Glibness', 15750, 'CR');
picker.add(92, 95, 'Good hope', 15750, 'CR');
picker.add(96, 97, 'Heal mount', 15750, 'CR');
picker.add(98, 98, 'Sculpt sound', 15750, 'CR');
picker.add(99, 99, 'Glyph of warding', 21250, 'CR');
picker.add(100, 100, 'Sepia snake sigil', 36250, 'CR');

picker = wands.typeAndLevelToPicker['common'][4];
picker.add(1, 2, 'Air walk', 21000, 'CR');
picker.add(3, 4, 'Beast shape II', 21000, 'CR');
picker.add(5, 7, 'Black tentacles', 21000, 'CR');
picker.add(8, 8, 'Chaos hammer', 21000, 'CR');
picker.add(9, 11, 'Charm monster', 21000, 'CR');
picker.add(12, 14, 'Confusion', 21000, 'CR');
picker.add(15, 16, 'Crushing despair', 21000, 'CR');
picker.add(17, 22, 'Cure critical wounds', 21000, 'CR');
picker.add(23, 24, 'Death ward', 21000, 'CR');
picker.add(25, 28, 'Dimension door', 21000, 'CR');
picker.add(29, 29, 'Dimensional anchor', 21000, 'CR');
picker.add(30, 30, 'Dismissal', 21000, 'CR');
picker.add(31, 33, 'Divine power', 21000, 'CR');
picker.add(34, 35, 'Elemental body I', 21000, 'CR');
picker.add(36, 37, 'Enervation', 21000, 'CR');
picker.add(38, 39, 'Enlarge person, mass', 21000, 'CR');
picker.add(40, 42, 'Fear', 21000, 'CR');
picker.add(43, 44, 'Fire shield', 21000, 'CR');
picker.add(45, 48, 'Flame strike', 21000, 'CR');
picker.add(49, 51, 'Freedom of movement', 21000, 'CR');
picker.add(52, 53, 'Globe of invulnerability, lesser', 21000, 'CR');
picker.add(54, 54, 'Holy smite', 21000, 'CR');
picker.add(55, 56, 'Ice storm', 21000, 'CR');
picker.add(57, 58, 'Imbue with spell ability', 21000, 'CR');
picker.add(59, 61, 'Inflict critical wounds', 21000, 'CR');
picker.add(62, 65, 'Invisibility, greater', 21000, 'CR');
picker.add(66, 66, 'Order’s wrath', 21000, 'CR');
picker.add(67, 69, 'Phantasmal killer', 21000, 'CR');
picker.add(70, 70, 'Resilient sphere', 21000, 'CR');
picker.add(71, 72, 'Scrying', 21000, 'CR');
picker.add(73, 73, 'Sending', 21000, 'CR');
picker.add(74, 74, 'Shout', 21000, 'CR');
picker.add(75, 76, 'Solid fog', 21000, 'CR');
picker.add(77, 79, 'Spell immunity', 21000, 'CR');
picker.add(80, 80, 'Summon monster IV', 21000, 'CR');
picker.add(81, 81, 'Summon nature’s ally IV', 21000, 'CR');
picker.add(82, 82, 'Unholy blight', 21000, 'CR');
picker.add(83, 87, 'Wall of fire', 21000, 'CR');
picker.add(88, 91, 'Wall of ice', 21000, 'CR');
picker.add(92, 93, 'Divination', 22250, 'CR');
picker.add(94, 95, 'Restoration', 26000, 'CR');
picker.add(96, 96, 'Break enchantment', 30000, 'CR');
picker.add(97, 98, 'Stoneskin', 33500, 'CR');
picker.add(99, 99, 'Planar ally, lesser', 46000, 'CR');
picker.add(100, 100, 'Restoration (Can dispel permanent negative levels)', 71000, 'CR');

picker = wands.typeAndLevelToPicker['uncommon'][4];
picker.add(1, 1, 'Antiplant shell', 21000, 'CR');
picker.add(2, 4, 'Arcane eye', 21000, 'CR');
picker.add(5, 7, 'Aspect of the stag', 21000, 'APG');
picker.add(8, 11, 'Ball lightning', 21000, 'APG');
picker.add(12, 12, 'Blight', 21000, 'CR');
picker.add(13, 13, 'Command plants', 21000, 'CR');
picker.add(14, 15, 'Control water', 21000, 'CR');
picker.add(16, 18, 'Darkvision, greater', 21000, 'UM');
picker.add(19, 19, 'Detect scrying', 21000, 'CR');
picker.add(20, 20, 'Discern lies', 21000, 'CR');
picker.add(21, 24, 'Dragon’s breath', 21000, 'APG');
picker.add(25, 28, 'False life, greater', 21000, 'UM');
picker.add(29, 30, 'Geas, lesser', 21000, 'CR');
picker.add(31, 34, 'Ghost wolf', 21000, 'ARG');
picker.add(35, 36, 'Giant vermin', 21000, 'CR');
picker.add(37, 37, 'Hallucinatory terrain', 21000, 'CR');
picker.add(38, 38, 'Illusory wall', 21000, 'CR');
picker.add(39, 40, 'Locate creature', 21000, 'CR');
picker.add(41, 42, 'Minor creation', 21000, 'CR');
picker.add(43, 43, 'Mnemonic enhancer', 21000, 'CR');
picker.add(44, 46, 'Obsidian flow', 21000, 'UC');
picker.add(47, 48, 'Rainbow pattern', 21000, 'CR');
picker.add(49, 50, 'Reduce person, mass', 21000, 'CR');
picker.add(51, 53, 'Reincarnate', 21000, 'CR');
picker.add(54, 54, 'Repel vermin', 21000, 'CR');
picker.add(55, 56, 'Ride the waves', 21000, 'UM');
picker.add(57, 59, 'Rusting grasp', 21000, 'CR');
picker.add(60, 60, 'Secure shelter', 21000, 'CR');
picker.add(61, 63, 'Shadow conjuration', 21000, 'CR');
picker.add(64, 67, 'Shadow step', 21000, 'UM');
picker.add(68, 70, 'Shocking image', 21000, 'UC');
picker.add(71, 74, 'Spike stones', 21000, 'CR');
picker.add(75, 76, 'Volcanic storm', 21000, 'UM');
picker.add(77, 79, 'Wandering star motes', 21000, 'APG');
picker.add(80, 80, 'Animal growth', 30000, 'CR');
picker.add(81, 82, 'Commune with nature', 30000, 'CR');
picker.add(83, 83, 'Dispel chaos', 30000, 'CR');
picker.add(84, 84, 'Dispel evil', 30000, 'CR');
picker.add(85, 87, 'Dominate person', 30000, 'CR');
picker.add(88, 91, 'Hold monster', 30000, 'CR');
picker.add(92, 94, 'Holy sword', 30000, 'CR');
picker.add(95, 95, 'Mark of justice', 30000, 'CR');
picker.add(96, 97, 'Modify memory', 30000, 'CR');
picker.add(98, 98, 'Tree stride', 30000, 'CR');
picker.add(99, 99, 'Zone of silence', 30000, 'CR');
picker.add(100, 100, 'Legend lore', 33500, 'CR');


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Treasure Type Allocaiton. TABLE 7-1 to 7-11.
// an allocation row has a declared budget and an array of pickers which, when rerolled should generate
// appropriate treasure totalling the budget
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	// this global constant holds the known allocations. The arrays are sorted in ascending order of gold, so
	// to find a treasure of type X worth not more than Y, go to the appropriate letter and scan backwards
	
	var treasureTypeAllocations = new Object();

	function TreasureTypeAllocation(type, budget, items) {
		this.type = type;
		this.budget = budget;
		this.items = items;
	}
	
	TreasureTypeAllocation.prototype.toString = function() {
		return "Treasure type " + this.type + " worth " + this.budget + "gp";
	}
	
	TreasureTypeAllocation.prototype.describeItems = function() {
		return this.items.toString();
	}
	
	TreasureTypeAllocation.prototype.reroll = function(treasureBlock) {
		for(var i = 0; i<this.items.length; i++) {
			if(this.items[i].reroll) {
				this.items[i].reroll(treasureBlock)
			}
			else {
				result = this.items[i].toString();
				treasureBlock.generatedItems.push(result);
				var sp = document.createElement('span');
				sp.style.margin = '1px';
				sp.style.padding = '1px';
				sp.style.border = 'thin solid darkgray';
				sp.appendChild(document.createTextNode(result));
				treasureBlock.generatedSpan.appendChild(sp);
			}
			if(i+1 < this.items.length) treasureBlock.generatedSpan.appendChild(document.createTextNode('; '));
		}
	}
	


	treasureTypeAllocations.A = [
	new TreasureTypeAllocation('A',     1, [makeCoinPicker(5, 10, 1, cp), makeCoinPicker(3, 4, 1, sp)]),
	new TreasureTypeAllocation('A',     5, [makeCoinPicker(2, 6, 10, cp), makeCoinPicker(4, 8, 1, sp), makeCoinPicker(1, 4, 1, gp)]),
	new TreasureTypeAllocation('A',    10, [makeCoinPicker(5, 10, 10, cp), makeCoinPicker(5, 10, 1, sp), makeCoinPicker(1, 8, 1, gp)]),
	new TreasureTypeAllocation('A',    25, [makeCoinPicker(2, 4, 100, cp), makeCoinPicker(3, 6, 10, sp), makeCoinPicker(4, 4, 1, gp)]),
	new TreasureTypeAllocation('A',    50, [makeCoinPicker(4, 4, 100, cp), makeCoinPicker(4, 6, 10, sp), makeCoinPicker(8, 6, 1, gp)]),
	new TreasureTypeAllocation('A',   100, [makeCoinPicker(6, 8, 10, sp), makeCoinPicker(3, 4, 10, gp)]),
	new TreasureTypeAllocation('A',   200, [makeCoinPicker(2, 4, 100, sp), makeCoinPicker(4, 4, 10, gp), makeCoinPicker(2, 4, 1, pp)]),
	new TreasureTypeAllocation('A',   500, [makeCoinPicker(6, 6, 10, gp), makeCoinPicker(8, 6, 1, pp)]),
	new TreasureTypeAllocation('A',  1000, [makeCoinPicker(2, 4, 100, gp), makeCoinPicker(10, 10, 1, pp)]),
	new TreasureTypeAllocation('A',  5000, [makeCoinPicker(4, 8, 100, gp), makeCoinPicker(6, 10, 10, pp)]),
	new TreasureTypeAllocation('A', 10000, [makeCoinPicker(2, 4, 1000, gp), makeCoinPicker(12, 8, 10, pp)]),
	new TreasureTypeAllocation('A', 50000, [makeCoinPicker(2, 6, 1000, gp), makeCoinPicker(8, 10, 100, pp)])
	];
	
	treasureTypeAllocations.B = [
	new TreasureTypeAllocation('B',   10, [gemPicker(1)]),
	new TreasureTypeAllocation('B',   15, [makeCoinPicker(2, 6, 10, cp), makeCoinPicker(4, 8, 1, sp), makeCoinPicker(1, 4, 1, gp), gemPicker(1)]),
	new TreasureTypeAllocation('B',   25, [makeCoinPicker(5, 10, 1, sp), makeCoinPicker(1, 4, 1, gp), mult(2, gemPicker(1))]),
	new TreasureTypeAllocation('B',   50, [gemPicker(2)]),
	new TreasureTypeAllocation('B',   50, [makeCoinPicker(3, 6, 10, sp), makeCoinPicker(3, 6, 1, gp), mult(3, gemPicker(1))]),
	new TreasureTypeAllocation('B',   75, [makeCoinPicker(1, 4, 10, sp), makeCoinPicker(1, 4, 1, gp), mult(2, gemPicker(1)), gemPicker(2)]),
	new TreasureTypeAllocation('B',  100, [gemPicker(3)]),
	new TreasureTypeAllocation('B',  100, [makeCoinPicker(3, 8, 10, sp), makeCoinPicker(4, 8, 1, gp), mult(2, gemPicker(1)), gemPicker(2)]),
	new TreasureTypeAllocation('B',  150, [gemPicker(2), gemPicker(3)]),
	new TreasureTypeAllocation('B',  200, [makeCoinPicker(3, 6, 10, sp), plainString('2d4x10 gp'), mult(4, gemPicker(1)), gemPicker(3)]),
	new TreasureTypeAllocation('B',  250, [makeCoinPicker(2, 4, 10, gp), mult(2, gemPicker(2)), gemPicker(3)]),
	new TreasureTypeAllocation('B',  500, [gemPicker(4)]),
	new TreasureTypeAllocation('B',  500, [makeCoinPicker(2, 4, 10, gp), makeCoinPicker(2, 4, 1, pp), mult(2, gemPicker(2)), mult(3, gemPicker(3))]),
	new TreasureTypeAllocation('B',  750, [makeCoinPicker(2, 4, 10, gp), mult(3, gemPicker(2)), gemPicker(3), gemPicker(4)]),
	new TreasureTypeAllocation('B', 1000, [gemPicker(5)]),
	new TreasureTypeAllocation('B', 1000, [makeCoinPicker(3, 6, 10, gp), makeCoinPicker(4, 4, 1, pp), mult(3, gemPicker(3)), gemPicker(4)]),
	new TreasureTypeAllocation('B', 2500, [makeCoinPicker(2, 4, 100, gp), mult(2, gemPicker(4)), gemPicker(5)]),
	new TreasureTypeAllocation('B', 5000, [gemPicker(6)]),
	new TreasureTypeAllocation('B', 5000, [makeCoinPicker(2, 4, 100, gp), plainString('2d4x10 pp'), mult(2, gemPicker(4)), mult(3, gemPicker(5))]),
	new TreasureTypeAllocation('B',10000, [mult(5, gemPicker(5)), gemPicker(6)]),
	new TreasureTypeAllocation('B',20000, [makeCoinPicker(4, 8, 100, gp), plainString('6d10x10 pp'), mult(3, gemPicker(6))]),
	new TreasureTypeAllocation('B',50000, [makeCoinPicker(4, 4, 10, pp), mult(10, gemPicker(3)), mult(4, gemPicker(4)), mult(6, gemPicker(5)), mult(8, gemPicker(6))])
	];
	

	treasureTypeAllocations.C = [
	new TreasureTypeAllocation('C', 50, [artPicker(1)]),
	new TreasureTypeAllocation('C', 100, [artPicker(2)]),
	new TreasureTypeAllocation('C', 100, [mult(2, artPicker(1))]),
	new TreasureTypeAllocation('C', 150, [artPicker(1), artPicker(2)]),
	new TreasureTypeAllocation('C', 200, [mult(2, artPicker(2))]),
	new TreasureTypeAllocation('C', 250, [mult(3, artPicker(1)), artPicker(2)]),
	new TreasureTypeAllocation('C', 500, [artPicker(3)]),
	new TreasureTypeAllocation('C', 500, [mult(4, artPicker(1)), mult(3, artPicker(2))]),
	new TreasureTypeAllocation('C', 750, [mult(3, artPicker(1)), mult(2, artPicker(2)), artPicker(3)]),
	new TreasureTypeAllocation('C', 1000, [artPicker(4)]),
	new TreasureTypeAllocation('C', 1000, [mult(2, artPicker(3))]),
	new TreasureTypeAllocation('C', 1500, [artPicker(3), artPicker(4)]),
	new TreasureTypeAllocation('C', 2000, [mult(2, artPicker(4))]),
	new TreasureTypeAllocation('C', 2500, [mult(5, artPicker(2)), mult(2, artPicker(3)), artPicker(4)]),
	new TreasureTypeAllocation('C', 5000, [artPicker(5)]),
	new TreasureTypeAllocation('C', 5000, [mult(4, artPicker(3)), mult(3, artPicker(4))]),
	new TreasureTypeAllocation('C', 7500, [artPicker(3), mult(2, artPicker(4)), artPicker(5)]),
	new TreasureTypeAllocation('C', 10000, [artPicker(6)]),
	new TreasureTypeAllocation('C', 10000, [mult(5, artPicker(4)), artPicker(5)]),
	new TreasureTypeAllocation('C', 15000, [artPicker(5), artPicker(6)]),
	new TreasureTypeAllocation('C', 20000, [mult(2, artPicker(5)), artPicker(6)]),
	new TreasureTypeAllocation('C', 50000, [mult(10, artPicker(3)), mult(5, artPicker(4)), mult(4, artPicker(5)), mult(2, artPicker(6))])
	];

	treasureTypeAllocations.D = [
	new TreasureTypeAllocation('D', 50, [makeCoinPicker(3, 6, 10, sp), makeCoinPicker(4, 4, 1, gp), lesser_minor_scroll]),
	new TreasureTypeAllocation('D', 50, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(2, 4, 1, gp), lesser_minor_potion]),
	new TreasureTypeAllocation('D', 100, [makeCoinPicker(4, 6, 10, sp), makeCoinPicker(3, 10, 1, gp), lesser_minor_potion, lesser_minor_scroll]),
	new TreasureTypeAllocation('D', 150, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(6, 6, 1, gp), greater_minor_scroll]),
	new TreasureTypeAllocation('D', 200, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(4, 6, 1, gp), greater_minor_potion, lesser_minor_scroll]),
	new TreasureTypeAllocation('D', 250, [makeCoinPicker(3, 6, 10, sp), makeCoinPicker(3, 6, 1, gp), makeCoinPicker(1, 4, 1, pp), mult(2, lesser_minor_potion), greater_minor_scroll]),
	new TreasureTypeAllocation('D', 300, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(6, 6, 1, gp), greater_minor_potion, greater_minor_scroll]),
	new TreasureTypeAllocation('D', 400, [greater_minor_potion, mult(2, greater_minor_scroll)]),
	new TreasureTypeAllocation('D', 500, [makeCoinPicker(2, 4, 10, gp), makeCoinPicker(1, 4, 1, pp), lesser_medium_potion, greater_minor_scroll]),
	new TreasureTypeAllocation('D', 500, [makeCoinPicker(2, 4, 10, gp), makeCoinPicker(1, 4, 1, pp), mult(2, greater_minor_potion), greater_minor_scroll]),
	new TreasureTypeAllocation('D', 750, [makeCoinPicker(7, 6, 1, gp), greater_minor_scroll, lesser_minor_wand]),
	new TreasureTypeAllocation('D', 1000, [makeCoinPicker(4, 4, 10, gp), makeCoinPicker(3, 6, 1, pp), lesser_medium_potion, lesser_medium_scroll]),
	new TreasureTypeAllocation('D', 1000, [makeCoinPicker(2, 4, 10, gp), makeCoinPicker(2, 4, 1, pp), lesser_medium_potion, lesser_minor_wand]),
	new TreasureTypeAllocation('D', 1500, [greater_minor_wand]),
	new TreasureTypeAllocation('D', 1500, [makeCoinPicker(4, 4, 10, gp), makeCoinPicker(3, 6, 1, pp), greater_medium_potion, greater_medium_scroll]),
	new TreasureTypeAllocation('D', 2000, [greater_medium_potion, greater_minor_wand]),
	new TreasureTypeAllocation('D', 2000, [makeCoinPicker(2, 4, 10, gp), makeCoinPicker(2, 4, 1, pp), lesser_medium_potion, mult(2, greater_medium_scroll)]),
	new TreasureTypeAllocation('D', 3000, [makeCoinPicker(3, 6, 10, gp), makeCoinPicker(4, 4, 1, pp), greater_medium_potion, greater_medium_scroll, greater_minor_wand]),
	new TreasureTypeAllocation('D', 4000, [makeCoinPicker(3, 6, 10, gp), makeCoinPicker(4, 4, 1, pp), greater_medium_scroll, mult(2, greater_minor_wand)]),
	new TreasureTypeAllocation('D', 5000, [makeCoinPicker(2, 4, 10, gp), makeCoinPicker(2, 4, 1, pp), mult(3, lesser_major_potion), mult(2, greater_medium_scroll), greater_minor_wand]),
	new TreasureTypeAllocation('D', 7500, [makeCoinPicker(2, 6, 1, pp), lesser_major_scroll, lesser_medium_wand]),
	new TreasureTypeAllocation('D', 7500, [makeCoinPicker(5, 6, 1, pp), mult(2, greater_major_potion), mult(2, greater_major_scroll)]),
	new TreasureTypeAllocation('D', 10000, [greater_medium_wand]),
	new TreasureTypeAllocation('D', 10000, [makeCoinPicker(4, 6, 1, pp), greater_major_potion, greater_major_scroll, lesser_medium_wand]),
	new TreasureTypeAllocation('D', 15000, [lesser_major_wand]),
	new TreasureTypeAllocation('D', 15000, [makeCoinPicker(9, 10, 1, pp), mult(3, greater_major_potion), mult(2, lesser_major_scroll), greater_medium_wand]),
	new TreasureTypeAllocation('D', 20000, [makeCoinPicker(4, 4, 10, gp), plainString('2d4x10 pp'), mult(2, greater_major_potion), greater_major_scroll, lesser_major_wand]),
	new TreasureTypeAllocation('D', 20000, [makeCoinPicker(6, 6, 10, gp), mult(3, lesser_major_potion), greater_major_wand]),
	new TreasureTypeAllocation('D', 25000, [mult(5, greater_major_scroll), greater_medium_wand]),
	new TreasureTypeAllocation('D', 30000, [makeCoinPicker(6, 6, 1, pp), mult(4, greater_major_potion), mult(3, greater_major_scroll), greater_major_wand]),
	new TreasureTypeAllocation('D', 50000, [makeCoinPicker(8, 4, 10, pp), mult(4, greater_major_scroll), mult(2, greater_major_wand)])
	];

	treasureTypeAllocations.E = [
	new TreasureTypeAllocation('E', 200, [plainString('Masterwork light armor or shield')]),
	new TreasureTypeAllocation('E', 300, [plainString('Masterwork medium armor')]),
	new TreasureTypeAllocation('E', 350, [plainString('Masterwork weapon')]),
	new TreasureTypeAllocation('E', 1000, [plainString('Masterwork heavy armor')]),
	new TreasureTypeAllocation('E', 1500, [plainString('lesser minor armor')]),
	new TreasureTypeAllocation('E', 2500, [plainString('lesser minor weapon')]),
	new TreasureTypeAllocation('E', 3000, [plainString('greater minor armor')]),
	new TreasureTypeAllocation('E', 3000, [plainString('Masterwork medium armor'), plainString('masterwork shield'), plainString('lesser minor weapon')]),
	new TreasureTypeAllocation('E', 4000, [plainString('lesser minor armor'), plainString('lesser minor weapon')]),
	new TreasureTypeAllocation('E', 5500, [plainString('greater minor armor'), plainString('lesser minor weapon')]),
	new TreasureTypeAllocation('E', 6000, [plainString('greater minor weapon')]),
	new TreasureTypeAllocation('E', 7500, [plainString('lesser minor armor'), plainString('greater minor weapon')]),
	new TreasureTypeAllocation('E', 8000, [plainString('greater minor armor'), mult(2, plainString('lesser minor weapons'))]),
	new TreasureTypeAllocation('E', 9000, [plainString('greater minor armor'), plainString('greater minor weapon')]),
	new TreasureTypeAllocation('E', 10000, [plainString('lesser medium armor'), plainString('lesser minor weapon')]),
	new TreasureTypeAllocation('E', 13000, [plainString('lesser medium weapon')]),
	new TreasureTypeAllocation('E', 13000, [plainString('lesser medium armor'), plainString('greater minor weapon')]),
	new TreasureTypeAllocation('E', 15000, [plainString('greater medium armor'), plainString('lesser minor weapon')]),
	new TreasureTypeAllocation('E', 20000, [plainString('lesser medium armor'), plainString('lesser medium weapon')]),
	new TreasureTypeAllocation('E', 25000, [plainString('greater minor armor'), plainString('greater medium weapon')]),
	new TreasureTypeAllocation('E', 30000, [plainString('lesser major armor'), plainString('lesser minor weapon'), plainString('greater minor weapon')]),
	new TreasureTypeAllocation('E', 30000, [plainString('lesser medium armor'), plainString('greater medium weapon')]),
	new TreasureTypeAllocation('E', 35000, [plainString('lesser major armor'), plainString('lesser medium weapon')]),
	new TreasureTypeAllocation('E', 35000, [plainString('lesser minor armor'), plainString('lesser major weapon')]),
	new TreasureTypeAllocation('E', 40000, [plainString('greater major armor'), plainString('greater minor weapon')]),
	new TreasureTypeAllocation('E', 50000, [plainString('greater major armor'), plainString('lesser medium weapon')]),
	new TreasureTypeAllocation('E', 75000, [plainString('greater minor armor'), plainString('greater major weapon')]),
	new TreasureTypeAllocation('E', 100000, [plainString('greater major armor'), plainString('greater major weapon')])
	];

	treasureTypeAllocations.F = [
	new TreasureTypeAllocation('F', 50, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(2, 4, 1, gp), lesser_minor_potion]),
	new TreasureTypeAllocation('F', 250, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(2, 4, 1, gp), plainString('masterwork light armor or shield'), lesser_minor_potion]),
	new TreasureTypeAllocation('F', 350, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(2, 4, 1, gp), plainString('masterwork medium armor'), lesser_minor_potion]),
	new TreasureTypeAllocation('F', 400, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(2, 4, 1, gp), plainString('masterwork weapon'), lesser_minor_potion]),
	new TreasureTypeAllocation('F', 500, [plainString('Masterwork weapon'), greater_minor_potion]),
	new TreasureTypeAllocation('F', 750, [makeCoinPicker(6, 6, 1, gp), plainString('masterwork medium armor'), plainString('masterwork weapon'), mult(2, lesser_minor_potion)]),
	new TreasureTypeAllocation('F', 1000, [plainString('Masterwork heavy armor')]),
	new TreasureTypeAllocation('F', 1500, [plainString('Masterwork heavy armor'), plainString('masterwork weapon'), greater_minor_potion]),
	new TreasureTypeAllocation('F', 2000, [plainString('lesser minor armor'), plainString('masterwork weapon'), mult(2, greater_minor_potion)]),
	new TreasureTypeAllocation('F', 3000, [plainString('Masterwork medium armor'), plainString('lesser minor weapon'), greater_minor_potion]),
	new TreasureTypeAllocation('F', 4000, [plainString('lesser minor armor'), plainString('masterwork weapon'), plainString('lesser minor wondrous item'), greater_minor_potion]),
	new TreasureTypeAllocation('F', 5000, [plainString('Masterwork medium armor'), plainString('lesser minor weapon'), plainString('lesser minor wondrous item'), greater_minor_potion]),
	new TreasureTypeAllocation('F', 6000, [plainString('lesser minor armor'), plainString('lesser minor weapon'), plainString('lesser minor wondrous item')]),
	new TreasureTypeAllocation('F', 7500, [plainString('greater minor armor'), plainString('lesser minor weapon'), plainString('lesser minor ring')]),
	new TreasureTypeAllocation('F', 10000, [plainString('greater minor armor'), plainString('lesser minor weapon'), plainString('lesser minor ring'), plainString('lesser minor wondrous item'), mult(3, greater_minor_potion)]),
	new TreasureTypeAllocation('F', 10000, [plainString('greater minor armor'), plainString('greater minor weapon'), mult(2, greater_medium_potion)]),
	new TreasureTypeAllocation('F', 12500, [plainString('greater minor armor'), plainString('lesser minor weapon'), plainString('greater minor wondrous item'), mult(2, greater_medium_potion)]),
	new TreasureTypeAllocation('F', 15000, [plainString('greater minor armor'), plainString('greater minor weapon'), plainString('greater minor ring')]),
	new TreasureTypeAllocation('F', 20000, [plainString('lesser medium armor'), plainString('greater minor weapon'), plainString('greater minor wondrous item'), mult(2, greater_medium_potion)]),
	new TreasureTypeAllocation('F', 25000, [plainString('lesser medium armor'), plainString('lesser medium weapon'), plainString('lesser minor ring'), plainString('lesser minor wondrous item'), mult(2, greater_medium_potion)]),
	new TreasureTypeAllocation('F', 30000, [plainString('lesser medium armor'), plainString('lesser medium weapon'), mult(2, plainString('lesser minor rings')), plainString('greater minor wondrous items')]),
	new TreasureTypeAllocation('F', 40000, [plainString('lesser medium armor'), plainString('lesser medium weapon'), plainString('lesser medium ring'), plainString('greater minor wondrous item'), mult(2, greater_medium_potion)]),
	new TreasureTypeAllocation('F', 50000, [plainString('greater medium armor'), plainString('greater medium weapon'), plainString('lesser medium wondrous item'), mult(2, lesser_major_potion)]),
	new TreasureTypeAllocation('F', 60000, [plainString('greater medium armor'), plainString('greater medium weapon'), mult(2, plainString('greater minor rings')), mult(2, plainString('greater minor wondrous items'))]),
	new TreasureTypeAllocation('F', 75000, [plainString('lesser major armor'), plainString('greater medium weapon'), plainString('greater minor ring'), plainString('greater medium wondrous item'), mult(3, greater_major_potion)]),
	new TreasureTypeAllocation('F', 100000, [plainString('lesser major armor'), plainString('lesser major weapon'), plainString('lesser medium ring'), plainString('greater minor ring'), mult(2, plainString('lesser medium wondrous items'))])
	];

	treasureTypeAllocations.G = [
	new TreasureTypeAllocation('G', 50, [makeCoinPicker(2, 4, 10, sp), makeCoinPicker(2, 4, 1, gp), lesser_minor_potion]),
	new TreasureTypeAllocation('G', 75, [makeCoinPicker(2, 4, 1, gp), lesser_minor_potion, lesser_minor_scroll]),
	new TreasureTypeAllocation('G', 100, [lesser_minor_potion, mult(2, lesser_minor_scroll)]),
	new TreasureTypeAllocation('G', 150, [lesser_minor_scroll, greater_minor_scroll]),
	new TreasureTypeAllocation('G', 200, [mult(2, lesser_minor_potion), greater_minor_scroll]),
	new TreasureTypeAllocation('G', 250, [mult(2, greater_minor_scroll)]),
	new TreasureTypeAllocation('G', 500, [mult(3, lesser_minor_potion), mult(3, greater_minor_scroll)]),
	new TreasureTypeAllocation('G', 750, [greater_minor_potion, lesser_minor_wand]),
	new TreasureTypeAllocation('G', 1000, [makeCoinPicker(7, 6, 1, gp), mult(3, greater_minor_scroll), lesser_minor_wand]),
	new TreasureTypeAllocation('G', 1500, [makeCoinPicker(3, 6, 10, gp), lesser_medium_potion, lesser_medium_scroll, lesser_minor_wand]),
	new TreasureTypeAllocation('G', 2000, [makeCoinPicker(2, 4, 10, gp), plainString('masterwork weapon'), mult(2, lesser_medium_scroll), lesser_minor_wand]),
	new TreasureTypeAllocation('G', 2500, [mult(2, greater_medium_potion), greater_minor_wand]),
	new TreasureTypeAllocation('G', 3000, [greater_medium_potion, mult(2, lesser_medium_scroll), greater_minor_wand]),
	new TreasureTypeAllocation('G', 4000, [plainString('lesser minor wondrous item'), greater_medium_potion, greater_minor_wand]),
	new TreasureTypeAllocation('G', 5000, [plainString('lesser minor ring'), plainString('lesser minor wondrous item'), mult(2, lesser_medium_scroll)]),
	new TreasureTypeAllocation('G', 6000, [plainString('lesser minor ring'), plainString('lesser minor wondrous item'), greater_medium_potion, greater_minor_wand]),
	new TreasureTypeAllocation('G', 7500, [mult(2, greater_medium_potion), lesser_minor_scroll, lesser_medium_wand]),
	new TreasureTypeAllocation('G', 10000, [plainString('lesser minor ring'), plainString('lesser minor wondrous item'), lesser_medium_wand]),
	new TreasureTypeAllocation('G', 12500, [plainString('lesser minor ring'), plainString('greater minor wondrous item'), mult(2, greater_medium_scroll), mult(2, greater_minor_wand)]),
	new TreasureTypeAllocation('G', 15000, [plainString('lesser minor ring'), plainString('lesser medium rod'), lesser_medium_wand]),
	new TreasureTypeAllocation('G', 20000, [plainString('greater minor ring'), plainString('greater minor wondrous item'), greater_medium_potion, mult(2, greater_medium_scroll), lesser_medium_wand]),
	new TreasureTypeAllocation('G', 25000, [plainString('lesser minor ring'), lesser_medium_wand, greater_medium_wand, plainString('greater minor wondrous item')]),
	new TreasureTypeAllocation('G', 30000, [plainString('greater minor ring'), plainString('lesser medium wondrous item'), lesser_major_scroll, greater_medium_wand]),
	new TreasureTypeAllocation('G', 40000, [plainString('lesser minor weapon'), plainString('lesser medium staff'), plainString('greater medium rod'), mult(2, plainString('lesser minor wondrous items')), lesser_medium_wand]),
	new TreasureTypeAllocation('G', 50000, [plainString('greater minor ring'), mult(2, plainString('lesser medium wondrous items')), lesser_major_potion, mult(3, greater_medium_scroll), lesser_major_wand]),
	new TreasureTypeAllocation('G', 60000, [plainString('lesser medium staff'), plainString('greater medium rod'), plainString('greater medium wondrous item'), greater_medium_potion, mult(2, lesser_major_scroll), lesser_medium_wand]),
	new TreasureTypeAllocation('G', 75000, [plainString('lesser minor weapon'), plainString('greater medium staff'), plainString('greater medium wondrous item'), mult(3, greater_major_scroll), greater_major_wand]),
	new TreasureTypeAllocation('G', 100000, [plainString('lesser major ring'), plainString('greater medium rod'), plainString('lesser major staff'), lesser_major_scroll, greater_medium_wand])
	];

	treasureTypeAllocations.H = [
	new TreasureTypeAllocation('H', 500, [makeCoinPicker(4, 4, 100, cp), makeCoinPicker(3, 6, 10, sp), makeCoinPicker(2, 4, 10, gp), plainString('masterwork weapon'), lesser_minor_potion, lesser_minor_scroll, gemPicker(2)]),
	new TreasureTypeAllocation('H', 1000, [makeCoinPicker(2, 4, 100, cp), makeCoinPicker(2, 6, 100, sp), makeCoinPicker(6, 6, 1, gp), greater_minor_potion, greater_minor_scroll, lesser_minor_wand, mult(3, gemPicker(1))]),
	new TreasureTypeAllocation('H', 2500, [makeCoinPicker(3, 6, 10, sp), makeCoinPicker(2, 4, 1, gp), plainString('masterwork heavy armor'), plainString('masterwork weapon'), mult(2, lesser_medium_potion), mult(2, greater_minor_scroll), gemPicker(2)]),
	new TreasureTypeAllocation('H', 5000, [makeCoinPicker(2, 4, 10, gp), makeCoinPicker(4, 6, 1, pp), plainString('masterwork weapon'), plainString('lesser minor ring'), greater_medium_potion, lesser_medium_scroll, greater_minor_wand]),
	new TreasureTypeAllocation('H', 7500, [makeCoinPicker(4, 4, 10, gp), makeCoinPicker(6, 6, 1, pp), plainString('lesser minor weapon'), plainString('lesser minor wondrous item'), mult(2, greater_medium_potion), greater_minor_wand, mult(2, gemPicker(3))]),
	new TreasureTypeAllocation('H', 10000, [makeCoinPicker(4, 8, 10, gp), makeCoinPicker(6, 10, 1, pp), plainString('greater minor armor'), plainString('lesser minor ring'), plainString('lesser minor wondrous item'), lesser_medium_scroll, greater_minor_wand, gemPicker(4)]),
	new TreasureTypeAllocation('H', 15000, [makeCoinPicker(4, 4, 10, gp), makeCoinPicker(4, 4, 10, pp), plainString('greater minor armor'), plainString('lesser minor wondrous item'), mult(2, greater_medium_potion), mult(2, greater_medium_scroll), lesser_medium_wand, gemPicker(3)]),
	new TreasureTypeAllocation('H', 20000, [makeCoinPicker(2, 4, 10, pp), plainString('greater minor ring'), mult(2, plainString('lesser minor wondrous items')), mult(2, greater_medium_potion), mult(2, lesser_major_scroll), lesser_medium_wand]),
	new TreasureTypeAllocation('H', 25000, [makeCoinPicker(6, 10, 10, gp), makeCoinPicker(6, 6, 1, pp), plainString('lesser medium armor'), plainString('lesser minor weapon'), plainString('greater minor wondrous item'), mult(2, lesser_major_scroll), lesser_medium_wand, gemPicker(4)]),
	new TreasureTypeAllocation('H', 30000, [makeCoinPicker(6, 6, 10, gp), makeCoinPicker(2, 4, 10, pp), plainString('greater minor weapon'), plainString('lesser medium wondrous item'), greater_medium_wand, mult(3, gemPicker(3))]),
	new TreasureTypeAllocation('H', 40000, [makeCoinPicker(4, 4, 10, gp), makeCoinPicker(4, 4, 10, pp), plainString('lesser medium ring'), plainString('lesser medium rod'), mult(2, greater_major_potion), mult(2, lesser_major_scroll), lesser_major_wand]),
	new TreasureTypeAllocation('H', 50000, [makeCoinPicker(4, 4, 10, pp), plainString('greater medium armor'), plainString('lesser medium staff'), plainString('lesser medium wondrous item'), greater_major_scroll, lesser_medium_wand, gemPicker(5)]),
	new TreasureTypeAllocation('H', 75000, [makeCoinPicker(2, 8, 100, gp), makeCoinPicker(4, 4, 10, pp), plainString('greater minor weapon'), plainString('greater medium ring'), plainString('greater medium staff'), mult(3, greater_major_potion), greater_major_scroll, lesser_major_wand, gemPicker(5)]),
	new TreasureTypeAllocation('H', 100000, [makeCoinPicker(8, 6, 100, gp), makeCoinPicker(4, 4, 10, pp), plainString('lesser major ring'), plainString('lesser major wondrous item'), mult(3, greater_major_potion), greater_major_scroll, lesser_medium_wand, mult(2, gemPicker(5)), gemPicker(6)])
	];

	treasureTypeAllocations.I = [
	new TreasureTypeAllocation('I', 5000, [makeCoinPicker(4, 4, 1000, cp), makeCoinPicker(6, 6, 100, sp), makeCoinPicker(2, 4, 100, gp), makeCoinPicker(6, 6, 1, pp), plainString('lesser minor armor'), greater_minor_wand, mult(5, gemPicker(3)), artPicker(3)]),
	new TreasureTypeAllocation('I', 10000, [makeCoinPicker(4, 4, 1000, cp), makeCoinPicker(6, 6, 100, sp), makeCoinPicker(2, 4, 100, gp), makeCoinPicker(6, 6, 1, pp), plainString('greater minor armor'), plainString('lesser minor weapon'), plainString('lesser minor wondrous item'), greater_medium_scroll, gemPicker(4), artPicker(3)]),
	new TreasureTypeAllocation('I', 15000, [makeCoinPicker(2, 4, 1000, cp), makeCoinPicker(6, 4, 100, sp), makeCoinPicker(3, 6, 10, gp), makeCoinPicker(6, 6, 1, pp), plainString('greater minor ring'), mult(2, plainString('lesser minor wondrous items')), mult(2, greater_medium_potion), greater_minor_wand, gemPicker(4), artPicker(3)]),
	new TreasureTypeAllocation('I', 20000, [makeCoinPicker(2, 4, 1000, cp), makeCoinPicker(6, 4, 100, sp), makeCoinPicker(3, 6, 10, gp), makeCoinPicker(6, 6, 1, pp), plainString('greater minor armor'), plainString('lesser medium rod'), plainString('greater minor wondrous item'), mult(2, lesser_major_potion), greater_medium_scroll, mult(3, artPicker(3))]),
	new TreasureTypeAllocation('I', 25000, [makeCoinPicker(2, 4, 1000, cp), makeCoinPicker(6, 4, 100, sp), makeCoinPicker(3, 6, 10, gp), makeCoinPicker(6, 6, 1, pp), plainString('lesser medium staff'), mult(2, plainString('lesser minor wondrous items')), greater_medium_potion, lesser_medium_wand, mult(2, gemPicker(2)), mult(2, gemPicker(3)), gemPicker(4)]),
	new TreasureTypeAllocation('I', 30000, [makeCoinPicker(2, 4, 1000, cp), makeCoinPicker(6, 4, 100, sp), makeCoinPicker(3, 6, 10, gp), makeCoinPicker(6, 6, 1, pp), plainString('lesser medium armor'), plainString('greater minor weapon'), plainString('lesser medium wondrous item'), mult(2, lesser_major_scroll), artPicker(4)]),
	new TreasureTypeAllocation('I', 40000, [makeCoinPicker(4, 4, 1000, cp), makeCoinPicker(6, 6, 100, sp), makeCoinPicker(2, 4, 100, gp), makeCoinPicker(6, 6, 1, pp), plainString('lesser medium weapon'), plainString('greater medium rod'), greater_major_potion, greater_medium_scroll, lesser_medium_wand, mult(3, artPicker(3)), mult(2, artPicker(4))]),
	new TreasureTypeAllocation('I', 50000, [makeCoinPicker(4, 4, 10000, cp), makeCoinPicker(6, 6, 1000, sp), makeCoinPicker(4, 4, 100, gp), makeCoinPicker(2, 4, 10, pp), plainString('greater minor armor'), mult(2, plainString('greater minor weapons')), plainString('greater medium staff'), plainString('greater minor wondrous item'), gemPicker(5)]),
	new TreasureTypeAllocation('I', 60000, [makeCoinPicker(2, 4, 10000, cp), makeCoinPicker(2, 4, 1000, sp), makeCoinPicker(2, 4, 100, gp), makeCoinPicker(2, 4, 10, pp), plainString('greater medium weapon'), plainString('greater medium rod'), plainString('lesser medium wondrous item'), greater_major_scroll, mult(2, greater_minor_wand), gemPicker(4), mult(5, artPicker(2))]),
	new TreasureTypeAllocation('I', 75000, [makeCoinPicker(2, 4, 10000, cp), makeCoinPicker(2, 4, 1000, sp), makeCoinPicker(2, 4, 100, gp), makeCoinPicker(2, 4, 10, pp), plainString('lesser major armor'), plainString('greater medium ring'), plainString('lesser medium staff'), greater_medium_wand, gemPicker(6), artPicker(4)]),
	new TreasureTypeAllocation('I', 100000, [makeCoinPicker(2, 4, 10000, cp), makeCoinPicker(2, 4, 1000, sp), makeCoinPicker(2, 4, 100, gp), makeCoinPicker(2, 4, 10, pp), plainString('lesser medium weapon'), plainString('greater medium ring'), plainString('lesser major rod'), plainString('greater medium wondrous item'), mult(2, greater_major_potion), lesser_medium_scroll, mult(2, artPicker(4))]),
	new TreasureTypeAllocation('I', 125000, [makeCoinPicker(4, 4, 10000, cp), makeCoinPicker(6, 6, 1000, sp), makeCoinPicker(4, 4, 100, gp), makeCoinPicker(2, 8, 10, pp), plainString('greater major armor'), plainString('lesser medium weapon'), plainString('lesser major staff'), mult(2, greater_major_scroll), greater_major_wand, gemPicker(6), mult(3, artPicker(4))]),
	new TreasureTypeAllocation('I', 150000, [makeCoinPicker(4, 4, 10000, cp), makeCoinPicker(6, 6, 1000, sp), makeCoinPicker(4, 4, 100, gp), makeCoinPicker(2, 8, 10, pp), plainString('greater medium armor'), plainString('lesser major ring'), plainString('greater major wondrous item'), greater_major_wand]),
	new TreasureTypeAllocation('I', 200000, [makeCoinPicker(4, 4, 10000, cp), makeCoinPicker(6, 6, 1000, sp), makeCoinPicker(4, 4, 100, gp), makeCoinPicker(2, 8, 10, pp), plainString('greater major weapon'), mult(2, plainString('lesser medium rings')), plainString('lesser major staff'), plainString('lesser major wondrous item'), lesser_major_wand, mult(3, gemPicker(5)), gemPicker(4)]),
	new TreasureTypeAllocation('I', 300000, [makeCoinPicker(8, 4, 10000, cp), makeCoinPicker(12, 6, 1000, sp), makeCoinPicker(8, 4, 100, gp), makeCoinPicker(2, 8, 10, pp), plainString('greater major weapon'), plainString('lesser major ring'), plainString('greater major staff'), plainString('greater major wondrous item'), greater_medium_wand, gemPicker(6), artPicker(6)])
	];
	
	// find the innermost enclosing node that has a "controller" object

	function controller(c) {
		while (c) {
			if (c.controller)
				return c.controller;
			c = c.parentNode;
		}
	}
</script>
<body onload="initAll()">
	<div id="summary"margin:1em; ></div>

	<div style="clear: both;"></div>

	<div id="total treasure value"margin:1em; >
		APL <select id="APL" onchange="recalcTotalTreasureBudget()">
			<option value="1" selected="on">1</option>
			<option value="2">2</option>
			<option value="3">3</option>
			<option value="4">4</option>
			<option value="5">5</option>
			<option value="6">6</option>
			<option value="7">7</option>
			<option value="8">8</option>
			<option value="9">9</option>
			<option value="10">10</option>
			<option value="11">11</option>
			<option value="12">12</option>
			<option value="13">13</option>
			<option value="14">14</option>
			<option value="15">15</option>
			<option value="16">16</option>
			<option value="17">17</option>
			<option value="18">18</option>
			<option value="19">19</option>
			<option value="20">20+</option>
		</select> Amount: <select id="APLMultiplier" onchange="recalcTotalTreasureBudget()">
			<option value="incidental">incidental</option>
			<option value="standard" selected="on">standard</option>
			<option value="double">double</option>
			<option value="triple">triple</option>
		</select> Advancement rate: <select id="AdvancementRate" onchange="recalcTotalTreasureBudget()">
			<option value="slow">slow</option>
			<option value="med" selected="on">medium</option>
			<option value="fast">fast</option>
		</select> Total treasure budget: <span class="money" id="totaltreasurebudget">0</span>

		<button onclick="recalcTotalTreasureBudget()">Reroll all</button>

		<button onclick="addNPCBlock()">Add NPC Block</button>
	</div>


	<div id="MAIN">
		<div id="SUMMARY">
			<div style="float: left; margin: 1em; padding: 1em;  border: thin solid black;">
				<table border="0" cellspacing="0" cellpadding="0">
					<tr>
						<TD></TD>
						<TH>Amt</TH>
						<TH>Value</TH>
					</tr>
					<tr>
						<TD>CP</TD>
						<TD id="cp_amt" class="money">0</TD>
						<TD id="cp_value" class="money">0.00</TD>
					</tr>
					<tr>
						<TD>SP</TD>
						<TD id="sp_amt" class="money">0</TD>
						<TD id="sp_value" class="money">0.00</TD>
					</tr>
					<tr>
						<TD>GP</TD>
						<TD id="gp_amt" class="money">0</TD>
						<TD id="gp_value" class="money">0.00</TD>
					</tr>
					<tr>
						<TD>PP</TD>
						<TD id="pp_amt" class="money">0</TD>
						<TD id="pp_value" class="money">0.00</TD>
					</tr>
					<tr>
						<TD>Subtotal</TD>
						<TD colspan="2" id="currency_value" class="money">0.00</TD>
					</tr>
					<tr>
						<TD>Gems</TD>
						<TD colspan="2" id="gem_value" class="money">0.00</TD>
					</tr>
					<tr>
						<TD>Art Objects</TD>
						<TD colspan="2" id="art_value" class="money">0.00</TD>
					</tr>
					<tr>
						<TD>Total</TD>
						<TD colspan="2" id="total_value" class="money" style="font-weight: bold;">0.00</TD>
					</tr>
				</table>
			</div>

			<div style="float: left;"">
				<div style="margin: 1em; padding: 0em;">
					<table border="0" cellspacing="0" cellpadding="0">
						<caption>Gems</caption>
						<tbody id="gem_table">
						</tbody>
					</table>
				</div>
				<div style="margin: 1em; padding: 0em;">
					<table border="0" cellspacing="0" cellpadding="0">
						<caption>Art Objects</caption>
						<tbody id="art_table">
						</tbody>
					</table>
				</div>
			</div>

			<div style="float: left;"">
				<div style="margin: 1em; padding: 0em;">
					<table border="0" cellspacing="0" cellpadding="0">
						<caption>Items</caption>
						<tbody id="item_table">
						</tbody>
					</table>
				</div>
			</div>

			<div style="float: left;">
				<div style="margin: 1em; padding: 0em;">
					<table border="0" cellspacing="0" cellpadding="0">
						<caption>Weapons</caption>
						<tbody id="weapon_table">
						</tbody>
					</table>
				</div>

				<div style="margin: 1em; padding: 0em;">
					<table border="0" cellspacing="0" cellpadding="0">
						<caption>Armour</caption>
						<tbody id="armour_table">
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div style="clear: both;"></div>
		<div id="MAIN-TREASURE"></div>
		<div style="clear: both;"></div>
		<div id="NPC-TREASURES"></div>
	</div>

	<div style="clear: both;"></div>
	<hr>

	<font size="-1"> Paizo Publishing data used without permission. Using this generator without owning a paid-for copy of Ulimte Equipment is a chaotic act! Also, this generator won't be much use to you without one. <br>
		Javascript code &copy; <a href="mailto:Paul Murray<pmurray@bigpond.com">Paul Murray</a> 2014. <a href="http://paulmurray.wordpress.com">Wordpress</a>, <a href="https://twitter.com/#!/PaulMurrayCbr">Twitter</a>, <a
		href="http://www.facebook.com/PaulMurrayCbr">Facebook</a>.
	</font>
</body>
</html>